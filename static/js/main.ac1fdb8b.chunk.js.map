{"version":3,"sources":["assets/images/projects/9-MERiT.jpg","assets/images/projects/10-Mo-Bo.jpg","assets/images/projects/11-Matt-och-steg.jpg","assets/images/projects/12-SAMIR.jpg","assets/images/projects/13-Sensorer-for-luftmiljo.jpg","assets/images/projects/14-R-energi.JPG","assets/images/projects/15-Sharing-Cities-Sweden.jpg","assets/images/projects/16-Matbutik.jpg","assets/images/projects/17-Smart-Village.png","assets/images/projects/18-Smaskalig-elforsorjning.jpg","assets/images/projects/19-Urban-ICT-Arena.jpg","assets/images/projects/20-Vardeskapande-med-oppna-data.jpg","assets/images/projects/21-3De.jpg","Header.jsx","matrix/MatrixUtility.js","matrix/MatrixTooltip.jsx","matrix/MatrixCircleMenu.jsx","ProjectNavigator.js","matrix/Matrix.jsx","map/Map.jsx","partners/Partners.jsx","filters/Matchmaking.jsx","filters/Filters.jsx","ColorLegendItem.jsx","ColorLegend.jsx","ScaleLegend.jsx","Sidebar.jsx","info-box/InfoBoxSection.jsx","info-box/projectImages.js","info-box/InfoBox.jsx","info-box/AnimatedInfoBox.jsx","App.jsx","serviceWorker.js","index.js","assets/images/projects/1-Aktivitetsbaserad-modellering.png","assets/images/projects/2-DDS-energieffektiv-vard.jpg","assets/images/projects/3-Digitalt-kontrollerade-odlingssystem.jpg","assets/images/projects/4-Effektiv-energiplanering.jpg","assets/images/projects/5-Hotmodellering.jpg","assets/images/projects/6-Hallbara-urbana-livstillar.jpg","assets/images/projects/7-Klimatkampen-Uppsala.jpg","assets/images/projects/8-Ladda-lagra-lanka.png"],"names":["module","exports","__webpack_require__","p","Header","_this","this","viewLinks","map","view","match","props","location","pathname","includes","toLowerCase","react_default","a","createElement","key","className","concat","Link","to","href","Component","withRouter","col2focus","1","2","3","4","theme2row","testbeds","innovation","financing","management","intelligence","row2theme","5","focusLabel","themeLabel","type2class","Forskningsprojekt","Innovationsprojekt","Förstudie","circleRadius","area","Math","sqrt","PI","circleSizes","ticks","value","project","label","format","display","budget","survey_answers","funded","replace","partners","Object","toConsumableArray","Set","other_financiers","other_recipients","length","locations","projectTypes","projectTypeColors","scaleOrdinal","range","rgb","domain","parseNewlinesY","texts","each","text","select","words","split","x","attr","dy","parseFloat","i","forEach","word","append","parseNewlinesX","y","MatrixTooltip","nextProps","style","top","margin","r","offset","left","project_title","MatrixCircleMenu","width","height","cx","cy","x1","x2","y1","y2","d","t","lib","filter","data","values","valueField","textField","circleSize","onChange","updateCircleSize","ProjectNavigator","rootPath","arguments","undefined","classCallCheck","_hasChangedSinceInit","history","matchPath","path","exact","push","id","filteredData","GetProjectId","find","project_id","prevLocation","params","masterTransition","transition","duration","ease","easePolyOut","exponent","Matrix","possibleConstructorReturn","getPrototypeOf","call","state","hoveredProject","right","bottom","projectNavigator","draw","bind","assertThisInitialized","_this2","svg","svgRef","svgInner","classed","circleSizeWrapper","circleSizeWrapperRef","scaleX","scalePoint","padding","scaleY","circles","on","event","target","tagName","goToRoot","debounce","window","addEventListener","prevProps","prevState","updateHovered","updateClicked","isEqual","updateData","setState","removeEventListener","init","svgWrapperRef","clientHeight","clientWidth","projectExists","optimalHeight","optimalWidth","selectors","yAxis","themesLabel","xAxis","focusAreasLabel","keys","s","axisLeft","tickSize","yAxisSelection","selection","selectAll","empty","e","axisTop","xAxisSelection","prevProject","projectId","prevProjectId","hasChangedSinceInit","change","datum","neighborSelector","pins","pin","row","col","join","redirectToRoot","_this3","packedData","obj","_loop","theme","maxEnclose","packSiblings","max","packEnclose","rScale","min","step","arr","_loop2","_loop3","objectSpread","packData","updateScaleData","sortedPackedData","sort","b","minSize","maxSize","labelNumbers","circleRadii","Number","parseInt","toPrecision","number","buildScaleData","circle","exit","remove","enter","project_type","goToProject","_this4","ref","svgWrapper","src_matrix_MatrixTooltip","src_matrix_MatrixCircleMenu","Map","scaleLegendDebounce","updateScaleLegend","zoom","d3","scaleExtent","zoomed2","g","transform","projection","rotate","scale","center","translate","multiple_projects_box","cities_container","projects","tooltip","tooltip2","tooltip3","tooltip3_showed","project_count_city","cities_circles","cities","coordinates","html","name","offsetX","offsetY","topojson","europe","objects","features","sweden","subunits","dat","mockData_real","tetra","da","leng","j","JSON","parse","stringify","loc_circles","tetr","ob","xx_loc","ab","xx","k","tt","xxx","project_circles","node","c","project_coordinates","apply","tx","projects_listed","afa","circle_transform","circle_size_increase","project_size_increase","getAttribute","radius","_this5","Partners","omrade_titles","0","helix_colors","helix_colors_borders","omrade_titles_x","omrade_titles_y","projectSpace","projspace_title_x","projspace_title_y","project_no","bubbles","nodes","view_option","forceStrength","createNewNodes","button_collection","normal_button","move_bubbles","helix_button","expand_button","projspace_title","mockData","button_collections","project_buttons","change_view_spec","omradeCenters","class","simulation","velocityDecay","force","strength","charge","ticked","stop","maxAmount","total_amount","radiusScale","bubblesE","kategori","organisation","merge","omradeData","years","temp_str","projData2","projTitlesObj","opt","omrade_view","project_view","alpha","restart","toggle_title","projs","pow","proj_opt","rawData","q_o","Civilsamhälle","Forskning","Näringsliv","Offentlig verksamhet","myNodes","Organisation","random","Projects","Kategori","scaleFactor","Matchmaking","expanded","handleChange","position","substring","parsePosition","valueCopy","index","findIndex","item","splice","checked","rows","ROWS","COLS","type","isChecked","disabled","enabled","columns","defaultProps","intersection","_len","Array","_key","_intersection","ListItem","_ref","count","Filters","filteredBy","titles","keywords","matchmaking","filterValues","prevFilteredData","componentData","projectLocations","projectPartners","projectKeywords","add","financier","recipient","keyword","filterBy","some","has","partner","every","entries","_ref2","_ref3","slicedToArray","_ref4","_ref5","filteredByAllExcept","ret","set","get","reduce","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","colRange","nonEmpty","nextState","newFilteredData","updateFilteredData","buildTitlesList","buildLocationList","buildPartnerList","buildKeywordList","buildMatchmakingList","placeholder","itemComponent","src_filters_Matchmaking","react","onClick","_ref12","_ref13","defineProperty","ColorLegendItem","color","background","RouteColorLegend","items","labels","src_ColorLegendItem","ColorLegend","matrixLabels","partnersLabels","legends","matrix","route","web","native","from","opacity","leave","div","ScaleLegend","parent","parentRef","lineWidth","labelWidth","scaleData","fixedData","slice","reverse","svgHeight","svgHeightChange","parentWidth","parentWidthChange","Sidebar","src_filters_Filters","src_ScaleLegend_0","src_ColorLegend_0","InfoBoxSection","toggle","initToggle","onToggle","title","children","projectImages","p1","p2","p3","p4","p5","6","p6","7","p7","8","p8","9","p9","10","p10","11","p11","12","p12","13","p13","14","p15","15","p14","16","p16","17","p17","18","p18","19","p19","20","p20","21","p21","InfoBox","lastProject","stringList","str","acc","cur","_project$survey_answe","project_organization","project_manager","dates","description","views","link","vizViews","viewName","backgroundImage","src_info_box_InfoBoxSection","total_cost","start","end","decorateItems","AnimatedInfoBox","projectDetails","src_info_box_InfoBox","App","newData","BrowserRouter","basename","process","src_Header_0","src_Sidebar_0","Switch","Route","render","Redirect","src_map_Map","src_matrix_Matrix","partners_Partners","src_info_box_AnimatedInfoBox","Boolean","hostname","ReactDOM","src_App_0","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"6EAAAA,EAAAC,QAAiBC,EAAAC,EAAuB,yDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,0DCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,kECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,0DCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,2ECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,6DCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,0ECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,6DCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,kECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,4ECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,oECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iFCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,oz3BCKlCC,2LACK,IAAAC,EAAAC,KAEDC,EADQ,CAAC,MAAO,SAAU,YACRC,IAAI,SAAAC,GAC1B,IAAMC,EAAQL,EAAKM,MAAMC,SAASC,SAASC,SAASL,EAAKM,eACzD,OACEC,EAAAC,EAAAC,cAAA,MAAIC,IAAKV,EACPW,UAAS,sBAAAC,OAAwBX,EAAQ,6BAA+B,KACxEM,EAAAC,EAAAC,cAACI,EAAA,EAAD,CAAMC,GAAE,IAAAF,OAAMZ,EAAKM,gBAChBN,MAMT,OACEO,EAAAC,EAAAC,cAAA,OAAKE,UAAU,UACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,kBACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,wBACbJ,EAAAC,EAAAC,cAAA,MAAIE,UAAU,gBACXb,IAGLS,EAAAC,EAAAC,cAAA,OAAKE,UAAU,yBACbJ,EAAAC,EAAAC,cAAA,MAAIE,UAAU,gBACZJ,EAAAC,EAAAC,cAAA,MAAIE,UAAU,sBAAqBJ,EAAAC,EAAAC,cAAA,KAAGM,KAAK,KAAR,qBAzB5BC,cAkCNC,cAAWtB,0BCrCbuB,EAAY,CACvBC,EAAG,kBACHC,EAAG,iBACHC,EAAG,iBACHC,EAAG,wBAGQC,EAAY,CACvBC,SAAU,EACVC,WAAY,EACZC,UAAW,EACXC,WAAY,EACZC,aAAc,GAGHC,EAAY,CACvBV,EAAG,WACHC,EAAG,aACHC,EAAG,YACHC,EAAG,aACHQ,EAAG,gBAGQC,EAAa,CACxBZ,EAAG,2BACHC,EAAG,gCACHC,EAAG,mCACHC,EAAG,6BAGQU,EAAa,CACxBb,EAAG,iCACHC,EAAG,qCACHC,EAAG,wCACHC,EAAG,WACHQ,EAAG,4CAGQG,EAAa,CACxBC,kBAAqB,WACrBC,mBAAsB,aACtBC,eAAa,YAGR,SAASC,EAAaC,GAC3B,OAAOC,KAAKC,KAAKF,EAAOC,KAAKE,IAGxB,IAAMC,EAAc,CACzBC,MAAO,CACLC,MAAO,SAAAC,GAAO,OAAI,GAClBC,MAAO,SAAAA,GAAK,SAAAlC,OAAOmC,YAAO,IAAPA,CAAYD,GAAnB,UACZE,QAAS,OACTtC,IAAK,SAEPuC,OAAQ,CACNL,MAAO,SAAAC,GAAO,OAAIA,EAAQK,eAAeD,OAAOE,QAChDL,MAAO,SAAAA,GAAK,SAAAlC,OAAOmC,YAAO,IAAPA,CAAYD,GAAOM,QAAQ,KAAM,KAAxC,QACZJ,QAAS,SACTtC,IAAK,UAEP2C,SAAU,CACRT,MAAO,SAAAC,GAAO,OAAIS,OAAAC,EAAA,EAAAD,CAAI,IAAIE,IAAJF,OAAAC,EAAA,EAAAD,CAAYT,EAAQK,eAAeO,kBAAnC7C,OAAA0C,OAAAC,EAAA,EAAAD,CAAwDT,EAAQK,eAAeQ,qBAAoBC,QACzHb,MAAO,SAAAA,GAAK,SAAAlC,OAAOmC,YAAO,IAAPA,CAAYD,GAAnB,cACZE,QAAS,WACTtC,IAAK,YAEPkD,UAAW,CACThB,MAAO,SAAAC,GAAO,OAAIA,EAAQK,eAAeU,UAAUD,QACnDb,MAAO,SAAAA,GAAK,SAAAlC,OAAOmC,YAAO,IAAPA,CAAYD,GAAnB,aACZE,QAAS,UACTtC,IAAK,cAIImD,EAAe,CAAC,oBAAqB,qBAAsB,gBAC3DC,EAAoBC,cAC9BC,MAAM,CAACC,YAAI,EAAG,IAAK,KAAMA,YAAI,IAAK,IAAK,KAAMA,YAAI,IAAK,IAAK,KAC3DC,OAAOL,GAwGH,SAASM,EAAeC,GAC7BA,EAAMC,KAAK,WACT,IAAMC,EAAOC,YAAO1E,MACd2E,EAAQF,EAAKA,OAAOG,MAAM,QAC1BC,EAAIJ,EAAKK,KAAK,KACdC,EAAKC,WAAWP,EAAKK,KAAK,OAChCL,EAAKA,KAAK,MACV,IACIQ,EAAI,EACRN,EAAMO,QAAQ,SAAAC,GACZV,EAAKW,OAAO,SACPX,KAAKU,GACLL,KAAK,IAAKD,GACVC,KAAK,IAHV,IAAA/D,OAHiB,KAMG4D,EAAMb,OAAS,GAAkB,EAHrD,OAIKgB,KAAK,KAJV,GAAA/D,OAImBgE,EAPF,IAOQE,IAJzB,WAQC,SAASI,EAAed,GAC7BA,EAAMC,KAAK,WACT,IAAMC,EAAOC,YAAO1E,MAAM8E,KAAK,cAAe,SACxCH,EAAQF,EAAKA,OAAOG,MAAM,QAC1BU,EAAIb,EAAKK,KAAK,KACdC,EAAKC,WAAWP,EAAKK,KAAK,OAChCL,EAAKA,KAAK,MACV,IACIQ,EAAI,EACRN,EAAMO,QAAQ,SAAAC,GACZV,EAAKW,OAAO,SACPX,KAAKU,GACLL,KAAK,IAAK,GACVA,KAAK,KAHV,GAAA/D,OAGmBgE,EANF,IAMQE,IAHzB,SAKFR,EAAKK,KAAK,YAAV,eAAA/D,OAAsCuE,EAAtC,4BAAAvE,QAAmEuE,EAAnE,qBC/KWC,wMAnCSC,GACpB,OAAIA,EAAUxC,UAAYhD,KAAKK,MAAM2C,yCAKrC,OAAKhD,KAAKK,MAAM2C,QAGdtC,EAAAC,EAAAC,cAAA,OACEE,UAAU,iBACV2E,MAAO,CACLC,IAAK1F,KAAKK,MAAM2C,QAAQsC,EAAItF,KAAKK,MAAMsF,OAAOD,IAAM1F,KAAKK,MAAM2C,QAAQ4C,EAf/D,GAe+E5F,KAAKK,MAAMwF,OAAOP,EACzGQ,KAAM9F,KAAKK,MAAM2C,QAAQ6B,EAAI7E,KAAKK,MAAMsF,OAAOG,KAAO9F,KAAKK,MAAMwF,OAAOhB,IAEzE7E,KAAKK,MAAM2C,QAAQK,eAAe0C,eATP,YAPR5E,sBCqCb6E,2LA7BX,IAAMJ,EAAI,GAIV,OACElF,EAAAC,EAAAC,cAAA,OAAKE,UAAU,sBACbJ,EAAAC,EAAAC,cAAA,OAAKqF,MAAOL,GAAWM,OAAQN,IAC7BlF,EAAAC,EAAAC,cAAA,UAAQuF,GAAIP,GAAOQ,GAAIR,GAAOA,EAAGA,IACjClF,EAAAC,EAAAC,cAAA,QAAMyF,GAAIR,EAAYS,GAAIV,GAAoBW,GAAIX,GAAOY,GAAIZ,KAC7DlF,EAAAC,EAAAC,cAAA,QAAM6F,EAAC,KAAA1F,OAAO2F,EAAP,KAAA3F,OAAyB6E,GAAzB,OAAA7E,OAAwC8E,EAAxC,KAAA9E,OAAsD6E,GAAtD,OAAA7E,OAAiE2F,EAAjE,KAAA3F,OAAmF6E,KAC1FlF,EAAAC,EAAAC,cAAA,QAAM6F,EAAC,KAAA1F,OAAO6E,GAAP,KAAA7E,OAAiC6E,GAAjC,OAAA7E,OAAgD6E,GAAhD,KAAA7E,OAAsE6E,GAAtE,OAAA7E,OAAiF6E,GAAjF,KAAA7E,OAA2G6E,MAEpHlF,EAAAC,EAAAC,cAAC+F,EAAA,aAAD,CACEC,QAAQ,EACRC,KAAMpD,OAAOqD,OAAOjE,GACpBkE,WAAW,MACXC,UAAU,UACVjE,MAAO/C,KAAKK,MAAM4G,WAClBC,SAAUlH,KAAKK,MAAM8G,2BA1BAhG,wDCDzBiG,aACJ,SAAAA,IAA2B,IAAfC,EAAeC,UAAAxD,OAAA,QAAAyD,IAAAD,UAAA,GAAAA,UAAA,GAAJ,GAAI7D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAoH,GACzBpH,KAAKqH,SAAWA,EAChBrH,KAAKyH,sBAAuB,oEAW5B,OAAOzH,KAAKyH,sDAIZzH,KAAKyH,sBAAuB,yCAGfC,GACbA,EAAQnE,QAAQvD,KAAKqH,2CAGdK,EAASpH,GAC2D,OAAvEqH,YAAUrH,EAASC,SAAU,CAAEqH,KAAM5H,KAAKqH,SAAUQ,OAAO,MAC7D7H,KAAKyH,sBAAuB,EAC5BC,EAAQI,KAAK9H,KAAKqH,+CAIVK,EAASpH,EAAUyH,GAC7B,IAAMH,EAAI,GAAA7G,OAAMf,KAAKqH,SAAX,aAAAtG,OAA+BgH,GACM,OAA3CJ,YAAUrH,EAASC,SAAU,CAAEqH,WACjC5H,KAAKyH,sBAAuB,EAC5BC,EAAQI,KAAKF,0CAIHtH,EAAU0H,GACtB,IAAMD,EAAKX,EAAiBa,aAAa3H,GACzC,QAAI0H,EAAanB,KAAKqB,KAAK,SAAAzB,GAAC,OAAIA,EAAEpD,eAAe8E,aAAeJ,8CAKhDzH,EAAU8H,GAC1B,OAAOhB,EAAiBa,aAAa3H,KAAc8G,EAAiBa,aAAaG,0CA1C/D9H,GAClB,IAAMF,EAAQuH,YAAUrH,EAASC,SAAU,CAAEqH,KAAI,kBACjD,OAAc,OAAVxH,EACKA,EAAMiI,OAAON,IACd,WA0CCE,EAAeb,EAAiBa,aAC9Bb,IC9CTkB,UAAmB,SAACC,GAAD,OAAgBA,EAAWC,SAAS,KAAKC,KAAKC,IAAYC,SAAS,MAEtFC,cACJ,SAAAA,EAAYvI,GAAO,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAA4I,IACjB7I,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAAmF,GAAAG,KAAA/I,KAAMK,KACD2I,MAAQ,CACXC,eAAgB,KAChBhC,WAAYpE,EAAYC,OAG1B/C,EAAK4F,OAAS,CAAED,IAAK,IAAKwD,MAAO,GAAIC,OAAQ,GAAIrD,KAAM,KACvD/F,EAAK8F,OAAS,CAAEhB,EAAG,EAAIS,EAAG,GAC1BvF,EAAKqJ,iBAAmB,IAAIhC,EAAiB,WAC7CrH,EAAKsJ,KAAOtJ,EAAKsJ,KAAKC,KAAV7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KACZA,EAAKoH,iBAAmBpH,EAAKoH,iBAAiBmC,KAAtB7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KAXPA,mFAcC,IAAAyJ,EAAAxJ,KAClBA,KAAKyJ,IAAM/E,YAAO1E,KAAK0J,QAGvB1J,KAAK2J,SAAW3J,KAAKyJ,IAClBrE,OAAO,KACLwE,QAAQ,oBAAoB,GAGjC5J,KAAK6J,kBAAoBnF,YAAO1E,KAAK8J,sBAClCrE,MAAM,YAAa,mBAEtBzF,KAAK+J,OAASC,cACT3F,OAAO,CAAC,EAAE,EAAE,EAAE,IACd4F,QAAQ,IACbjK,KAAKkK,OAASF,cACT3F,OAAO,CAAC,EAAE,EAAE,EAAE,EAAE,IAChB4F,QAAQ,IAGbjK,KAAK2J,SAASvE,OAAO,KAChBwE,QAAQ,iBAAiB,GAG9B5J,KAAK2J,SAASvE,OAAO,QAChBwE,QAAQ,gBAAgB,GACxBA,QAAQ,qBAAqB,GAC7BnF,KAAK,SAGVzE,KAAK2J,SAASvE,OAAO,KAChBwE,QAAQ,iBAAiB,GAG9B5J,KAAK2J,SAASvE,OAAO,QAChBwE,QAAQ,qBAAqB,GAC7BA,QAAQ,qBAAqB,GAC7BnF,KAAK,mBAGVzE,KAAKmK,QAAUnK,KAAK2J,SAASvE,OAAO,KAAKwE,QAAQ,WAAW,GAC5D5J,KAAKqJ,MAAK,GAGVrJ,KAAKyJ,IAAIW,GAAG,QAAS,WACU,WAAzBC,IAAMC,OAAOC,SACff,EAAKJ,iBAAiBoB,SAAShB,EAAKnJ,MAAMqH,QAAS8B,EAAKnJ,MAAMC,YAIlEN,KAAKyK,SAAWA,IAAS,kBAAMjB,EAAKH,QAAQ,KAC5CqB,OAAOC,iBAAiB,SAAU3K,KAAKyK,qDAGtBG,EAAWC,GAC5B7K,KAAK8K,cAAc9K,KAAKgJ,MAAMC,eAAgB4B,EAAU5B,gBACxDjJ,KAAK+K,cAAc/K,KAAKK,MAAOuK,GAE1BI,IAAQhL,KAAKK,MAAM2H,aAAc4C,EAAU5C,eAC9ChI,KAAKgJ,MAAM/B,aAAe4D,EAAU5D,aACpCjH,KAAKiL,WAAWjL,KAAKK,MAAM2H,cAC3BhI,KAAKkL,SAAS,CACZjC,eAAgB,OAElBjJ,KAAKoJ,iBAAiBoB,SAASxK,KAAKK,MAAMqH,QAAS1H,KAAKK,MAAMC,0DAKhEoK,OAAOS,oBAAoB,SAAUnL,KAAKyK,UAC1CzK,KAAKyJ,IAAIW,GAAG,QAAS,qCAGJ,IAAdgB,EAAc9D,UAAAxD,OAAA,QAAAyD,IAAAD,UAAA,IAAAA,UAAA,GACbpB,GAAUlG,KAAKqL,cAAcC,aAAetL,KAAK2F,OAAOD,IAAM1F,KAAK2F,OAAOwD,OAC1ElD,GAASjG,KAAKqL,cAAcE,YAAcvL,KAAK2F,OAAOG,KAAO9F,KAAK2F,OAAOuD,MAGzElJ,KAAKoJ,iBAAiBoC,cAAcxL,KAAKK,MAAMC,SAAUN,KAAKK,MAAM2H,gBAAe/B,GAAS,KAEhG,IAGQwF,EAAwB,EAARxF,EADF,EAEdyF,EAFc,EAECxF,EAEhBuF,EAAgBzL,KAAK2F,OAAOD,IAAM1F,KAAK2F,OAAOwD,QAAWnJ,KAAKqL,cAAcC,cAC/EtL,KAAK6F,OAAS,CAAEhB,EAAG,EAAGS,GAAIY,EAASuF,GAAiB,GACpDvF,EAASuF,IAETzL,KAAK6F,OAAS,CAAEhB,GAAIoB,EAAQyF,GAAgB,EAAGpG,EAAG,GAClDW,EAAQyF,GAOZ1L,KAAK+J,OAAO5F,MAAM,CAAC,EAAG8B,IACtBjG,KAAKkK,OAAO/F,MAAM,CAAC,EAAG+B,IAGtB,IAAMyF,EAAY,CAChBhC,SAAU3J,KAAK2J,SACfE,kBAAmB7J,KAAK6J,kBACxB+B,MAAO5L,KAAK2J,SAASjF,OAAO,mBAC5BmH,YAAa7L,KAAK2J,SAASjF,OAAO,qBAClCoH,MAAO9L,KAAK2J,SAASjF,OAAO,mBAC5BqH,gBAAiB/L,KAAK2J,SAASjF,OAAO,2BAEnC0G,GACH3H,OAAOuI,KAAKL,GAAWzG,QAAQ,SAAA+G,GAAC,OAAIN,EAAUM,GAAKN,EAAUM,GAAG1D,aAAaQ,KAAKT,KAEpFqD,EAAUhC,SACL7E,KAAK,YADV,aAAA/D,OACoCf,KAAK6F,OAAOhB,EADhD,MAAA9D,OACsDf,KAAK6F,OAAOP,EADlE,MAGAqG,EAAU9B,kBACLpE,MAAM,MADX,GAAA1E,OACqBf,KAAK6F,OAAOP,EAAItF,KAAK2F,OAAOD,IAAM,GADvD,OAEKD,MAAM,OAFX,GAAA1E,OAEsBf,KAAK6F,OAAOhB,EAAI7E,KAAK2F,OAAOG,KAAO,IAFzD,OAMA6F,EAAUE,YACL/G,KAAK,YADV,iBAAA/D,OACwCf,KAAK2F,OAAOD,IAAMQ,EAAS,EADnE,iBAIAyF,EAAUI,gBACLjH,KAAK,YADV,aAAA/D,OACoCf,KAAK2F,OAAOG,KAAOG,EAAQ,EAD/D,UAmBA0F,EAAUC,MACL9G,KAAK,YADV,aAAA/D,OACoCkF,EAAQjG,KAAK2F,OAAOG,KADxD,MAAA/E,OACiEf,KAAK2F,OAAOD,IAD7E,MAEKqD,KAAKmD,YAASlM,KAAKkK,QAAQiC,SAASlG,IACzC,IAAMmG,EAAiBT,EAAUC,MAAMS,UAAYV,EAAUC,MAAMS,YAAcV,EAAUC,MAC3F,GAAIQ,EAAeE,UAAU,oBAAoBC,QAC/CH,EACKrD,KAAK,SAAAyD,GAAC,OAAIA,EAAEF,UAAU,cAAcxH,KAAK,UAAW,UACpDiE,KAAK,SAAAyD,GAAC,OAAIA,EAAE9H,OAAO,WAAWI,KAAK,UAAW,UAChDwH,UAAU,SACVlH,OAAO,QACLwE,QAAQ,SAAS,GACjBnF,KAAK,SAAAQ,GAAC,OAAI9C,EAAW8C,KACrBH,KAAK,OAAQ,gBACbA,KAAK,KAAMmB,EAhBE,IAiBbnB,KAAK,KAAM,UACXiE,KAAKzE,OACL,CACL,IAAMO,GAAKoB,EApBO,GAqBlB0F,EAAUC,MAAMU,UAAU,oBACrBxH,KAAK,IAAKD,GACZyH,UAAU,SACRxH,KAAK,IAAKD,GAIjB8G,EAAUG,MACLhH,KAAK,YADV,aAAA/D,OACoCf,KAAK2F,OAAOG,KADhD,MAAA/E,OACyDmF,EAASlG,KAAK2F,OAAOD,IAD9E,MAEKqD,KAAK0D,YAAQzM,KAAK+J,QAAQoC,SAASjG,IACxC,IAAMwG,EAAiBf,EAAUG,MAAMO,UAAYV,EAAUG,MAAMO,YAAcV,EAAUG,MAC3F,GAAIY,EAAeJ,UAAU,oBAAoBC,QAC/CG,EACK3D,KAAK,SAAAyD,GAAC,OAAIA,EAAEF,UAAU,cAAcxH,KAAK,UAAW,UACpDiE,KAAK,SAAAyD,GAAC,OAAIA,EAAE9H,OAAO,WAAWI,KAAK,UAAW,UAChDwH,UAAU,SACVlH,OAAO,QACLwE,QAAQ,SAAS,GACjBnF,KAAK,SAAAQ,GAAC,OAAI/C,EAAW+C,KACrBH,KAAK,OAAQ,gBACbA,KAAK,KAAMoB,EAzCE,IA0CbpB,KAAK,KAAM,OACXiE,KAAK1D,OACL,CACL,IAAMC,GAAKY,EA7CO,GA8ClByF,EAAUG,MAAMQ,UAAU,oBACrBxH,KAAK,IAAKQ,GACVR,KAAK,YAFV,eAAA/D,OAEsCuE,EAFtC,4BAAAvE,QAEmEuE,EAFnE,MAKFtF,KAAKiL,WAAWjL,KAAKK,MAAM2H,oDAGfhF,EAAS2J,GACjB3J,IAAY2J,IAGI,OAAhBA,GACF3M,KAAKmK,QAAQmC,UAAU,UAClB1C,QAAQ,SAAS,GAER,OAAZ5G,GACFhD,KAAKmK,QAAQmC,UAAb,aAAAvL,OAAoCiC,EAAQK,eAAe8E,WAA3D,OACKyB,QAAQ,SAAS,0CAGZvJ,EAAOuK,GACnB,IAAIgC,EAAYxF,EAAiBa,aAAa5H,EAAMC,UAChDuM,EAAgBzF,EAAiBa,aAAa2C,EAAUtK,UAU5D,GALKN,KAAKoJ,iBAAiB0D,wBACzBD,GAAiB,EACjB7M,KAAKoJ,iBAAiB2D,UAGpBH,IAAcC,MAGE,IAAfD,IAAuC,IAAnBC,IAAyC,IAAfD,IAAuC,IAAnBC,IACrE7M,KAAKqJ,QAGgB,IAAnBwD,GAAwB7M,KAAKyJ,IAAIG,QAAQ,aAC3C5J,KAAKyJ,IAAIG,QAAQ,WAAW,GAC5B5J,KAAKmK,QAAQmC,UAAU,aAClB1C,QAAQ,YAAY,GACzB5J,KAAKmK,QAAQmC,UAAU,YAClB1C,QAAQ,WAAW,KAIP,IAAfgD,GAGJ,GAAK5M,KAAKoJ,iBAAiBoC,cAAcnL,EAAMC,SAAUD,EAAM2H,cAA/D,CAMA,IAAMgF,EAAQhN,KAAKmK,QAAQzF,OAAb,aAAA3D,OAAiC6L,EAAjC,OAAgDI,QACxDC,EAAmBD,EAAME,KAC5BhN,IAAI,SAAAiN,GAAG,oBAAApM,OAAkBoM,EAAIC,IAAtB,iBAAArM,OAAyCoM,EAAIE,IAA7C,QACPC,KAAK,MACRtN,KAAKyJ,IAAIG,QAAQ,WAAW,GAC5B5J,KAAKmK,QAAQmC,UAAUW,GAClBrD,QAAQ,YAAY,GACzB5J,KAAKmK,QAAQmC,UAAb,aAAAvL,OAAoCiM,EAAM3J,eAAe8E,WAAzD,OACKyB,QAAQ,WAAW,QAbtB5J,KAAKoJ,iBAAiBmE,eAAelN,EAAMqH,4CAgBpCb,GAAM,IAAA2G,EAAAxN,KACTyN,EJ7MH,SAAkB5G,EAAMkD,EAAQG,EAAQjD,GAI7C,IADA,IAAMyG,EAAM,GACHN,EAAM,EAAGA,GAAO,IAAKA,EAAK,CACjCM,EAAIN,GAAO,GACX,IAAK,IAAIC,EAAM,EAAGA,GAAO,IAAKA,EAC5BK,EAAIN,GAAKC,GAAO,GAGpBxG,EAAKA,KAAK3B,QAAQ,SAAAlC,GAEhB,IADA,IAAMkK,EAAO,GADcS,EAAA,SAElBN,GACPrK,EAAQK,eAAehC,EAAUgM,IAAMnI,QAAQ,SAAA0I,GAC7CV,EAAKpF,KAAK,CACRsF,IAAK1L,EAAUkM,GACfP,QAEFK,EAAIhM,EAAUkM,IAAQP,GAAKvF,KAAK,CAC9BsF,IAAK1L,EAAUkM,GACfP,MACAH,OACA7J,eAAgBL,EAAQK,eACxBuC,EAAGpD,EAAayE,EAAWlE,MAAMC,SAX9BqK,EAAM,EAAGA,GAAO,IAAKA,EAAKM,EAA1BN,KAoBX,IADA,IAAIQ,EAAa,EACRT,EAAM,EAAGA,GAAO,IAAKA,EAC5B,IAAK,IAAIC,EAAM,EAAGA,GAAO,IAAKA,EACvBK,EAAIN,GAAKC,GAAKvJ,SACnBgK,YAAaJ,EAAIN,GAAKC,IACtBQ,EAAanL,KAAKqL,IAAIF,EAAYG,YAAYN,EAAIN,GAAKC,IAAMzH,IAKjE,IAFA,IACMqI,EADuBvL,KAAKwL,IAAInE,EAAOoE,OAAS,EAAGjE,EAAOiE,OAAS,GACnCN,EAC7BT,EAAM,EAAGA,GAAO,IAAKA,EAC5B,IAAK,IAAIC,EAAM,EAAGA,GAAO,IAAKA,EAC5BK,EAAIN,GAAKC,GAAKnI,QAAQ,SAAAiI,GACpBA,EAAIvH,EAAIpD,EAAayE,EAAWlE,MAAMoK,IAAQc,IAQpD,IADA,IAAMG,EAAM,GAnD6CC,EAAA,SAoDhDjB,GACP,IArDuD,IAAAkB,EAAA,SAqD9CjB,GACPS,YAAaJ,EAAIN,GAAKC,IAAMnI,QAAQ,SAAAiI,GAClCiB,EAAItG,KAAJrE,OAAA8K,EAAA,EAAA9K,CAAA,GACK0J,EADL,CAEEtI,EAAGsI,EAAItI,EAAIkF,EAAOsD,GAClB/H,EAAG6H,EAAI7H,EAAI4E,EAAOkD,GAClBa,eANGZ,EAAM,EAAGA,GAAO,IAAKA,EAAKiB,EAA1BjB,IADFD,EAAM,EAAGA,GAAO,IAAKA,EAAKiB,EAA1BjB,GAYT,OAAOgB,EI6IcI,CAAS3H,EAAM7G,KAAK+J,OAAQ/J,KAAKkK,OAAQlK,KAAKgJ,MAAM/B,YACvEjH,KAAKK,MAAMoO,gBJ3IR,SAAwBhB,EAAYxG,GACzC,IAAKwG,EAAW3J,OAAQ,OAAO,KAE/B,IAAM4K,EAAmBjL,OAAAC,EAAA,EAAAD,CAAIgK,GAAYkB,KAAK,SAAChO,EAAGiO,GAAJ,OAAU3H,EAAWlE,MAAMpC,GAAKsG,EAAWlE,MAAM6L,KACzFC,EAAU5H,EAAWlE,MAAM2L,EAAiB,IAC5CI,EAAU7H,EAAWlE,MAAM2L,EAAiBA,EAAiB5K,OAAS,IACtEmK,EAASR,EAAW,GAAGQ,OAEzBc,EAAe,GACbC,EAAc,GAWpB,OATAD,EAAa,GAAKE,OAAOC,SAASJ,GAASK,YAAY,GACvDJ,EAAa,GAAKE,OAAOC,SAASJ,EAAU,GAAGK,YAAY,GAC3DJ,EAAa,GAAKE,OAAOC,SAASJ,EAAU,IAAIK,YAAY,GAC5DJ,EAAeA,EAAa7O,IAAI,SAAAkP,GAAM,MAAe,MAAXA,EAAiB,EAAIA,IAE/DJ,EAAY,GAAKxM,EAAauM,EAAa,IAAMd,EACjDe,EAAY,GAAKxM,EAAauM,EAAa,IAAMd,EACjDe,EAAY,GAAKxM,EAAauM,EAAa,IAAMd,EAE7CgB,OAAOC,SAASJ,GAASK,YAAY,KAAOF,OAAOC,SAASL,GAASM,YAAY,GAC5E,CAAC,CACNvJ,EAAGoJ,EAAY,GACf/L,MAAOgE,EAAWhE,MAAM8L,EAAa,MAGlC5K,YAAM,GAAGjE,IAAI,SAAA+E,GAAC,MAAK,CACxBW,EAAGoJ,EAAY/J,GACfhC,MAAOgE,EAAWhE,MAAM8L,EAAa9J,OI+GVoK,CAAe5B,EAAYzN,KAAKgJ,MAAM/B,aACjE,IAAMqI,EAAStP,KAAKmK,QACjBmC,UAAU,UACVzF,KAAK4G,EAAY,SAAAhH,GAAC,SAAA1F,OAAO0F,EAAEpD,eAAe8E,WAAxB,KAAApH,OAAsC0F,EAAE2G,IAAxC,KAAArM,OAA+C0F,EAAE4G,IAAjD,OAErBiC,EAAOC,OAMJhH,aACEQ,KAAKT,GACLxD,KAAK,IAAK,GACV0K,SAELF,EACG/G,aACEQ,KAAKT,GACLxD,KAAK,IAAK,SAAA2B,GAAC,OAAIA,EAAEb,IACjBd,KAAK,YAAa,SAAA2B,GAAC,mBAAA1F,OAAiB0F,EAAE5B,EAAI2I,EAAK7H,OAAOG,KAAnC,KAAA/E,OAA2C0F,EAAEnB,EAAIkI,EAAK7H,OAAOD,IAA7D,OAExB4J,EAAOG,QAAQrK,OAAO,UACjBN,KAAK,YAAa,SAAA2B,GAAC,mBAAA1F,OAAiB0F,EAAE5B,EAAI2I,EAAK7H,OAAOG,KAAnC,KAAA/E,OAA2C0F,EAAEnB,EAAIkI,EAAK7H,OAAOD,IAA7D,OACnBZ,KAAK,UAAW,SAAA2B,GAAC,OAAIA,EAAEpD,eAAe8E,aACtCrD,KAAK,WAAY,SAAA2B,GAAC,OAAIA,EAAE2G,MACxBtI,KAAK,WAAY,SAAA2B,GAAC,OAAIA,EAAE4G,MACxBvI,KAAK,QAAS,SAAA2B,GAAC,OAAIrE,EAAWqE,EAAEpD,eAAeqM,gBAC/CtF,GAAG,YAAa,SAAA3D,GAAC,OAAI+G,EAAKtC,SAAS,CAClCjC,eAAgBxC,MAEjB2D,GAAG,WAAY,SAAA3D,GAAC,OAAI+G,EAAKtC,SAAS,CACjCjC,eAAgB,SAEjBmB,GAAG,QAAS,SAAA3D,GACX+G,EAAKpE,iBAAiBuG,YAAYnC,EAAKnN,MAAMqH,QAAS8F,EAAKnN,MAAMC,SAAUmG,EAAEpD,eAAe8E,YAC5FqF,EAAKtC,SAAS,CACZjC,eAAgB,SAGnBnE,KAAK,IAAK,GACZyD,aACEQ,KAAKT,GACLxD,KAAK,IAAK,SAAA2B,GAAC,OAAIA,EAAEb,6CAGPqB,GACfjH,KAAKkL,SAAS,CAAEjE,gDAGT,IAAA2I,EAAA5P,KACP,OACEU,EAAAC,EAAAC,cAAA,OAAKE,UAAU,iBAAiB+O,IAAK,SAAAC,GAAgBF,EAAKvE,cAAgByE,IACxEpP,EAAAC,EAAAC,cAAA,OAAKE,UAAU,SAASmF,MAAM,OAAOC,OAAO,OAAO2J,IAAK,SAAApG,GAASmG,EAAKlG,OAASD,KAC/E/I,EAAAC,EAAAC,cAACmP,EAAD,CAAe/M,QAAShD,KAAKgJ,MAAMC,eAAgBtD,OAAQ3F,KAAK2F,OAAQE,OAAQ7F,KAAK6F,SACrFnF,EAAAC,EAAAC,cAAA,OAAKE,UAAU,8BAA8B+O,IAAK,SAAAhG,GAAuB+F,EAAK9F,qBAAuBD,IACnGnJ,EAAAC,EAAAC,cAACoP,EAAD,CAAkB7I,iBAAkBnH,KAAKmH,iBAAkBF,WAAYjH,KAAKgJ,MAAM/B,sBA1UvE9F,aAuVNC,cAAWwH,sDCrVpBqH,uBAEJ,SAAAA,EAAY5P,GAAM,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAiQ,IAChBlQ,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAAwM,GAAAlH,KAAA/I,KAAMK,KACDsF,OAAS,CAAED,IAAK,IAAKwD,MAAO,GAAIC,OAAQ,GAAIrD,KAAM,KACvD/F,EAAK8F,OAAS,CAAEhB,EAAG,EAAIS,EAAG,GAC1BvF,EAAKqJ,iBAAmB,IAAIhC,EAAiB,QAJ7BrH,mFAUC,IAAAyJ,EAAAxJ,KAEjBA,KAAKkG,QAAUlG,KAAKqL,cAAcC,aAAetL,KAAK2F,OAAOD,IAAM1F,KAAK2F,OAAOwD,OAC/EnJ,KAAKiG,OAASjG,KAAKqL,cAAcE,YAAcvL,KAAK2F,OAAOG,KAAO9F,KAAK2F,OAAOuD,MAE9ElJ,KAAKkQ,oBAAsBzF,IAAS,kBAAMjB,EAAK2G,qBAAqB,KACpEnQ,KAAKoQ,KAAOC,MACPC,YAAY,CAAC,EAAG,MAChBlG,GAAG,WAAYpK,KAAKuQ,QAAQjH,KAAKtJ,OACjCoK,GAAG,WAAY,WAAOZ,EAAKgH,EAAE1L,KAAK,YAAcuL,IAASI,aACzDrG,GAAG,cAAepK,KAAKkQ,qBAG5BlQ,KAAK0Q,WAAaL,MACbM,OAAO,CAAC,GAAG,IAGXC,MAAM,KACNC,OAAO,CAAC,GAAG,KACXC,UAAU,CAAC9Q,KAAKiG,MAAQ,EAAGjG,KAAKkG,OAAS,IAE9ClG,KAAK4H,KAAOyI,MACPK,WAAW1Q,KAAK0Q,YAErB1Q,KAAK+Q,sBAAwBV,IAAUrQ,KAAKqL,eAAejG,OAAO,OAC7DwE,QAAQ,yBAAwB,GAChCnE,MAAM,UAAW,GACtBzF,KAAKyJ,IAAM4G,IAAUrQ,KAAK0J,QACjB5E,KAAK,QAAS9E,KAAKiG,OACnBnB,KAAK,SAAU9E,KAAKkG,QACpB6C,KAAK/I,KAAKoQ,MAEnBpQ,KAAKyJ,IAAIW,GAAG,QAAS,WACa,WAA5BiG,IAAS/F,OAAOC,UAClBf,EAAKJ,iBAAiBoB,SAAShB,EAAKnJ,MAAMqH,QAAS8B,EAAKnJ,MAAMC,UAC9DkJ,EAAKuH,sBAAsBxI,aAAa9C,MAAM,UAAU,GACxD+D,EAAKuH,sBAAsBtM,KAAK,OAIpCzE,KAAKmQ,oBAELnQ,KAAKwQ,EAAIxQ,KAAKyJ,IAAIrE,OAAO,KAEzBpF,KAAKgR,iBAAmBhR,KAAKyJ,IAAIrE,OAAO,KACjBwE,QAAQ,cAAa,GAE5C5J,KAAKiR,SAAWjR,KAAKyJ,IAAIrE,OAAO,KAGhCpF,KAAKkR,QAAUb,IAAUrQ,KAAKqL,eAAejG,OAAO,OAC/CN,KAAK,QAAS,kBACdW,MAAM,UAAW,GAGtBzF,KAAKmR,SAAWd,IAAUrQ,KAAKqL,eAAejG,OAAO,OAChDN,KAAK,QAAS,mBACdW,MAAM,UAAW,GAGtBzF,KAAKoR,SAAWf,IAAUrQ,KAAKqL,eAAejG,OAAO,OAChDN,KAAK,QAAS,mBACdA,KAAK,KAAK,mBACVW,MAAM,UAAW,GAEtBzF,KAAKqR,gBAAkB,EACvBrR,KAAKsR,mBAAqB,GAK1BtR,KAAKuR,eAAiBvR,KAAKgR,iBAAiB1E,UAAU,UAClDzF,KAAK2K,IAAQ/B,QACbrK,OAAO,UACPN,KAAK,KAAK,SAAS2B,GAAG,MAAM,UAAUA,EAAEsB,KACxCjD,KAAK,KAAM,SAAA2B,GAAM,OAAO+C,EAAKkH,WAAW,CAACjK,EAAEgL,YAAY5M,EAAG4B,EAAEgL,YAAYnM,IAAI,KAC5ER,KAAK,KAAM,SAAA2B,GAAO,OAAO+C,EAAKkH,WAAW,CAACjK,EAAEgL,YAAY5M,EAAG4B,EAAEgL,YAAYnM,IAAI,KAC7ER,KAAK,IAAK,KACVA,KAAK,OAAO,SACZsF,GAAG,YAAa,SAAA3D,GACf+C,EAAK0H,QAAQ3I,WAAW,aAAa9C,MAAM,UAAW,IACtD+D,EAAK0H,QAAQQ,KAAK,MAAMjL,EAAEkL,KAAO,QAC7BlM,MAAM,OAAS4K,IAASuB,QAAW,MACnCnM,MAAM,MAAQ4K,IAASwB,QAAU,GAAM,MACvCpM,MAAM,YAAc,WAEzB2E,GAAG,WAAY,SAAA3D,GAAO+C,EAAK0H,QAAQ3I,aAAa9C,MAAM,UAAW,KAElEzF,KAAKiL,WAAWjL,KAAKK,MAAM2H,cAE1BhI,KAAKwQ,EAAElE,UAAU,8BACdzF,KAAKiL,IAAiBC,EAAQA,EAAOC,QAAQD,QAAQE,UACnDxC,QAAQrK,OAAO,QACfN,KAAK,IAAK9E,KAAK4H,MACf9C,KAAK,OAAO,WAEjB9E,KAAKwQ,EAAElE,UAAU,6BACdzF,KAAKiL,IAAiBI,EAAQA,EAAOF,QAAQG,UAAUF,UACvDxC,QAAQrK,OAAO,QACfN,KAAK,QAAS,SAAS2B,GAAI,MAAO,WAAaA,EAAEsB,KACjDjD,KAAK,IAAK9E,KAAK4H,MACf9C,KAAK,OAAQ,sDAGH8F,EAAWC,GAK5B7K,KAAK+K,cAAc/K,KAAKK,MAAOuK,GAE1BI,IAAQhL,KAAKK,MAAM2H,aAAc4C,EAAU5C,gBAC9ChI,KAAKiL,WAAWjL,KAAKK,MAAM2H,cAI3BhI,KAAKoJ,iBAAiBoB,SAASxK,KAAKK,MAAMqH,QAAS1H,KAAKK,MAAMC,iDAIpDD,EAAOuK,GACnB,IAAIgC,EAAYxF,EAAiBa,aAAa5H,EAAMC,UAChDuM,EAAgBzF,EAAiBa,aAAa2C,EAAUtK,UAKvDN,KAAKoJ,iBAAiB0D,wBACzBD,GAAiB,EACjB7M,KAAKoJ,iBAAiB2D,UAGpBH,IAAcC,IAOC,IAAfD,IAGC5M,KAAKoJ,iBAAiBoC,cAAcnL,EAAMC,SAAUD,EAAM2H,eAC7DhI,KAAKoJ,iBAAiBmE,eAAelN,EAAMqH,6CAKpC0K,GAIT,IAJa,IAAA5E,EAAAxN,KAETqS,EAAgB,GAChBC,EAAQF,EAAIvL,KAAK/C,OACbmB,EAAI,EAAGA,EAAIqN,EAAOrN,IAGxB,IAFA,IAAIsN,EAAKH,EAAIvL,KAAK5B,GAAG5B,eACjBmP,EAAOD,EAAGxO,UAAUD,OAChB2O,EAAI,EAAGA,EAAID,EAAMC,IAAI,EACvB/E,EAAM,IAENrK,eAAiBqP,KAAKC,MAAMD,KAAKE,UAAUL,IAC/C7E,EAAIrK,eAAe/C,SAAWiS,EAAGxO,UAAU0O,GAC3CJ,EAAcvK,KAAK4F,GAGvB,IAAImF,EAAc,GACdC,EAAOT,EAAcvO,OACzB,IAAQmB,EAAI,EAAGA,EAAI6N,EAAM7N,IAAK,CAC5B,IAAI8N,EAAK,GACTA,EAAGpB,KAAQU,EAAcpN,GAAG5B,eAAe/C,SAC3CyS,EAAGlM,KAAOwL,EAAcpN,GACxB4N,EAAY/K,KAAKiL,GAInB/S,KAAKgT,OAAS,GACd,IAAQ/N,EAAI,EAAGA,EAAI6N,EAAM7N,IAAI,CAC3B,IAAIgO,EAAKJ,EAAY5N,GAAG0M,KACpBuB,GAAK,EACT,IAAQT,EAAI,EAAGA,EAAIzS,KAAKgT,OAAOlP,OAAQ2O,IAAI,CACzC,IAAIU,EAAInT,KAAKgT,OAAOP,GAAGd,KACvB,GAAGsB,EAAG7S,MAAM+S,GAAG,CACb,IAAIC,EAAKpT,KAAKgT,OAAOP,GAAG5L,KACxBuM,EAAGtL,KAAK+K,EAAY5N,GAAG4B,MACvB7G,KAAKgT,OAAOP,GAAG5L,KAAOuM,EACtBF,GAAK,GAGT,GAAS,GAANA,EAAY,CACb,IAAIxF,KAAM,IACNiE,KAAOsB,EACX,IAAII,EAAMR,EAAY5N,GAAG4B,KACzB6G,EAAI7G,KAAO,GACX6G,EAAI7G,KAAKiB,KAAKuL,GACdrT,KAAKgT,OAAOlL,KAAK4F,IAIrB1N,KAAKsT,gBAAkBtT,KAAKiR,SACzB3E,UAAU,UACVzF,KAAK7G,KAAKgT,OAAQ,SAAAvM,GAAO,OAAOA,EAAEkL,OACrC3R,KAAKsT,gBAAgB/D,OAClBhH,aACAzD,KAAK,IAAI,GACT0K,SAEDxP,KAAKsT,gBAAgB/K,aACbzD,KAAK,IAAK,SAAA2B,GACT,IAAI9F,EAAI8F,EAAEI,KAAK/C,OACXmB,EAAIoL,IAAqB,EAAE1P,EAAG,GAAGA,GACjCkE,GAA4C,EAAtCwL,IAAiB7C,EAAK/D,IAAI8J,QAAQjO,EAAQ,IACpD,OAAGT,EAAI,EAEEI,EADCJ,EAAE,OAGL,EAAIlE,IAGpBX,KAAKsT,gBAAgB7D,QAAQrK,OAAO,UAChCN,KAAK,KAAK,SAAS2B,EAAExB,GAAG,MAAM,WAAWwB,EAAEkL,OAC3C7M,KAAK,KAAM,SAAA2B,GAAO,IAAI+M,EAAIC,GAAoBhN,EAAEkL,MAAO,OAAOnE,EAAKkD,WAAW,CAAC8C,EAAE3O,EAAE2O,EAAElO,IAAI,KACzFR,KAAK,KAAM,SAAA2B,GAAO,IAAI+M,EAAIC,GAAoBhN,EAAEkL,MAAO,OAAOnE,EAAKkD,WAAW,CAAC8C,EAAE3O,EAAE2O,EAAElO,IAAI,KACzFR,KAAK,YAAa,SAAA2B,GAEjB,IAAI+M,EAAIC,GAAoBhN,EAAEkL,MAC1BxL,EAAKqH,EAAKkD,WAAW,CAAC8C,EAAE3O,EAAE2O,EAAElO,IAE5BoB,EADQ2J,IAAiB7C,EAAK/D,IAAI8J,QACxBG,MAAMvN,GAEpB,MAAO,aADC,CAACO,EAAE,GAAKP,EAAG,GAAIO,EAAE,GAAGP,EAAG,IACL,MAE3ByD,QAAQ,SAAS,QACjBnE,MAAM,eAAgB,IACtBA,MAAM,SAAS,WAEfX,KAAK,OAAO,uBACZsF,GAAG,YAAa,SAAA3D,GACf,IAAIkN,EAAK,GAEPA,EADClN,EAAEI,KAAK/C,OAAS,EACZ,MAAO2C,EAAEkL,KAAM,WAAalL,EAAEI,KAAK/C,OAAQ,YAE3C,MAAQ2C,EAAEkL,KAAM,aAAelL,EAAEI,KAAK,GAAGxD,eAAe0C,cAE7DyH,EAAK2D,SAAS5I,aAAa9C,MAAM,UAAW,IAC5C+H,EAAK2D,SAASO,KAAKiC,GACflO,MAAM,OAAS4K,IAASuB,QAAW,MACnCnM,MAAM,MAAQ4K,IAASwB,QAAU,GAAM,MACvCpM,MAAM,YAAc,WAE3B2E,GAAG,WAAY,SAAA3D,GAAO+G,EAAK2D,SAAS5I,WAAW,SAAS9C,MAAM,UAAW,KACzE2E,GAAG,QAAQ,SAAA3D,GACV,GAAoB,GAAjBA,EAAEI,KAAK/C,OACR0J,EAAKpE,iBAAiBuG,YAAYnC,EAAKnN,MAAMqH,QAAS8F,EAAKnN,MAAMC,SAAUmG,EAAEI,KAAK,GAAGxD,eAAe8E,gBAC/F,CACLqF,EAAKuD,sBAAsBtM,KAAK,IAChC+I,EAAKuD,sBAAsBxI,aAAa9C,MAAM,UAAW,IAC5C4K,IAAU,0BAA0BjL,OAAO,MAClDK,MAAM,aAAa,OACnBhB,KAAKgC,EAAEkL,KAAO,QAASlL,EAAEI,KAAK/C,OAAQ,aAF5C,IAIG8P,EAAkBvD,IAAU,0BAA0BjL,OAAO,MAAMwE,QAAQ,iBAAgB,GAC/FgK,EAAgBrE,OAAOC,SACvBoE,EAAgBtH,UAAU,MAAMzF,KAAKJ,EAAEI,KAAM,SAAAJ,GAAM,OAAOA,EAAEpD,eAAe8E,aACxEsH,QAAQrK,OAAO,MACfK,MAAM,SAAS,WACf2E,GAAG,QAAS,SAAA3D,GACX+G,EAAKpE,iBAAiBuG,YAAYnC,EAAKnN,MAAMqH,QAAS8F,EAAKnN,MAAMC,SAAUmG,EAAEpD,eAAe8E,cAE7F1D,KAAK,SAASgC,GAAG,OAAOA,EAAEpD,eAAe0C,mBAG/CwC,aACCzD,KAAK,IAAK,SAAA2B,GACT,IAAI9F,EAAI8F,EAAEI,KAAK/C,OACXmB,EAAIoL,IAAqB,EAAE1P,EAAG,GAAGA,GACjCkE,GAA4C,EAAtCwL,IAAiB7C,EAAK/D,IAAI8J,QAAQjO,EAAQ,IACpD,OAAGT,EAAI,EAEEI,EADCJ,EAAE,OAGL,EAAIlE,sCAMlB,IAAIkT,EAAM7T,KAAKiR,SACZ3E,UAAU,UACVzF,KAAK7G,KAAKgT,OAAQ,SAAAvM,GAAO,OAAOA,EAAEkL,OAEnC3R,KAAKuR,eAAezM,KAAK,YAAY9E,KAAK8T,iBAAiBzD,IAASI,YACpEoD,EAAI/O,KAAK,YAAY9E,KAAK8T,iBAAiBzD,IAASI,YAEpDzQ,KAAKuR,eAAezM,KAAK,IAAI9E,KAAK+T,qBAAqBzK,KAAKtJ,OAC5D6T,EAAI/O,KAAK,IAAI9E,KAAKgU,sBAAsB1K,KAAKtJ,oDAI5ByG,GACnB,IAAIxB,EAAIoL,IAAqB,EAAG,IAC5BxL,GAA6B,EAAxBwL,IAASI,UAAUnL,EAAQ,IACpC,OAAGT,EAAI,EAEEI,EADCJ,EAAE,OAGL,kDAIa4B,GACpB,IAAI9F,EAAI8F,EAAEI,KAAK/C,OACXmB,EAAIoL,IAAqB,EAAE1P,EAAG,GAAGA,GACjCkE,GAA6B,EAAxBwL,IAASI,UAAUnL,EAAQ,IACpC,OAAGT,EAAI,EAEEI,EADCJ,EAAE,OAGL,EAAIlE,2CAII+F,GACf,OAAO,SAASD,GACd,IAAI+M,EAAI,CAACxT,KAAKiU,aAAa,MAAOjU,KAAKiU,aAAa,OAChDrO,EAAIc,EAAEgN,MAAMF,GAEhB,MAAO,aADC,CAAC5N,EAAE,GAAK4N,EAAE,GAAI5N,EAAE,GAAG4N,EAAE,IACH,iDAIV,IAAA5D,EAAA5P,KAGZkU,EAAS,SAACvT,GACd,IAAIsE,EAAIoL,IAAqB,EAAE1P,EAAG,GAAGA,GAEjCkE,GAA4C,EAAtCwL,IAAiBT,EAAKnG,IAAI8J,QAAQjO,EAAQ,IACpD,OAAGT,EAAI,EAEEI,EADCJ,EAAE,OAGL,EAAIlE,GAGbX,KAAKK,MAAMoO,gBAAgB,CACzB,CAAE7I,EAAGsO,EAAO,GAAIjR,MAAO,aACvB,CAAE2C,EAAGsO,EAAO,GAAIjR,MAAO,aACvB,CAAE2C,EAAGsO,EAAO,GAAIjR,MAAO,gDAKlB,IAAAkR,EAAAnU,KACP,OACEU,EAAAC,EAAAC,cAAA,OAAKE,UAAU,UAAU+O,IAAK,SAAAC,GAAU,OAAIqE,EAAK9I,cAAgByE,IAC/DpP,EAAAC,EAAAC,cAAA,OAAKE,UAAU,mBAAmBiH,GAAG,mBAAmB8H,IAAK,SAAApG,GAAS0K,EAAKzK,OAASD,aA7W1EtI,cAwXHC,eAAW6O,sBCpBXmE,eA1Wb,SAAAA,EAAY/T,GAAM,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAoU,IAChBrU,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAA2Q,GAAArL,KAAA/I,KAAMK,KACDgU,cAAgB,CACnBC,EAAG,mBACHhT,EAAG,YACHC,EAAG,gBACHC,EAAG,wBAILzB,EAAKwU,aAAe,CAClBD,EAAI,UACJhT,EAAI,UACJC,EAAI,UACJC,EAAI,WAGNzB,EAAKyU,qBAAuB,CAC1BF,EAAI,UACJhT,EAAI,UACJC,EAAI,UACJC,EAAI,WAGNzB,EAAK4F,OAAS,CAAED,IAAK,IAAKwD,MAAO,GAAIC,OAAQ,GAAIrD,KAAM,KACvD/F,EAAK8F,OAAS,CAAEhB,EAAG,EAAIS,EAAG,GAE1BvF,EAAK0U,gBAAkB,CACnBjT,EAAG,GACH8S,EAAG,IACHhT,EAAG,IACHC,EAAG,KAEPxB,EAAK2U,gBAAkB,CACrBlT,EAAG,GACH8S,EAAG,GACHhT,EAAG,GACHC,EAAE,IAKJxB,EAAK4U,aAAe,CAClBL,EAAI,IACJhT,EAAI,KAENvB,EAAK6U,kBAAoB,CACvBN,EAAG,IACHhT,EAAG,KAELvB,EAAK8U,kBAAoB,CACvBP,EAAG,GACHhT,EAAG,IAGLvB,EAAK+U,YAAc,EACnB/U,EAAKgV,QAAU,KACfhV,EAAKiV,MAAQ,GACbjV,EAAKkV,YAAc,EAEnBlV,EAAKmV,cAAgB,KAErBnV,EAAKoV,eAAiBpV,EAAKoV,eAAe7L,KAApB7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KA9DNA,mFAkEC,IAAAyJ,EAAAxJ,KAEjBA,KAAKkG,QAAUlG,KAAKqL,cAAcC,aAAetL,KAAK2F,OAAOD,IAAM1F,KAAK2F,OAAOwD,OAC/EnJ,KAAKiG,OAASjG,KAAKqL,cAAcE,YAAcvL,KAAK2F,OAAOG,KAAO9F,KAAK2F,OAAOuD,MAE9ElJ,KAAKkR,QAAUb,IAAUrQ,KAAKqL,eAAejG,OAAO,OAC/CN,KAAK,QAAS,2BACdW,MAAM,UAAW,GAItBzF,KAAKoV,kBAAoB/E,IAAUrQ,KAAKqL,eAAejG,OAAO,OACzDwE,QAAQ,qBAAoB,GAEjC5J,KAAKqV,cAAgBrV,KAAKoV,kBAAkBhQ,OAAO,OAC1CwE,QAAQ,UAAS,GACjBA,QAAQ,mBAAkB,GAC1BA,QAAQ,mBAAkB,GAC1BQ,GAAG,QAAS,WAAOiG,IAAa,WAAWzG,QAAQ,mBAAkB,GAAOJ,EAAK6L,cAAczL,QAAQ,mBAAkB,GAAMJ,EAAK8L,aAAa,KACjJ7Q,KAAK,eACdzE,KAAKuV,aAAevV,KAAKoV,kBAAkBhQ,OAAO,OAC7CwE,QAAQ,UAAS,GACjBA,QAAQ,gBAAe,GACvBQ,GAAG,QAAS,WAAOiG,IAAa,WAAWzG,QAAQ,mBAAkB,GAAOJ,EAAK+L,aAAa3L,QAAQ,mBAAkB,GAAMJ,EAAK8L,aAAa,KAChJ7Q,KAAK,mBAEVzE,KAAKwV,cAAgBxV,KAAKoV,kBAAkBhQ,OAAO,OAC9CwE,QAAQ,UAAS,GACjBA,QAAQ,iBAAgB,GACxBQ,GAAG,QAAS,WAAOiG,IAAa,uBAAuB5K,MAAM,UAAU,aACvEhB,KAAK,mBAEVzE,KAAKgV,MAAQhV,KAAKmV,eAAe3R,IAEjCxD,KAAKyV,gBAAkB,GACvBzV,KAAKyV,gBAAgB,GAAK,WAC1B,IAAI,IAAIxQ,EAAI,EAAGA,EAAIyQ,GAAS7O,KAAK/C,OAAQmB,IACvCjF,KAAKyV,gBAAgBC,GAAS7O,KAAK5B,GAAG5B,eAAe8E,YAAcuN,GAAS7O,KAAK5B,GAAG5B,eAAe0C,cAKrG/F,KAAK2V,mBAAqBtF,IAAUrQ,KAAKqL,eAAejG,OAAO,OAC1DwE,QAAQ,sBAAqB,GAE7BnE,MAAM,mBAAmB,aAC9BzF,KAAK2V,mBAAmBvQ,OAAO,MAAMX,KAAK,WAAWgB,MAAM,aAAa,OACxEzF,KAAK4V,gBAAkB5V,KAAK2V,mBAAmBvQ,OAAO,OAAOkH,UAAU,OACpEzF,KAAK6O,GAAS7O,MACjB7G,KAAK4V,gBAAgBnG,QAAQrK,OAAO,OAEjCwE,QAAQ,WAAU,GAClBA,QAAQ,kBAAiB,GAEzBQ,GAAG,QAAS,SAAA3D,GAAM+C,EAAKqM,iBAAiB,EAAGpP,EAAEpD,eAAe8E,YAC3DkI,IAAa,uBAAuB5K,MAAM,UAAU,QACpD4K,IAAa,WAAWzG,QAAQ,mBAAkB,GAClDJ,EAAKgM,cAAc5L,QAAQ,mBAAkB,KAC9CQ,GAAG,YAAY,SAAS3D,GACvB4J,IAAUrQ,MAAMyF,MAAM,mBAAmB,WAE1C2E,GAAG,WAAW,SAAS3D,GACtB4J,IAAUrQ,MAAMyF,MAAM,mBAAmB,eAE1CiM,KAAM,SAAAjL,GAAM,OAAOA,EAAEpD,eAAe0C,cAAgB,SAGvD/F,KAAK8V,cAAgB,CACnBxB,EAAG,CAAEzP,EAAG,IAAKS,EAAG,GAChBhE,EAAG,CAAEuD,EAAG,IAAKS,EAAG,GAChB/D,EAAG,CAAEsD,EAAG,IAAKS,EAAG,GAChB9D,EAAG,CAAEqD,EAAG,GAAIS,EAAE,IAIhBtF,KAAK6Q,OAAS,CAAEhM,EAAG7E,KAAKiG,MAAQ,EAAGX,EAAGtF,KAAKkG,OAAS,GAGpDlG,KAAKkQ,oBAAsBzF,IAAS,kBAAMjB,EAAK2G,qBAAqB,KACpEnQ,KAAKoQ,KAAOC,MACPC,YAAY,CAAC,GAAI,KACjBlG,GAAG,iBAAkB,WAAOZ,EAAKgH,EAAE1L,KAAK,YAAauL,IAASI,aAC9DrG,GAAG,cAAepK,KAAKkQ,qBAE5BlQ,KAAKyJ,IAAM4G,IAAUrQ,KAAK0J,QACnB5E,KAAK,QAAQ9E,KAAKiG,OAClBnB,KAAK,SAAS9E,KAAKkG,QACnB6C,KAAK/I,KAAKoQ,MACjBpQ,KAAKmQ,oBACLnQ,KAAKyJ,IAAIW,GAAG,QAAS,WACW,mBAA1BiG,IAAS/F,OAAOyL,OAElB1F,IAAa,uBAAuB5K,MAAM,UAAU,UAGxDzF,KAAKwQ,EAAIxQ,KAAKyJ,IAAIrE,OAAO,KAEzBpF,KAAKgW,WAAa3F,MACf4F,cAAc,IACdC,MAAM,IAAK7F,MAAY8F,SAASnW,KAAKkV,eAAerQ,EAAE7E,KAAK6Q,OAAOhM,IAClEqR,MAAM,IAAK7F,MAAY8F,SAASnW,KAAKkV,eAAe5P,EAAEtF,KAAK6Q,OAAOvL,IAClE4Q,MAAM,SAAU7F,MAAmB8F,SAASnW,KAAKoW,OAAO9M,KAAKtJ,QAC7DoK,GAAG,OAAQpK,KAAKqW,OAAO/M,KAAKtJ,OAE/BA,KAAKgW,WAAWM,OAChBtW,KAAKuW,UAAYlG,IAAOqF,GAAU,SAAAjP,GAAO,OAAQA,EAAE+P,eAEnDxW,KAAKyW,YAAcpG,MAChB1H,SAAS,IACTxE,MAAM,CAAC,EAAG,KACVE,OAAO,CAAC,EAAGrE,KAAKuW,YAGnBvW,KAAK+U,QAAU/U,KAAKwQ,EAAElE,UAAU,WAC7BzF,KAAK7G,KAAKgV,MAAO,SAAAvO,GAAO,OAAOA,EAAEsB,KAEpC/H,KAAK0W,SAAW1W,KAAK+U,QAAQtF,QAAQrK,OAAO,UACzCwE,QAAQ,UAAU,GAClB9E,KAAK,IAAK,GACVW,MAAM,OAAO,SAAAgB,GAAO,OAAO+C,EAAK+K,aAAa9N,EAAEkQ,YAC/C7R,KAAK,eAAgB,IACrBA,KAAK,SAAS,SAAA2B,GAAM,OAAO+C,EAAKgL,qBAAqB/N,EAAEkQ,YACvDvM,GAAG,YAAY,SAAA3D,GACd,IAAIsB,EAAKtB,EAAEsB,GAEXsI,IAAa,WACVzJ,OAAO,SAASH,GAAG,OAAGA,EAAEsB,KAAKA,IAC7BQ,aACE9C,MAAM,UAAU,OAErB+D,EAAK0H,QAAQ3I,aAAa9C,MAAM,UAAW,IAC3C+D,EAAK0H,QAAQQ,KAAKjL,EAAEmQ,cACjBnR,MAAM,OAAS4K,IAASuB,QAAW,MACnCnM,MAAM,MAAQ4K,IAASwB,QAAU,GAAM,MACvCpM,MAAM,YAAc,WAExB2E,GAAG,WAAW,SAAA3D,GACX+C,EAAK0H,QAAQ3I,aAAa9C,MAAM,UAAW,GAC3C4K,IAAa,WACV9H,aACE9C,MAAM,UAAU,OAI3BzF,KAAK+U,QAAU/U,KAAK+U,QAAQ8B,MAAM7W,KAAK0W,UAEvC1W,KAAK+U,QAAQxM,WAAW,SACrBC,SAAS,KACT1D,KAAK,IAAK,SAAA2B,GAAO,OAAOA,EAAEyN,SAG7BlU,KAAKgW,WAAWhB,MAAMhV,KAAKgV,OAC3BhV,KAAKsV,aAAa,GAGlB,IAAIwB,EAAazG,IAAQrQ,KAAKqU,eAC9BrU,KAAK+W,MAAQ/W,KAAKwQ,EAAElE,UAAU,iBAC7BzF,KAAKiQ,GAEN9W,KAAK+W,MAAMtH,QAAQrK,OAAO,QACvBN,KAAK,QAAS,gBACdA,KAAK,UAAU,QACfA,KAAK,YAAY,QACjBA,KAAK,IAAK,SAAA2B,GAAO,OAAO+C,EAAKiL,gBAAgBhO,KAC7C3B,KAAK,IAAK,SAAA2B,GAAO,OAAO+C,EAAKkL,gBAAgBjO,KAC7C3B,KAAK,cAAe,UACpBL,KAAK,SAAAgC,GAAO,OAAO+C,EAAK6K,cAAc5N,KAEzCzG,KAAKgX,SAAW,CAAC1C,EAAI,WAAYhT,EAAG,QACpC,IAAI2V,EAAY5G,IAAQrQ,KAAKgX,UAC7BhX,KAAKkX,cAAgBlX,KAAKwQ,EAAElE,UAAU,eACrCzF,KAAKoQ,GAENjX,KAAKkX,cAAczH,QAAQrK,OAAO,QAC/BN,KAAK,QAAS,cACdA,KAAK,UAAU,QACfA,KAAK,YAAY,QACjBA,KAAK,IAAK,SAAA2B,GAAO,OAAO+C,EAAKoL,kBAAkBnO,KAC/C3B,KAAK,IAAK,SAAA2B,GAAO,OAAO+C,EAAKqL,kBAAkBpO,KAC/C3B,KAAK,cAAe,UACpBL,KAAK,SAAAgC,GAAO,OAAO+C,EAAKwN,SAASvQ,KACjCG,OAAO,SAAUH,GAChB,OAAQ,GAALA,IAKJ3B,KAAK,YAAY,QACjBA,KAAK,KAAK,yDAQFqS,GACD,GAAPA,EACDnX,KAAKgW,WAAWE,MAAM,IAAK7F,MAAY8F,SAASnW,KAAKkV,eAAerQ,EAAE7E,KAAK6Q,OAAOhM,IAClE,GAAPsS,EACTnX,KAAKgW,WAAWE,MAAM,IAAK7F,MAAY8F,SAASnW,KAAKkV,eAAerQ,EAAE7E,KAAKoX,YAAY9N,KAAKtJ,QAC5E,GAAPmX,GACTnX,KAAKgW,WAAWE,MAAM,IAAK7F,MAAY8F,SAASnW,KAAKkV,eAAerQ,EAAE7E,KAAKqX,aAAa/N,KAAKtJ,QAE/FA,KAAKiV,YAAckC,EACnBnX,KAAKgW,WAAWsB,MAAM,GAAGC,UACzBvX,KAAKwX,aAAaL,wCAGPA,GACD,GAAPA,EACD9G,IAAa,iBACVvL,KAAK,UAAU,WAElBuL,IAAa,iBACVvL,KAAK,UAAW,QAEX,GAAPqS,EACD9G,IAAa,eACVvL,KAAK,UAAU,WAEhBuL,IAAa,eACVvL,KAAK,UAAU,4CAGZ2B,GACV,OAAOzG,KAAK8V,cAAcrP,EAAEkQ,UAAU9R,uCAG3B4B,GAEX,IADA,IAAIgR,EAAQhR,EAAEwK,SACNhM,EAAI,EAAGA,EAAIwS,EAAM3T,OAAQmB,IAC/B,GAAGwS,EAAMxS,IAAMjF,KAAK8U,WAClB,OAAO9U,KAAK2U,aAAa,GAG7B,OAAO3U,KAAK2U,aAAa,kCAEpBlO,GACL,OAAQ/D,KAAKgV,IAAIjR,EAAEyN,OAAQ,GAAOlU,KAAKkV,+CAIvClV,KAAK+U,QAAQjQ,KAAK,KAAM,SAAA2B,GAAO,OAAOA,EAAE5B,IAC3BC,KAAK,KAAM,SAAA2B,GAAO,OAAOA,EAAEnB,6CAGzB6R,EAAKQ,GACpB3X,KAAKiV,YAAckC,EACnBnX,KAAK8U,WAAa6C,EAClBtH,IAAU,qBAAqB5L,KAAKzE,KAAKyV,gBAAgBkC,IACzD3X,KAAKsV,aAAa6B,wFAOLS,GACb,IAAIC,EAAM,CACPC,mBAAkB,EAClBC,UAAc,EACdC,gBAAc,EACdC,uBAAwB,GAEvBC,EAAUN,EAAQ1X,IAAI,SAAUuG,EAAExB,GACpC,MAAO,CACL8C,GAAK9C,EACLiP,OAAS,GACT0C,aAAcnQ,EAAE0R,aAChBpV,MAAuB,GAAhBL,KAAK0V,SACZnH,SAAWxK,EAAE4R,SACb1B,SAAUkB,EAAIpR,EAAE6R,UAChBzT,EAAmB,IAAhBnC,KAAK0V,SACR9S,EAAmB,IAAhB5C,KAAK0V,YAIZ,OADAF,EAAQvJ,KAAK,SAAUhO,EAAEiO,GAAI,OAAOA,EAAE7L,MAAQpC,EAAEoC,QACzCmV,8CAIP,IAAMK,EAAclI,IAAiBrQ,KAAKyJ,IAAI8J,QAAQJ,EACtDnT,KAAKK,MAAMoO,gBAAgB,CAAC,CAAE7I,EAAG,GAAK2S,EAAatV,MAAO,gDAIpD,IAAAuK,EAAAxN,KACN,OACEU,EAAAC,EAAAC,cAAA,OAAKE,UAAU,cAAc+O,IAAK,SAAAC,GAAU,OAAItC,EAAKnC,cAAgByE,IACnEpP,EAAAC,EAAAC,cAAA,OAAKE,UAAU,mBAAmBiH,GAAG,mBAAmB8H,IAAK,SAAApG,GAAS+D,EAAK9D,OAASD,aAtWrEtI,+BCOjBqX,uBACJ,SAAAA,EAAYnY,GAAO,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAwY,IACjBzY,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAA+U,GAAAzP,KAAA/I,KAAMK,KAED2I,MAAQ,CACXyP,UAAU,GAGZ1Y,EAAK2Y,aAAe3Y,EAAK2Y,aAAapP,KAAlB7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KAPHA,4EAUNsK,GACX,IAAMsO,EAjBY,SAAChH,GACrB,IAAM/M,EAAQ+M,EAAKiH,UAAU,EAAGjH,EAAK7N,OAAS,GAAGc,MAAM,KACvD,MAAO,CAAEwI,IAAK6B,OAAOC,SAAStK,EAAM,IAAKyI,IAAK4B,OAAOC,SAAStK,EAAM,KAejDiU,CAAcxO,EAAMC,OAAOqH,MACtCmH,EAASrV,OAAAC,EAAA,EAAAD,CAAOzD,KAAKK,MAAM0C,OAE3BgW,EAAQ/Y,KAAKK,MAAM0C,MAAMiW,UAAU,SAAAC,GAAI,OAAIjO,IAAQ2N,EAAUM,MACpD,IAAXF,GAAcD,EAAUI,OAAOH,EAAO,GACtC1O,EAAMC,OAAO6O,SAASL,EAAUhR,KAAK6Q,GAErC3Y,KAAKK,MAAM6G,UAAUlH,KAAKK,MAAM6G,SAAS4R,qCAGrC1L,EAAKC,GACb,OAA4E,IAArErN,KAAKK,MAAM0C,MAAMiW,UAAU,SAAAC,GAAI,OAAIjO,IAAQiO,EAAM,CAAE7L,MAAKC,2CAGxD,IAAA7D,EAAAxJ,KAcDoZ,EAAOjV,YAAM,EAAGkV,GAAUnZ,IAAI,SAAAkN,GAAG,OACrC1M,EAAAC,EAAAC,cAAA,MAAIC,IAAKuM,GAdK,SAACA,GACf,OAAOjJ,YAAM,EAAGmV,GAAUpZ,IAAI,SAAAmN,GAAG,OAC/B3M,EAAAC,EAAAC,cAAA,MAAIC,IArCC,GAqCKuM,EAAM,GAAYC,GAC1B3M,EAAAC,EAAAC,cAAA,SACE2Y,KAAK,WACL5H,KAAI,IAAA5Q,OAAMqM,EAAN,KAAArM,OAAasM,EAAb,KACJ8L,QAAS3P,EAAKgQ,UAAUpM,EAAKC,GAC7BnG,SAAUsC,EAAKkP,aACfe,SAAUjQ,EAAKnJ,MAAMqZ,UAAYlQ,EAAKnJ,MAAMqZ,QAAQtM,GAAKC,QAO5DsM,CAAQvM,MAIb,OACE1M,EAAAC,EAAAC,cAAA,OAAKE,UAAU,wCACbJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,sBAAhB,6BAGAJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,+BACbJ,EAAAC,EAAAC,cAAA,SAAOE,UAAU,qBACfJ,EAAAC,EAAAC,cAAA,aACGwY,aAtDWjY,cA+D1BqX,GAAYoB,aAAe,CACzB7W,MAAO,IAYMyV,qCChFf,SAASqB,KAAsB,QAAAC,EAAAxS,UAAAxD,OAAN+C,EAAM,IAAAkT,MAAAD,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAANnT,EAAMmT,GAAA1S,UAAA0S,GAC7B,MAAO,CAAEnT,KAAMoT,KAAavG,WAAb,EAAAjQ,OAAAC,EAAA,EAAAD,CAAiBoD,EAAK3G,IAAI,SAAAuG,GAAC,OAAIA,EAAEI,UAIlD,IAAMqT,GAAW,SAAAC,GAAA,IAAGlB,EAAHkB,EAAGlB,KAAH,OACfvY,EAAAC,EAAAC,cAAA,OAAKE,UAAU,gBACbJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,sBAAsBmY,EAAKtH,MAC3CjR,EAAAC,EAAAC,cAAA,QAAME,UAAU,uBAAuBmY,EAAKmB,SAuYjCC,eAlYb,SAAAA,EAAYha,GAAO,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAqa,IACjBta,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAA4W,GAAAtR,KAAA/I,KAAMK,KAED2I,MAAQ,CACXsR,WAAY,CACVC,OAAQla,EAAMwG,KACd9C,UAAW1D,EAAMwG,KACjBrD,SAAUnD,EAAMwG,KAChB2T,SAAUna,EAAMwG,KAChB4T,YAAapa,EAAMwG,MAErB6T,aAAc,CACZH,OAAQ,GACRxW,UAAW,GACXP,SAAU,GACVgX,SAAU,GACVC,YAAa,IAEfzS,aAAc3H,EAAMwG,MAItB9G,EAAK4a,iBAAmB,KAIxB5a,EAAK6a,cAAgB,CACnBL,OAAQ,KACRxW,UAAW,KACXP,SAAU,KACVgX,SAAU,KACVC,YAAa,MAGf1a,EAAK8a,iBAAmB,GACxB9a,EAAK+a,gBAAkB,GACvB/a,EAAKgb,gBAAkB,GAEvB1a,EAAMwG,KAAKA,KAAK3B,QAAQ,SAAAuB,GACtB1G,EAAK8a,iBAAiBpU,EAAEpD,eAAe8E,YAAc,IAAIxE,IACzD8C,EAAEpD,eAAeU,UAAUmB,QAAQ,SAAA5E,GACjCP,EAAK8a,iBAAiBpU,EAAEpD,eAAe8E,YAAY6S,IAAI1a,KAGzDP,EAAK+a,gBAAgBrU,EAAEpD,eAAe8E,YAAc,IAAIxE,IACxD8C,EAAEpD,eAAeO,iBAAiBsB,QAAQ,SAAA+V,GACxClb,EAAK+a,gBAAgBrU,EAAEpD,eAAe8E,YAAY6S,IAAIC,KAExDxU,EAAEpD,eAAeQ,iBAAiBqB,QAAQ,SAAAgW,GACxCnb,EAAK+a,gBAAgBrU,EAAEpD,eAAe8E,YAAY6S,IAAIE,KAGxDnb,EAAKgb,gBAAgBtU,EAAEpD,eAAe8E,YAAc,IAAIxE,IACxD8C,EAAEpD,eAAemX,SAAStV,QAAQ,SAAAiW,GAChCpb,EAAKgb,gBAAgBtU,EAAEpD,eAAe8E,YAAY6S,IAAIG,OAI1Dpb,EAAKqb,SAAW,CACdb,OAAQ,SAACA,GACP,OAAKA,EAAOzW,OAEL,CACL+C,KAAM9G,EAAKM,MAAMwG,KAAKA,KAAKD,OAAO,SAACH,GACjC,QAAK8T,EAAO/Z,SAASiG,EAAEpD,eAAe0C,kBAJfhG,EAAKM,MAAMwG,MASxC9C,UAAW,SAACA,GACV,OAAKA,EAAUD,OAER,CACL+C,KAAM9G,EAAKM,MAAMwG,KAAKA,KAAKD,OAAO,SAACH,GACjC,QAAK1C,EAAUsX,KAAK,SAAA/a,GAClB,OAAOP,EAAK8a,iBAAiBpU,EAAEpD,eAAe8E,YAAYmT,IAAIhb,EAASqR,WAL/C5R,EAAKM,MAAMwG,MAW3CrD,SAAU,SAACA,GACT,OAAKA,EAASM,OAEP,CACL+C,KAAM9G,EAAKM,MAAMwG,KAAKA,KAAKD,OAAO,SAACH,GACjC,QAAKjD,EAAS6X,KAAK,SAAAE,GACjB,OAAOxb,EAAK+a,gBAAgBrU,EAAEpD,eAAe8E,YAAYmT,IAAIC,EAAQ5J,WAL9C5R,EAAKM,MAAMwG,MAW1C2T,SAAU,SAACA,GACT,OAAKA,EAAS1W,OAEP,CACL+C,KAAM9G,EAAKM,MAAMwG,KAAKA,KAAKD,OAAO,SAACH,GACjC,QAAK+T,EAASa,KAAK,SAAAF,GACjB,OAAOpb,EAAKgb,gBAAgBtU,EAAEpD,eAAe8E,YAAYmT,IAAIH,EAAQxJ,WAL9C5R,EAAKM,MAAMwG,MAW1C4T,YAAa,SAACA,GACZ,OAAKA,EAAY3W,OAEV,CACL+C,KAAM9G,EAAKM,MAAMwG,KAAKA,KAAKD,OAAO,SAACH,GACjC,QAAKgU,EAAYe,MAAM,SAAA7C,GACrB,OAAOlS,EAAEpD,eAAehC,EAAUsX,EAAStL,MAAM7M,SAASwB,EAAU2W,EAASvL,WALnDrN,EAAKM,MAAMwG,OA1G9B9G,uEAyHjB,OAAO0D,OAAOqD,OAAO9G,KAAKgJ,MAAM0R,cAAcc,MAAM,SAAAzY,GAAK,OAAqB,IAAjBA,EAAMe,qDAGjD8C,GAClB,OAAOiT,GAAYnG,WAAZ,EAAAjQ,OAAAC,EAAA,EAAAD,CAAgBA,OAAOgY,QAAQzb,KAAKgJ,MAAMsR,YAC9C1T,OAAO,SAAA8U,GAAA,IAAAC,EAAAlY,OAAAmY,GAAA,EAAAnY,CAAAiY,EAAA,GAAE7a,EAAF8a,EAAA,GAAAA,EAAA,UAAkB9a,IAAQ+F,IACjC1G,IAAI,SAAA2b,GAAA,IAAAC,EAAArY,OAAAmY,GAAA,EAAAnY,CAAAoY,EAAA,GAAAC,EAAA,UAAAA,EAAA,iDAKP,OADa9b,KAAK+b,oBAAoB,UAC1BlV,KAAK3G,IAAI,SAAAuG,GAAC,OAAIA,EAAEpD,eAAe0C,4DAI3C,IAAMc,EAAO7G,KAAK+b,oBAAoB,aAEhCC,EAAM,IAAI/L,IAOhB,OANApJ,EAAKA,KAAK3B,QAAQ,SAAAuB,GAChBA,EAAEpD,eAAeU,UAAUmB,QAAQ,SAAA5E,GACjC0b,EAAIV,IAAIhb,GAAY0b,EAAIC,IAAI3b,EAAU0b,EAAIE,IAAI5b,GAAY,GAAK0b,EAAIC,IAAI3b,EAAU,OAI9EmD,OAAAC,EAAA,EAAAD,CAAIuY,GACRrN,OACAwN,OAAO,SAAC/N,EAADgO,GAAA,IAAAC,EAAA5Y,OAAAmY,GAAA,EAAAnY,CAAA2Y,EAAA,GAAOvb,EAAPwb,EAAA,GAAYtZ,EAAZsZ,EAAA,UAAA5Y,OAAAC,EAAA,EAAAD,CAA2B2K,GAA3BrN,OAAA,CAAgC,CAAC4Q,KAAM9Q,EAAKuZ,MAAOrX,MAAS,+CAGrD,IAAAyG,EAAAxJ,KACX6G,EAAO7G,KAAK+b,oBAAoB,YAEhCC,EAAM,IAAI/L,IAOhB,OANApJ,EAAKA,KAAK3B,QAAQ,SAAAuB,GAChB+C,EAAKsR,gBAAgBrU,EAAEpD,eAAe8E,YAAYjD,QAAQ,SAAAqW,GACxDS,EAAIV,IAAIC,GAAWS,EAAIC,IAAIV,EAASS,EAAIE,IAAIX,GAAW,GAAKS,EAAIC,IAAIV,EAAS,OAI1E9X,OAAAC,EAAA,EAAAD,CAAIuY,GACRrN,OACAwN,OAAO,SAAC/N,EAADkO,GAAA,IAAAC,EAAA9Y,OAAAmY,GAAA,EAAAnY,CAAA6Y,EAAA,GAAOzb,EAAP0b,EAAA,GAAYxZ,EAAZwZ,EAAA,UAAA9Y,OAAAC,EAAA,EAAAD,CAA2B2K,GAA3BrN,OAAA,CAAgC,CAAC4Q,KAAM9Q,EAAKuZ,MAAOrX,MAAS,+CAItE,IAAM8D,EAAO7G,KAAK+b,oBAAoB,YAEhCC,EAAM,IAAI/L,IAOhB,OANApJ,EAAKA,KAAK3B,QAAQ,SAAAuB,GAChBA,EAAEpD,eAAemX,SAAStV,QAAQ,SAAAiW,GAChCa,EAAIV,IAAIH,GAAWa,EAAIC,IAAId,EAASa,EAAIE,IAAIf,GAAW,GAAKa,EAAIC,IAAId,EAAS,OAI1E1X,OAAAC,EAAA,EAAAD,CAAIuY,GACRrN,OACAwN,OAAO,SAAC/N,EAADoO,GAAA,IAAAC,EAAAhZ,OAAAmY,GAAA,EAAAnY,CAAA+Y,EAAA,GAAO3b,EAAP4b,EAAA,GAAY1Z,EAAZ0Z,EAAA,UAAAhZ,OAAAC,EAAA,EAAAD,CAA2B2K,GAA3BrN,OAAA,CAAgC,CAAC4Q,KAAM9Q,EAAKuZ,MAAOrX,MAAS,mDAYtE,IARA,IAAM8D,EAAO7G,KAAKgJ,MAAMhB,aAKlB0U,EAAWvY,YAAM,EAAGmV,GAEpBqD,EAAW,GACRvP,EAAM,EAAGA,GANL,IAMoBA,EAAK,CACpCuP,EAASvP,GAAO,GAChB,IAAK,IAAIC,EAAM,EAAGA,GAPP,IAOsBA,EAC/BsP,EAASvP,GAAKC,IAAO,EAazB,OATAxG,EAAKA,KAAK3B,QAAQ,SAAAuB,GAChBiW,EAASxX,QAAQ,SAAAmI,GACf5G,EAAEpD,eAAehC,EAAUgM,IAAMnI,QAAQ,SAAA0I,GACvC,IAAMR,EAAM1L,EAAUkM,GACjB+O,EAASvP,GAAKC,KAAMsP,EAASvP,GAAKC,IAAO,SAK7CsP,gDAIanX,EAAWoX,GAC/B,OAAK5R,IAAQ4R,EAAW5c,KAAKgJ,kDAIZ4B,EAAWC,GAAW,IAAA2C,EAAAxN,KACvC,GAAI6K,IAAc7K,KAAKgJ,MAAvB,CAEA,IAAKgC,IAAQH,EAAU6P,aAAc1a,KAAKgJ,MAAM0R,cAAe,CAC7D,IAAMJ,EAAa,GACnB7W,OAAOuI,KAAKhM,KAAKob,UAAUlW,QAAQ,SAAA0B,GAC5BoE,IAAQH,EAAU6P,aAAa9T,GAAS4G,EAAKxE,MAAM0R,aAAa9T,MACnE0T,EAAW1T,GAAU4G,EAAK4N,SAASxU,GAAQ4G,EAAKxE,MAAM0R,aAAa9T,OAGnEnD,OAAOuI,KAAKsO,GAAYxW,QAC1B9D,KAAKkL,SAAS,SAAClC,EAAO3I,GAAR,MAAmB,CAC/Bia,WAAW7W,OAAA8K,EAAA,EAAA9K,CAAA,GACNuF,EAAMsR,WACNA,MAMX,IAAKtP,IAAQH,EAAUyP,WAAYta,KAAKgJ,MAAMsR,YAAa,CACzD,IAAMuC,EAAkBhD,GAAYnG,WAAZ,EAAAjQ,OAAAC,EAAA,EAAAD,CAAgBA,OAAOqD,OAAO9G,KAAKgJ,MAAMsR,cACjEta,KAAKkL,SAAS,CACZlD,aAAc6U,IAEhB7c,KAAKK,MAAMyc,mBAAmBD,sCAIzB,IAAAjN,EAAA5P,KAaP,OAXIA,KAAKgJ,MAAMhB,eAAiBhI,KAAK2a,mBACnC3a,KAAK2a,iBAAmB3a,KAAKgJ,MAAMhB,aACnChI,KAAK4a,cAAgB,CACnBL,OAAQva,KAAK+c,kBACbhZ,UAAW/D,KAAKgd,oBAChBxZ,SAAUxD,KAAKid,mBACfzC,SAAUxa,KAAKkd,mBACfzC,YAAaza,KAAKmd,yBAKpBzc,EAAAC,EAAAC,cAAA,OAAKE,UAAU,WACbJ,EAAAC,EAAAC,cAAA,oBACAF,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eACbJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,sBAAhB,SAGAJ,EAAAC,EAAAC,cAAC+F,EAAA,YAAD,CACEE,KAAM7G,KAAK4a,cAAcL,OACzBrT,SAAU,SAAAqT,GACR3K,EAAK1E,SAAS,CACZwP,aAAajX,OAAA8K,EAAA,EAAA9K,CAAA,GACRmM,EAAK5G,MAAM0R,aADJ,CAEVH,cAIN6C,YAAY,uBACZxW,OAAO,WACP7D,MAAO/C,KAAKgJ,MAAM0R,aAAaH,UAEnC7Z,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eACbJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,sBAAhB,SAGAJ,EAAAC,EAAAC,cAAC+F,EAAA,YAAD,CACEE,KAAM7G,KAAK4a,cAAc7W,UACzBmD,SAAU,SAAAnD,GACR6L,EAAK1E,SAAS,CACZwP,aAAajX,OAAA8K,EAAA,EAAA9K,CAAA,GACRmM,EAAK5G,MAAM0R,aADJ,CAEV3W,iBAINqZ,YAAY,0BACZrW,WAAW,OACXC,UAAU,OACVqW,cAAenD,GACfnX,MAAO/C,KAAKgJ,MAAM0R,aAAa3W,aAEnCrD,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eACbJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,sBAAhB,WAGAJ,EAAAC,EAAAC,cAAC+F,EAAA,YAAD,CACEE,KAAM7G,KAAK4a,cAAcpX,SACzB0D,SAAU,SAAA1D,GACRoM,EAAK1E,SAAS,CACZwP,aAAajX,OAAA8K,EAAA,EAAA9K,CAAA,GACRmM,EAAK5G,MAAM0R,aADJ,CAEVlX,gBAIN4Z,YAAY,0BACZxW,OAAO,WACPG,WAAW,OACXC,UAAU,OACVqW,cAAenD,GACfnX,MAAO/C,KAAKgJ,MAAM0R,aAAalX,YAEnC9C,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eACbJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,sBAAhB,aAGAJ,EAAAC,EAAAC,cAAC+F,EAAA,YAAD,CACEE,KAAM7G,KAAK4a,cAAcJ,SACzBtT,SAAU,SAAAsT,GACR5K,EAAK1E,SAAS,CACZwP,aAAajX,OAAA8K,EAAA,EAAA9K,CAAA,GACRmM,EAAK5G,MAAM0R,aADJ,CAEVF,gBAIN4C,YAAY,0BACZxW,OAAO,WACPG,WAAW,OACXC,UAAU,OACVqW,cAAenD,GACfnX,MAAO/C,KAAKgJ,MAAM0R,aAAaF,YAGnC9Z,EAAAC,EAAAC,cAAC0c,GAAD,CACEva,MAAO/C,KAAKgJ,MAAM0R,aAAaD,YAC/BvT,SAAU,SAAAuT,GACR7K,EAAK1E,SAAS,CACZwP,aAAajX,OAAA8K,EAAA,EAAA9K,CAAA,GACRmM,EAAK5G,MAAM0R,aADJ,CAEVD,mBAINf,QAAS1Z,KAAK4a,cAAcH,eAE5Bza,KAAKuM,SACL7L,EAAAC,EAAAC,cAAC2c,EAAA,SAAD,KACE7c,EAAAC,EAAAC,cAAA,KAAGE,UAAU,wBAAb,SACQJ,EAAAC,EAAAC,cAAA,QAAME,UAAU,gCAAgCd,KAAKgJ,MAAMhB,aAAanB,KAAK/C,QAClF,IAFH,OAEWpD,EAAAC,EAAAC,cAAA,QAAME,UAAU,gCAAgCd,KAAKK,MAAMwG,KAAKA,KAAK/C,QAFhF,aAKApD,EAAAC,EAAAC,cAAA,OAAKE,UAAU,sBACbJ,EAAAC,EAAAC,cAAA,UACEE,UAAU,iBACV0c,QAAS,kBAAM5N,EAAK1E,SAAS,CAC3BwP,aAAcjX,OAAOgY,QAAQ7L,EAAK5G,MAAM0R,cACrCyB,OAAO,SAACzO,EAAD+P,GAAA,IAAAC,EAAAja,OAAAmY,GAAA,EAAAnY,CAAAga,EAAA,GAAOtK,EAAPuK,EAAA,GAAAA,EAAA,UAAAja,OAAA8K,EAAA,EAAA9K,CAAA,GAAqBiK,EAArBjK,OAAAka,GAAA,EAAAla,CAAA,GAA2B0P,EAAI,MAAM,QAJnD,0BAzWQhS,6BCLPyc,OAdf,SAAAzD,GAA0C,IAAf1V,EAAe0V,EAAf1V,KAAMoZ,EAAS1D,EAAT0D,MAC/B,OACEnd,EAAAC,EAAAC,cAAA,OAAKE,UAAU,qBACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,yBAAyB2E,MAAO,CAACqY,WAAYD,KAC5Dnd,EAAAC,EAAAC,cAAA,QAAME,UAAU,2BAA2B2D,KCE3C4P,WAAgB,CACpBC,EAAG,mBACHhT,EAAG,YACHC,EAAG,gBACHC,EAAG,yBAGC+S,GAAe,CACnBD,EAAG,UACHhT,EAAG,UACHC,EAAG,UACHC,EAAG,WAGL,SAASuc,GAAT5D,GAAsC,IAChC6D,EADgC7D,EAAV8D,OACP/d,IAAI,SAAA+C,GAAK,OAC1BvC,EAAAC,EAAAC,cAAA,MAAIC,IAAKoC,EAAMwB,MACb/D,EAAAC,EAAAC,cAACsd,GAAoBjb,MAIzB,OACEvC,EAAAC,EAAAC,cAAA,OAAKE,UAAU,gBACbJ,EAAAC,EAAAC,cAAA,UACGod,QAaHG,eACJ,SAAAA,EAAY9d,GAAO,IAAAN,EAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAme,GACjBpe,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAA0a,GAAApV,KAAA/I,KAAMK,IAEN,IACM+d,EAAepa,EAAa9D,IAAI,SAAAqZ,GAAI,MAAK,CAAE9U,KAAM8U,EAAMsE,MAAO5Z,EAAkBsV,MAChF8E,EAAiBla,YAAM,GAAGjE,IAAI,SAAA+E,GAAC,MAAK,CAAER,KAAM4P,GAAcpP,GAAI4Y,MAAOtJ,GAAatP,MALvE,OAOjBlF,EAAKue,QAAU,CACbpe,IAAMQ,EAAAC,EAAAC,cAACmd,GAAD,CAAkBE,OALR,CAAC,CAAExZ,KAAM,UAAWoZ,MAAO,cAM3CU,OAAS7d,EAAAC,EAAAC,cAACmd,GAAD,CAAkBE,OAAQG,IACnC5a,SAAW9C,EAAAC,EAAAC,cAACmd,GAAD,CAAkBE,OAAQI,KAVtBte,qFAcGyF,EAAWoX,GAC/B,OAAI5c,KAAKK,MAAMC,SAASC,WAAaiF,EAAUlF,SAASC,0CAIjD,IAAAiJ,EAAAxJ,KACDwe,EAAQ/a,OAAOuI,KAAKhM,KAAKse,SAASpW,KAAK,SAAAsW,GAAK,OAAIhV,EAAKnJ,MAAMC,SAASC,SAASC,SAASge,KAE5F,OACE9d,EAAAC,EAAAC,cAAC6d,GAAA,EAAD,CACEC,QAAM,EACNV,MAAOQ,EACPG,KAAM,CAAEzY,OAAQ,EAAG0Y,QAAS,GAC5BnP,MAAO,CAAEvJ,OAAQ,OAAQ0Y,QAAS,GAClCC,MAAO,CAAE3Y,OAAQ,EAAG0Y,QAAS,IAC5B,SAAAJ,GAAK,YACMjX,IAAViX,GACG,SAAAne,GAAK,OACJK,EAAAC,EAAAC,cAAC6d,GAAA,EAASK,IAAV,CAAcrZ,MAAKhC,OAAA8K,EAAA,EAAA9K,CAAA,GAAOpD,IACvBmJ,EAAK8U,QAAQE,cAlCJrd,aA0CXC,eAAW+c,ICpFpB7V,WAAmB,SAACC,GAAD,OAAgBA,EAAWC,SAAS,KAAKC,KAAKC,IAAYC,SAAS,MA6I7EoW,+LAzIX/e,KAAKgf,OAASta,YAAO1E,KAAKif,WAAWxZ,MAAM,QAAS,SACpDzF,KAAKyJ,IAAM/E,YAAO1E,KAAK0J,QAAQ5E,KAAK,SAAU,GAE9C9E,KAAK2F,OAAS,CAAED,IAAK,GAAIwD,MAAO,GAAIC,OAAQ,GAAIrD,KAAM,IACtD9F,KAAKkf,UAAY,GACjBlf,KAAKmf,WAAa,GAElBnf,KAAKiL,WAAWjL,KAAKK,MAAM+e,8CAGlBvY,GAAM,IAAA9G,EAAAC,KACf,GAAK6G,GAASA,EAAK/C,OAAnB,CAEA,IAAMub,EAAYxY,EAAKyY,QAAQpf,IAAI,SAACuG,EAAGxB,GAAJ,OAAAxB,OAAA8K,EAAA,EAAA9K,CAAA,GAAgBgD,EAAhB,CAAmBxB,QAAMsa,UACtDlT,EAAYrM,KAAKyJ,IAAI6C,UAAU,KAAKzF,KAAKwY,GAEzCpB,EAASpX,EAAK3G,IAAI,SAACoP,EAAQyJ,GAC/B,IAAIjT,EAAOe,EAAK,GAAGjB,EAAI7F,EAAK4F,OAAOG,KAC/BJ,EAAkB,EAAZmB,EAAK,GAAGjB,EAAmB,EAAX0J,EAAO1J,EAAQ7F,EAAK4F,OAAOD,IACjDO,EAAQY,EAAK,GAAGjB,EAAI7F,EAAKmf,UAO7B,OANInG,IAAUlS,EAAK/C,OAAS,IAC1BgC,GAAQwJ,EAAO1J,EACfF,GAAO4J,EAAO1J,EACdK,GAASqJ,EAAO1J,GAGX,CAAEE,OAAMJ,MAAKO,WAKhBuZ,EAAwB,EAAZ3Y,EAAK,GAAGjB,EAAQ5F,KAAK2F,OAAOD,IAAM1F,KAAK2F,OAAOwD,OAC1DsW,EAAkBD,EAAYxf,KAAKyJ,IAAI3E,KAAK,UAC5C4a,EAA0B,EAAZ7Y,EAAK,GAAGjB,EAAQ5F,KAAK2F,OAAOG,KAAO9F,KAAK2F,OAAOuD,MAAQlJ,KAAKkf,UAAYlf,KAAKmf,WAC3FQ,EAAoBD,EAAczQ,OAAOC,SAASlP,KAAKyJ,IAAIhE,MAAM,SAASlC,QAAQ,KAAM,KAE9FvD,KAAKgf,OACFzW,aACEQ,KAAKT,IACL7C,MAAM,QAHX,GAAA1E,OAGuB2e,EAHvB,OAKA1f,KAAKyJ,IACFlB,aACEQ,KAAKT,IACLxD,KAAK,SAAU0a,GAEpBnT,EAAUkD,OACLxG,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,QACfI,KAAK,UAAW,KACpBiE,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,QACfI,KAAK,UAAW,KACtByD,aACEQ,KAAKT,IACLS,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,UACfI,KAAK,KAAM+B,EAAK,GAAGjB,EAAI7F,EAAK4F,OAAOG,MACnChB,KAAK,KAAM,SAAA2B,GAAC,OAAgB,EAAZI,EAAK,GAAGjB,EAAQa,EAAEb,EAAI7F,EAAK4F,OAAOD,MAClDZ,KAAK,UAAW,KACpB0K,SAELnD,EACG9D,aACEQ,KAAKT,IACLS,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,UACfI,KAAK,UAAW,GAChBA,KAAK,IAAK,SAAA2B,GAAC,OAAIA,EAAEb,IACjBd,KAAK,KAAM+B,EAAK,GAAGjB,EAAI7F,EAAK4F,OAAOG,MACnChB,KAAK,KAAM,SAAA2B,GAAC,OAAgB,EAAZI,EAAK,GAAGjB,EAAQa,EAAEb,EAAI7F,EAAK4F,OAAOD,QACtDqD,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,QACfI,KAAK,UAAW,GAChBA,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,OAC5BhB,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAOmY,EAAOxX,EAAExB,GAAGgB,QAC/CnB,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,MAC5BZ,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,QAChCqD,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,QACfI,KAAK,UAAW,GAChBA,KAAK,IAAK,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAOmY,EAAOxX,EAAExB,GAAGgB,MAAQ,IACtDnB,KAAK,IAAK,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,MAC3BjB,KAAK,SAAAgC,GAAC,OAAIA,EAAExD,UAErBoJ,EAAUoD,QAAQrK,OAAO,KACpB2D,KAAK,SAAAyH,GAAC,OAAIA,EAAEpL,OAAO,UACfN,KAAK,IAAK,SAAA2B,GAAC,OAAIA,EAAEb,IACjBd,KAAK,KAAM+B,EAAK,GAAGjB,EAAI7F,EAAK4F,OAAOG,KAAO6Z,EAAoB,GAC9D7a,KAAK,KAAM,SAAA2B,GAAC,OAAgB,EAAZI,EAAK,GAAGjB,EAAQa,EAAEb,EAAI7F,EAAK4F,OAAOD,IAAM+Z,IACxD3a,KAAK,UAAW,KACpBiE,KAAK,SAAAyH,GAAC,OAAIA,EAAEpL,OAAO,QACfN,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAO6Z,EAAoB,IACvD7a,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAOmY,EAAOxX,EAAExB,GAAGgB,MAAQ0Z,EAAoB,IAC3E7a,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,IAAM+Z,IAClC3a,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,IAAM+Z,IAClC3a,KAAK,kBAAmB,cACxBA,KAAK,UAAW,KACpBiE,KAAK,SAAAyH,GAAC,OAAIA,EAAEpL,OAAO,QACfN,KAAK,IAAK,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAOmY,EAAOxX,EAAExB,GAAGgB,MAAQ,EAAI0Z,EAAoB,IAC9E7a,KAAK,IAAK,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,IAAM+Z,IACjC3a,KAAK,qBAAsB,WAC3BL,KAAK,SAAAgC,GAAC,OAAIA,EAAExD,QACZ6B,KAAK,UAAW,KACtByD,aACEQ,KAAKT,IACLS,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,UACfI,KAAK,KAAM+B,EAAK,GAAGjB,EAAI7F,EAAK4F,OAAOG,MACnChB,KAAK,KAAM,SAAA2B,GAAC,OAAgB,EAAZI,EAAK,GAAGjB,EAAQa,EAAEb,EAAI7F,EAAK4F,OAAOD,MAClDZ,KAAK,UAAW,KACpBiE,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,QACfI,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,OAC5BhB,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAOmY,EAAOxX,EAAExB,GAAGgB,QAC/CnB,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,MAC5BZ,KAAK,KAAM,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,MAC5BZ,KAAK,UAAW,KACpBiE,KAAK,SAAAyH,GAAC,OAAIA,EAAE9L,OAAO,QACfI,KAAK,IAAK,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGa,KAAOmY,EAAOxX,EAAExB,GAAGgB,MAAQ,IACtDnB,KAAK,IAAK,SAAA2B,GAAC,OAAIwX,EAAOxX,EAAExB,GAAGS,MAC3BZ,KAAK,UAAW,iDAGR8F,GACbA,EAAUwU,YAAcpf,KAAKK,MAAM+e,WACrCpf,KAAKiL,WAAWjL,KAAKK,MAAM+e,4CAGtB,IAAA5V,EAAAxJ,KACP,OACEU,EAAAC,EAAAC,cAAA,OAAKE,UAAU,eAAe+O,IAAK,SAAAmP,GAAM,OAAIxV,EAAKyV,UAAYD,IAC5Dte,EAAAC,EAAAC,cAAA,OAAKiP,IAAK,SAAApG,GAAG,OAAID,EAAKE,OAASD,GAAKxD,MAAM,iBA9HxB9E,aCeXye,4LAdX,OACElf,EAAAC,EAAAC,cAAA,OAAKE,UAAU,WACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,gBACbJ,EAAAC,EAAAC,cAACif,GAAD,CAAShZ,KAAM7G,KAAKK,MAAMwG,KAAMiW,mBAAoB9c,KAAKK,MAAMyc,sBAEjEpc,EAAAC,EAAAC,cAAA,OAAKE,UAAU,mBACbJ,EAAAC,EAAAC,cAACkf,GAAD,CAAaV,UAAWpf,KAAKK,MAAM+e,YACnC1e,EAAAC,EAAAC,cAACmf,GAAD,eATY5e,cC0CP6e,8BA1Cb,SAAAA,EAAY3f,GAAO,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAggB,IACjBjgB,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAAuc,GAAAjX,KAAA/I,KAAMK,KAED2I,MAAQ,CACXiX,OAAQ5f,EAAM6f,aAAc,GAE9BngB,EAAKogB,SAAWpgB,EAAKogB,SAAS7W,KAAd7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KANCA,0EAUjBC,KAAKkL,SAAS,SAAAlC,GAAK,MAAK,CAAEiX,QAASjX,EAAMiX,2CAGlC,IAAAzW,EAAAxJ,KACP,OACEU,EAAAC,EAAAC,cAAA,OAAKE,UAAS,oBAAAC,OAAsBf,KAAKgJ,MAAMiX,OAAS,4BAA8B,KACpFvf,EAAAC,EAAAC,cAAA,OAAKE,UAAU,0BAA0B0c,QAASxd,KAAKmgB,UACrDzf,EAAAC,EAAAC,cAAA,QAAME,UAAU,gCAAgCd,KAAKK,MAAM+f,OAC3D1f,EAAAC,EAAAC,cAAA,QAAME,UAAU,iCAAhB,MAIFJ,EAAAC,EAAAC,cAAC6d,GAAA,EAAD,CAAQC,QAAM,EAACC,KAAM,CAAEzY,OAAQlG,KAAKgJ,MAAMiX,OAAS,OAAS,GAAKhf,GAAI,CAAEiF,OAAQlG,KAAKgJ,MAAMiX,OAAS,OAAS,IACzG,SAAA5f,GAAK,OACJK,EAAAC,EAAAC,cAAC6d,GAAA,EAASK,IAAV,CAAche,UAAU,4BAA4B2E,MAAOpF,GACzDK,EAAAC,EAAAC,cAAA,OAAKE,UAAU,mCACZ0I,EAAKnJ,MAAMggB,qBA3BClf,+bCiBdmf,GAAA,CACbhf,EAAGif,KACHhf,EAAGif,KACHhf,EAAGif,KACHhf,EAAGif,KACHze,EAAG0e,KACHC,EAAGC,KACHC,EAAGC,KACHC,EAAGC,KACHC,EAAGC,KACHC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,KACJC,GAAIC,MCiGSC,eAjIb,SAAAA,EAAYviB,GAAO,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAA4iB,IACjB7iB,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAAmf,GAAA7Z,KAAA/I,KAAMK,KAEDwiB,YAAc,KAHF9iB,qFAMGyF,GACpB,OAAIA,EAAUxC,UAAYhD,KAAKK,MAAM2C,SAChCwC,EAAUlF,WAAaN,KAAKK,MAAMC,+CAI3BwiB,GACZ,OAAOA,EACJ5iB,IAAI,SAAA6iB,GAAG,OAAKriB,EAAAC,EAAAC,cAAA,QAAMC,IAAKkiB,EAAKjiB,UAAU,6BAA6BiiB,KACnE5G,OAAO,SAAC6G,EAAKC,GAAN,MAAc,CAACD,EAAK,KAAMC,sCAG7B,IAAAzZ,EAAAxJ,KACP,IAAKA,KAAKK,MAAM2C,UAAYhD,KAAK6iB,YAAa,OAAO,KAErD,IAAM7f,EAAUhD,KAAKK,MAAM2C,SAAWhD,KAAK6iB,YAChB,OAAvB7iB,KAAKK,MAAM2C,UACbhD,KAAK6iB,YAAc7iB,KAAKK,MAAM2C,SALzB,IAAAkgB,EAoBHlgB,EAAQK,eAZV0C,EARKmd,EAQLnd,cACAod,EATKD,EASLC,qBACAhb,EAVK+a,EAUL/a,WACA/E,EAXK8f,EAWL9f,OACAggB,EAZKF,EAYLE,gBACAC,EAbKH,EAaLG,MACA7I,EAdK0I,EAcL1I,SACA5W,EAfKsf,EAeLtf,iBACAC,EAhBKqf,EAgBLrf,iBACAyf,EAjBKJ,EAiBLI,YACA5T,EAlBKwT,EAkBLxT,aACA3L,EAnBKmf,EAmBLnf,UAGIP,EAAWC,OAAAC,EAAA,EAAAD,CAAI,IAAIE,IAAJF,OAAAC,EAAA,EAAAD,CAAYG,GAAZ7C,OAAA0C,OAAAC,EAAA,EAAAD,CAAiCI,MAAoB8K,OAEpE4U,EAAQ,CACZtT,IAAK,CAAEuT,KAAI,gBAAAziB,OAAkBoH,GAAc/H,MAAO,QAClDwI,OAAQ,CAAE4a,KAAI,mBAAAziB,OAAqBoH,GAAc/H,MAAO,WACxDgU,SAAU,CAAEoP,KAAI,qBAAAziB,OAAuBoH,GAAc/H,MAAO,cAGxDqjB,EAAWhgB,OAAOuI,KAAKuX,GAAOrjB,IAAI,SAAAwjB,GACtC,IAAMvjB,EAAOojB,EAAMG,GACbtjB,EAAQoJ,EAAKnJ,MAAMC,SAASC,SAASC,SAASL,EAAKC,OACzD,OACEM,EAAAC,EAAAC,cAACI,EAAA,EAAD,CACEH,IAAK6iB,EACLziB,GAAId,EAAKqjB,KACT1iB,UAAS,uBAAAC,OAAyBX,EAAQ,8BAAgC,KACzEsjB,KAKP,OACEhjB,EAAAC,EAAAC,cAAA,OAAKE,UAAU,YACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,mBAAmB2E,MAAO,CAAEke,gBAAe,OAAA5iB,OAASuf,GAAcnY,GAAvB,QAC1DzH,EAAAC,EAAAC,cAAA,OAAKE,UAAU,qBACbJ,EAAAC,EAAAC,cAAA,OAAKE,UAAU,4BACbJ,EAAAC,EAAAC,cAAA,MAAIE,UAAU,mBAAmBiF,GACjCrF,EAAAC,EAAAC,cAAA,MAAIE,UAAU,sBAAsBiD,EAAUuJ,KAAK,QAErD5M,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACgjB,GAAD,CAAgBxD,MAAM,uBAAuBF,YAAY,GACvDxf,EAAAC,EAAAC,cAAA,UACEF,EAAAC,EAAAC,cAAA,4BACAF,EAAAC,EAAAC,cAAA,UACEF,EAAAC,EAAAC,cAACsd,GAAD,CAAiBzZ,KAAMiL,EAAcmO,MAAO5Z,EAAkByL,MAGhEhP,EAAAC,EAAAC,cAAA,iCACAF,EAAAC,EAAAC,cAAA,UAAKuiB,GAELziB,EAAAC,EAAAC,cAAA,2BACAF,EAAAC,EAAAC,cAAA,UAAKwiB,GAEL1iB,EAAAC,EAAAC,cAAA,iCACAF,EAAAC,EAAAC,cAAA,aAAAG,OAAQmC,YAAO,IAAPA,CAAYE,EAAOygB,YAAYtgB,QAAQ,KAAM,KAArD,QAEA7C,EAAAC,EAAAC,cAAA,4BACAF,EAAAC,EAAAC,cAAA,aAAAG,OAAQmC,YAAO,IAAPA,CAAYE,EAAOE,QAAQC,QAAQ,KAAM,KAAjD,QAEA7C,EAAAC,EAAAC,cAAA,wBACAF,EAAAC,EAAAC,cAAA,aAAAG,OAAQsiB,EAAMS,MAAd,OAAA/iB,OAAyBsiB,EAAMU,QAKnCrjB,EAAAC,EAAAC,cAACgjB,GAAD,CAAgBxD,MAAM,aACpB1f,EAAAC,EAAAC,cAAA,SACGZ,KAAKgkB,cAAcxJ,KAIxB9Z,EAAAC,EAAAC,cAACgjB,GAAD,CAAgBxD,MAAM,YACpB1f,EAAAC,EAAAC,cAAA,SACGZ,KAAKgkB,cAAcxgB,KAIxB9C,EAAAC,EAAAC,cAACgjB,GAAD,CAAgBxD,MAAM,eACpB1f,EAAAC,EAAAC,cAAA,SACC0iB,EAAY1e,MAAM,MAAM1E,IAAI,SAAC+Y,EAAMpY,GAClC,OAAOH,EAAAC,EAAAC,cAAC2c,EAAA,SAAD,CAAU1c,IAAKA,GAAMoY,EAAKvY,EAAAC,EAAAC,cAAA,iBAMvCF,EAAAC,EAAAC,cAAA,OAAKE,UAAU,mBACZ2iB,YAtHStiB,aCHhB8iB,yMACkBze,EAAWoX,GAC/B,OAAIpX,EAAUqB,OAAS7G,KAAKK,MAAMwG,MAC7BrB,EAAUuC,KAAO/H,KAAKK,MAAM0H,IAC5BvC,EAAUlF,WAAaN,KAAKK,MAAMC,0CAIhC,IAAAP,EAAAC,KACDkkB,EAAiBlkB,KAAKK,MAAMwG,KAAKA,KACpCsV,OAAO,SAAC6G,EAAKC,GAAN,OAAAxf,OAAA8K,EAAA,EAAA9K,CAAA,GAAoBuf,EAApBvf,OAAAka,GAAA,EAAAla,CAAA,GAA0Bwf,EAAI5f,eAAe8E,WAAazH,EAAAC,EAAAC,cAACujB,GAAD,CAASnhB,QAASigB,EAAK3iB,SAAUP,EAAKM,MAAMC,cAAiB,IAEjI,OACEI,EAAAC,EAAAC,cAAC6d,GAAA,EAAD,CACEC,QAAM,EACNV,MAAOhe,KAAKK,MAAM0H,GAClB4W,KAAM,CAAEC,QAAS,EAAGnO,UAAW,mBAC/BhB,MAAO,CAAEmP,QAAS,EAAGnO,UAAW,iBAChCoO,MAAO,CAAED,QAAS,EAAGnO,UAAW,oBAC/B,SAAA1I,GAAE,OACO,IAARA,GACG,SAAA1H,GAAK,OACJK,EAAAC,EAAAC,cAAC6d,GAAA,EAASK,IAAV,CAAche,UAAU,qBAAqB2E,MAAKhC,OAAA8K,EAAA,EAAA9K,CAAA,GAAOpD,IACtD6jB,EAAenc,cAvBF5G,cAoCfC,eAAW6iB,IC6BXG,8BAzDb,SAAAA,EAAY/jB,GAAO,IAAAN,EAAA,OAAA0D,OAAA+D,EAAA,EAAA/D,CAAAzD,KAAAokB,IACjBrkB,EAAA0D,OAAAoF,EAAA,EAAApF,CAAAzD,KAAAyD,OAAAqF,EAAA,EAAArF,CAAA2gB,GAAArb,KAAA/I,KAAMK,KAED2I,MAAQ,CACXhB,aAAc0N,GACd0J,UAAW,MAGbrf,EAAK+c,mBAAqB/c,EAAK+c,mBAAmBxT,KAAxB7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KAC1BA,EAAK0O,gBAAkB1O,EAAK0O,gBAAgBnF,KAArB7F,OAAA8F,EAAA,EAAA9F,QAAA8F,EAAA,EAAA9F,CAAA1D,KATNA,kFAYAskB,GACjBrkB,KAAKkL,SAAS,CACZlD,aAAcqc,4CAIFA,GACdrkB,KAAKkL,SAAS,CACZkU,UAAWiF,qCAIN,IAAA7a,EAAAxJ,KACP,OACEU,EAAAC,EAAAC,cAAC0jB,EAAA,EAAD,CAAQC,SAAUC,IAChB9jB,EAAAC,EAAAC,cAAA,OAAKE,UAAU,OACbJ,EAAAC,EAAAC,cAAC6jB,EAAD,MACA/jB,EAAAC,EAAAC,cAAA,OAAKE,UAAU,gBACbJ,EAAAC,EAAAC,cAAC8jB,GAAD,CAAS7d,KAAM6O,GAAUoH,mBAAoB9c,KAAK8c,mBAAoBsC,UAAWpf,KAAKgJ,MAAMoW,YAC5F1e,EAAAC,EAAAC,cAAC+jB,EAAA,EAAD,KACEjkB,EAAAC,EAAAC,cAACgkB,EAAA,EAAD,CAAOhd,KAAK,IAAIC,OAAK,EAACgd,OAAQ,SAAAxkB,GAAK,OACjCK,EAAAC,EAAAC,cAACkkB,EAAA,EAAD,CAAU7jB,GAAG,eAEfP,EAAAC,EAAAC,cAACgkB,EAAA,EAAD,CAAOhd,KAAK,OAAOid,OAAQ,SAAAxkB,GAAK,OAC9BK,EAAAC,EAAAC,cAACmkB,GAAD,CAAKle,KAAM6O,GAAU1N,aAAcwB,EAAKR,MAAMhB,aAAcyG,gBAAiBjF,EAAKiF,qBAEpF/N,EAAAC,EAAAC,cAACgkB,EAAA,EAAD,CAAOhd,KAAK,UAAUid,OAAQ,SAAAxkB,GAAK,OACjCK,EAAAC,EAAAC,cAACokB,EAAD,CAAQne,KAAM6O,GAAU1N,aAAcwB,EAAKR,MAAMhB,aAAcyG,gBAAiBjF,EAAKiF,qBAEvF/N,EAAAC,EAAAC,cAACgkB,EAAA,EAAD,CAAOhd,KAAK,YAAYid,OAAQ,SAAAxkB,GAAK,OACnCK,EAAAC,EAAAC,cAACqkB,GAAD,CAAUxW,gBAAiBjF,EAAKiF,sBAGpC/N,EAAAC,EAAAC,cAACgkB,EAAA,EAAD,CAAOC,OAAQ,SAAAxkB,GAAK,OAClBK,EAAAC,EAAAC,cAACskB,GAAD,CACEre,KAAM6O,GACN3N,GAAIkH,OAAOC,SAASjH,EAAa5H,EAAMC,0BAjDrCa,cCJEgkB,QACW,cAA7Bza,OAAOpK,SAAS8kB,UAEe,UAA7B1a,OAAOpK,SAAS8kB,UAEhB1a,OAAOpK,SAAS8kB,SAAShlB,MACvB,2DCNNilB,IAASR,OAAOnkB,EAAAC,EAAAC,cAAC0kB,GAAD,MAASC,SAASC,eAAe,SD+G3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,KAAK,SAAAC,GACjCA,EAAaC,+ylrBE3HnBpmB,EAAAC,QAAiBC,EAAAC,EAAuB,gFCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,0ECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,uFCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,2ECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,iECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,6ECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,uECAxCH,EAAAC,QAAiBC,EAAAC,EAAuB","file":"static/js/main.ac1fdb8b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/9-MERiT.483be082.jpg\";","module.exports = __webpack_public_path__ + \"static/media/10-Mo-Bo.87f2f9fc.jpg\";","module.exports = __webpack_public_path__ + \"static/media/11-Matt-och-steg.80797cbb.jpg\";","module.exports = __webpack_public_path__ + \"static/media/12-SAMIR.d14d2eb6.jpg\";","module.exports = __webpack_public_path__ + \"static/media/13-Sensorer-for-luftmiljo.4362eb63.jpg\";","module.exports = __webpack_public_path__ + \"static/media/14-R-energi.05d591b6.JPG\";","module.exports = __webpack_public_path__ + \"static/media/15-Sharing-Cities-Sweden.0c3256df.jpg\";","module.exports = __webpack_public_path__ + \"static/media/16-Matbutik.1f0245a6.jpg\";","module.exports = __webpack_public_path__ + \"static/media/17-Smart-Village.c9934f37.png\";","module.exports = __webpack_public_path__ + \"static/media/18-Smaskalig-elforsorjning.83dc4dda.jpg\";","module.exports = __webpack_public_path__ + \"static/media/19-Urban-ICT-Arena.d10de260.jpg\";","module.exports = __webpack_public_path__ + \"static/media/20-Vardeskapande-med-oppna-data.c4bb7c0c.jpg\";","module.exports = __webpack_public_path__ + \"static/media/21-3De.05da2369.jpg\";","import React, { Component } from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport { withRouter } from 'react-router';\r\nimport './Header.css';\r\n\r\nclass Header extends Component {\r\n  render() {\r\n    const views = ['Map', 'Matrix', 'Partners']\r\n    const viewLinks = views.map(view => {\r\n      const match = this.props.location.pathname.includes(view.toLowerCase());\r\n      return (\r\n        <li key={view}\r\n          className={`header-links__item ${match ? 'header-links__item--active' : ''}`}>\r\n          <Link to={`/${view.toLowerCase()}`}>\r\n            {view}\r\n          </Link>\r\n        </li>\r\n      );\r\n    });\r\n\r\n    return (\r\n      <div className=\"header\">\r\n        <div className=\"header-content\">\r\n          <div className=\"header-content__left\">\r\n            <ul className=\"header-links\">\r\n              {viewLinks}\r\n            </ul>\r\n          </div>\r\n          <div className=\"header-content__right\">\r\n            <ul className=\"header-links\">\r\n              <li className=\"header-links__item\"><a href=\"#\">About</a></li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Header);\r\n","import { scaleOrdinal, rgb, packSiblings, packEnclose, select, range, format } from 'd3';\r\n\r\nexport const col2focus = {\r\n  1: 'focus_lifestyle',\r\n  2: 'focus_planning',\r\n  3: 'focus_mobility',\r\n  4: 'focus_infrastructure'\r\n};\r\n\r\nexport const theme2row = {\r\n  testbeds: 1,\r\n  innovation: 2,\r\n  financing: 3,\r\n  management: 4,\r\n  intelligence: 5\r\n};\r\n\r\nexport const row2theme = {\r\n  1: 'testbeds',\r\n  2: 'innovation',\r\n  3: 'financing',\r\n  4: 'management',\r\n  5: 'intelligence'\r\n};\r\n\r\nexport const focusLabel = {\r\n  1: 'Livsstil och  konsumtion',\r\n  2: 'Planering och  byggd miljö',\r\n  3: 'Mobilitet och  tillgänglighet',\r\n  4: 'Integrerad  infrastruktur'\r\n};\r\n\r\nexport const themeLabel = {\r\n  1: 'Testbäddar och  living labs',\r\n  2: 'Innovation och  entreprenörskap',\r\n  3: 'Finansierings- och  affärsmodeller',\r\n  4: 'Styrning',\r\n  5: 'Intelligens,  cybersäkerhet  och etik'\r\n};\r\n\r\nexport const type2class = {\r\n  'Forskningsprojekt': 'research',\r\n  'Innovationsprojekt': 'innovation',\r\n  'Förstudie': 'prestudy'\r\n}\r\n\r\nexport function circleRadius(area) {\r\n  return Math.sqrt(area / Math.PI);\r\n}\r\n\r\nexport const circleSizes = {\r\n  ticks: {\r\n    value: project => 1,\r\n    label: label => `${format('d')(label)} tick`,\r\n    display: 'Tick',\r\n    key: 'ticks'\r\n  },\r\n  budget: {\r\n    value: project => project.survey_answers.budget.funded,\r\n    label: label => `${format(',')(label).replace(/,/g, ' ')} kr`,\r\n    display: 'Budget',\r\n    key: 'budget'\r\n  },\r\n  partners: {\r\n    value: project => [...new Set([...project.survey_answers.other_financiers, ...project.survey_answers.other_recipients])].length,\r\n    label: label => `${format('d')(label)} partners`,\r\n    display: 'Partners',\r\n    key: 'partners'\r\n  },\r\n  locations: {\r\n    value: project => project.survey_answers.locations.length,\r\n    label: label => `${format('d')(label)} platser`,\r\n    display: 'Platser',\r\n    key: 'locations'\r\n  }\r\n}\r\n\r\nexport const projectTypes = ['Forskningsprojekt', 'Innovationsprojekt', 'Förstudie'];\r\nexport const projectTypeColors = scaleOrdinal()\r\n  .range([rgb(0, 125, 145), rgb(151, 194, 142), rgb(234, 154, 0)]) // pms 3145, pms 2255, pms 2011\r\n  .domain(projectTypes);\r\n\r\nexport function packData(data, scaleX, scaleY, circleSize) {\r\n  // first, group together circles that are\r\n  // at the same position in the matrix\r\n  const obj = {};\r\n  for (let row = 1; row <= 5; ++row) {\r\n    obj[row] = {};\r\n    for (let col = 1; col <= 4; ++col) {\r\n      obj[row][col] = [];\r\n    }\r\n  }\r\n  data.data.forEach(project => {\r\n    const pins = []; // so that a circle can find its buddies\r\n    for (let col = 1; col <= 4; ++col) {\r\n      project.survey_answers[col2focus[col]].forEach(theme => {\r\n        pins.push({\r\n          row: theme2row[theme],\r\n          col\r\n        });\r\n        obj[theme2row[theme]][col].push({\r\n          row: theme2row[theme],\r\n          col,\r\n          pins,\r\n          survey_answers: project.survey_answers,\r\n          r: circleRadius(circleSize.value(project))\r\n        })\r\n      });\r\n    }\r\n  });\r\n\r\n  // first pass: pack circles and find the \"optimal scale\"\r\n  // and redo the circle radii to use that scale\r\n  let maxEnclose = 0;\r\n  for (let row = 1; row <= 5; ++row) {\r\n    for (let col = 1; col <= 4; ++col) {\r\n      if (!obj[row][col].length) continue; // if empty continue\r\n      packSiblings(obj[row][col]);\r\n      maxEnclose = Math.max(maxEnclose, packEnclose(obj[row][col]).r);\r\n    }\r\n  }\r\n  const optimalEncloseRadius = Math.min(scaleX.step() / 2, scaleY.step() / 2); // * 0.95?\r\n  const rScale = optimalEncloseRadius / maxEnclose;\r\n  for (let row = 1; row <= 5; ++row) {\r\n    for (let col = 1; col <= 4; ++col) {\r\n      obj[row][col].forEach(pin => {\r\n        pin.r = circleRadius(circleSize.value(pin)) * rScale;\r\n      });\r\n    }\r\n  }\r\n\r\n  // second pass: pack again, fix positions\r\n  // and return as a flat list\r\n  const arr = [];\r\n  for (let row = 1; row <= 5; ++row) {\r\n    for (let col = 1; col <= 4; ++col) {\r\n      packSiblings(obj[row][col]).forEach(pin => {\r\n        arr.push({\r\n          ...pin,\r\n          x: pin.x + scaleX(col),\r\n          y: pin.y + scaleY(row),\r\n          rScale\r\n        })\r\n      });\r\n    }\r\n  }\r\n  return arr;\r\n}\r\n\r\nexport function buildScaleData(packedData, circleSize) {\r\n  if (!packedData.length) return null;\r\n\r\n  const sortedPackedData = [...packedData].sort((a, b) => circleSize.value(a) - circleSize.value(b));\r\n  const minSize = circleSize.value(sortedPackedData[0]);\r\n  const maxSize = circleSize.value(sortedPackedData[sortedPackedData.length - 1]);\r\n  const rScale = packedData[0].rScale;\r\n\r\n  let labelNumbers = [];\r\n  const circleRadii = [];\r\n\r\n  labelNumbers[0] = Number.parseInt(maxSize).toPrecision(1);\r\n  labelNumbers[1] = Number.parseInt(maxSize / 2).toPrecision(1);\r\n  labelNumbers[2] = Number.parseInt(maxSize / 10).toPrecision(1);\r\n  labelNumbers = labelNumbers.map(number => number === '0' ? 1 : number);\r\n\r\n  circleRadii[0] = circleRadius(labelNumbers[0]) * rScale;\r\n  circleRadii[1] = circleRadius(labelNumbers[1]) * rScale;\r\n  circleRadii[2] = circleRadius(labelNumbers[2]) * rScale;\r\n\r\n  if (Number.parseInt(maxSize).toPrecision(1) === Number.parseInt(minSize).toPrecision(1))\r\n    return [{\r\n      r: circleRadii[0],\r\n      label: circleSize.label(labelNumbers[0])\r\n    }];\r\n\r\n  return range(3).map(i => ({\r\n    r: circleRadii[i],\r\n    label: circleSize.label(labelNumbers[i])\r\n  }));\r\n}\r\n\r\n// inspired by https://bl.ocks.org/mbostock/7555321\r\n// replaces double spaces in the labels with fake \"newlines\"\r\n// (tspan elements) and fixes their positions\r\nexport function parseNewlinesY(texts) {\r\n  texts.each(function() {\r\n    const text = select(this);\r\n    const words = text.text().split(/ {2}/);\r\n    const x = text.attr('x');\r\n    const dy = parseFloat(text.attr('dy'));\r\n    text.text(null);\r\n    const lineHeight = 1.3; // em\r\n    let i = 0;\r\n    words.forEach(word => {\r\n      text.append('tspan')\r\n          .text(word)\r\n          .attr('x', x)\r\n          .attr('y', `-${(words.length - 1) * lineHeight / 2}em`)\r\n          .attr('dy', `${dy + (i++ * lineHeight)}em`);\r\n    });\r\n  });\r\n}\r\nexport function parseNewlinesX(texts) {\r\n  texts.each(function() {\r\n    const text = select(this).attr('text-anchor', 'start');\r\n    const words = text.text().split(/ {2}/);\r\n    const y = text.attr('y');\r\n    const dy = parseFloat(text.attr('dy'));\r\n    text.text(null);\r\n    const lineHeight = 1.3; // em\r\n    let i = 0;\r\n    words.forEach(word => {\r\n      text.append('tspan')\r\n          .text(word)\r\n          .attr('x', 0)\r\n          .attr('dy', `${dy + (i++ * lineHeight)}em`);\r\n    });\r\n    text.attr('transform', `translate(0,${y})rotate(-45)translate(0,${-y})`);\r\n  });\r\n}","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './MatrixTooltip.css';\r\n\r\nconst topOffset = 10;\r\n\r\nclass MatrixTooltip extends Component {\r\n  shouldComponentUpdate(nextProps) {\r\n    if (nextProps.project !== this.props.project) return true;\r\n    return false;\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.project) return null;\r\n\r\n    return (\r\n      <div\r\n        className=\"matrix-tooltip\"\r\n        style={{\r\n          top: this.props.project.y + this.props.margin.top - this.props.project.r - topOffset + this.props.offset.y,\r\n          left: this.props.project.x + this.props.margin.left + this.props.offset.x\r\n        }}>\r\n        {this.props.project.survey_answers.project_title}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMatrixTooltip.propTypes = {\r\n  project: PropTypes.object,\r\n  margin: PropTypes.shape({\r\n    top: PropTypes.number,\r\n    right: PropTypes.number,\r\n    bottom: PropTypes.number,\r\n    left: PropTypes.number\r\n  }).isRequired,\r\n  offset: PropTypes.shape({\r\n    x: PropTypes.number,\r\n    y: PropTypes.number\r\n  }).isRequired\r\n};\r\n\r\nexport default MatrixTooltip;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { DropdownList } from 'react-widgets'\r\nimport { circleSizes } from './MatrixUtility';\r\nimport './MatrixCircleMenu.css';\r\n\r\nclass MatrixCircleMenu extends Component {\r\n  /**\r\n   * ALT POLYGONS FOR ARROWS:\r\n   *  <polygon points={`${offset} ${r}, ${t + offset} ${r + t}, ${t + offset} ${r - t}`} />\r\n   *  <polygon points={`${r * 2 - offset} ${r}, ${r * 2 - t - offset} ${r + t}, ${r * 2 - t - offset} ${r - t}`} />\r\n   */\r\n\r\n  render() {\r\n    const r = 10;\r\n    const t = 3;\r\n    const offset = 2;\r\n\r\n    return (\r\n      <div className=\"matrix-circle-menu\">\r\n        <svg width={r * 2 + 2} height={r * 2 + 2}>\r\n          <circle cx={r + 1} cy={r + 1} r={r} />\r\n          <line x1={offset + 1} x2={r * 2 - offset + 1} y1={r + 1} y2={r + 1} />\r\n          <path d={`M ${t + offset + 1} ${r + t + 1} L ${offset + 1} ${r + 1} L ${t + offset + 1} ${r - t + 1}`} />\r\n          <path d={`M ${r * 2 - t - offset + 1} ${r + t + 1} L ${r * 2 - offset + 1} ${r + 1} L ${r * 2 - t - offset + 1} ${r - t + 1}`} />\r\n        </svg>\r\n        <DropdownList\r\n          filter={false}\r\n          data={Object.values(circleSizes)}\r\n          valueField='key'\r\n          textField='display'\r\n          value={this.props.circleSize}\r\n          onChange={this.props.updateCircleSize} />\r\n      </div>\r\n    );\r\n  }  \r\n}\r\n\r\nMatrixCircleMenu.propTypes = {\r\n  circleSize: PropTypes.string.isRequired,\r\n  updateCircleSize: PropTypes.func.isRequired\r\n}\r\n\r\nexport default MatrixCircleMenu;\r\n","import { matchPath } from 'react-router';\r\n\r\n// NOTE: For all methods that take props as an argument, it assumed that props is an object which contains\r\n// the history property and the filteredData property. If the history property is missing, make sure to \r\n// use the 'withRouter' higher-order-component on whatever component ProjectNavigator is used from.\r\nclass ProjectNavigator {\r\n  constructor(rootPath = '') {\r\n    this.rootPath = rootPath;\r\n    this._hasChangedSinceInit = false;\r\n  }\r\n\r\n  static GetProjectId(location) {\r\n    const match = matchPath(location.pathname, { path: `*/project/:id` });\r\n    if (match !== null)\r\n      return match.params.id;\r\n    return -1;\r\n  }\r\n\r\n  hasChangedSinceInit() {\r\n    return this._hasChangedSinceInit;\r\n  }\r\n\r\n  change() {\r\n    this._hasChangedSinceInit = true;\r\n  }\r\n\r\n  redirectToRoot(history) {\r\n    history.replace(this.rootPath);\r\n  }\r\n\r\n  goToRoot(history, location) {\r\n    if (matchPath(location.pathname, { path: this.rootPath, exact: true }) === null) {\r\n      this._hasChangedSinceInit = true;\r\n      history.push(this.rootPath);\r\n    }\r\n  }\r\n\r\n  goToProject(history, location, id) {\r\n    const path = `${this.rootPath}/project/${id}`;\r\n    if (matchPath(location.pathname, { path }) === null) {\r\n      this._hasChangedSinceInit = true;\r\n      history.push(path);\r\n    }\r\n  }\r\n\r\n  projectExists(location, filteredData) {\r\n    const id = ProjectNavigator.GetProjectId(location);\r\n    if (filteredData.data.find(d => d.survey_answers.project_id === id))\r\n      return true;\r\n    return false;\r\n  }\r\n\r\n  projectHasChanged(location, prevLocation) {\r\n    return ProjectNavigator.GetProjectId(location) !== ProjectNavigator.GetProjectId(prevLocation);\r\n  }\r\n}\r\n\r\nexport const GetProjectId = ProjectNavigator.GetProjectId;\r\nexport default ProjectNavigator;\r\n","import React, { Component } from 'react';\r\nimport { select, axisLeft, axisTop, event, scalePoint, easePolyOut } from 'd3';\r\nimport { themeLabel, focusLabel, packData, buildScaleData, parseNewlinesY, parseNewlinesX, type2class, circleSizes } from './MatrixUtility';\r\nimport { withRouter } from 'react-router-dom';\r\nimport MatrixTooltip from './MatrixTooltip';\r\nimport MatrixCircleMenu from './MatrixCircleMenu';\r\nimport PropTypes from 'prop-types';\r\nimport isEqual from 'react-fast-compare';\r\nimport debounce from 'lodash.debounce';\r\nimport ProjectNavigator from '../ProjectNavigator';\r\nimport './Matrix.css';\r\n\r\nconst masterTransition = (transition) => transition.duration(800).ease(easePolyOut.exponent(4));\r\n\r\nclass Matrix extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      hoveredProject: null,\r\n      circleSize: circleSizes.ticks\r\n    };\r\n\r\n    this.margin = { top: 130, right: 20, bottom: 20, left: 160 };\r\n    this.offset = { x: 0,  y: 0 };\r\n    this.projectNavigator = new ProjectNavigator('/matrix');\r\n    this.draw = this.draw.bind(this);\r\n    this.updateCircleSize = this.updateCircleSize.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.svg = select(this.svgRef);\r\n\r\n    // used for transforming the contents of the svg, if necessary\r\n    this.svgInner = this.svg\r\n      .append('g')\r\n        .classed('matrix-svg-inner', true);\r\n\r\n    // used for moving around the circle menu\r\n    this.circleSizeWrapper = select(this.circleSizeWrapperRef)\r\n      .style('transform', 'translate(0, 0)');\r\n\r\n    this.scaleX = scalePoint()\r\n        .domain([1,2,3,4])\r\n        .padding(0.5)\r\n    this.scaleY = scalePoint()\r\n        .domain([1,2,3,4,5])\r\n        .padding(0.5)\r\n\r\n    // y-axis\r\n    this.svgInner.append('g')\r\n        .classed('matrix-y-axis', true);\r\n\r\n    // themes label\r\n    this.svgInner.append('text')\r\n        .classed('themes-label', true)\r\n        .classed('matrix-axis-label', true)\r\n        .text('Teman');\r\n\r\n    // x-axis\r\n    this.svgInner.append('g')\r\n        .classed('matrix-x-axis', true);\r\n\r\n    // focus areas label\r\n    this.svgInner.append('text')\r\n        .classed('focus-areas-label', true)\r\n        .classed('matrix-axis-label', true)\r\n        .text('Fokusområden');\r\n\r\n    // make some circles\r\n    this.circles = this.svgInner.append('g').classed('circles', true);\r\n    this.draw(true);\r\n\r\n    // clear clickedProject when clicking outside of any circle\r\n    this.svg.on('click', () => {\r\n      if (event.target.tagName !== 'circle') {\r\n        this.projectNavigator.goToRoot(this.props.history, this.props.location);\r\n      }\r\n    });\r\n\r\n    this.debounce = debounce(() => this.draw(), 100);\r\n    window.addEventListener('resize', this.debounce);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    this.updateHovered(this.state.hoveredProject, prevState.hoveredProject);\r\n    this.updateClicked(this.props, prevProps);\r\n\r\n    if (!isEqual(this.props.filteredData, prevProps.filteredData) ||\r\n      this.state.circleSize !== prevState.circleSize) {\r\n      this.updateData(this.props.filteredData);\r\n      this.setState({\r\n        hoveredProject: null\r\n      });\r\n      this.projectNavigator.goToRoot(this.props.history, this.props.location);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.debounce);\r\n    this.svg.on('click', null);\r\n  }\r\n\r\n  draw(init = false) {\r\n    let height = +this.svgWrapperRef.clientHeight - this.margin.top - this.margin.bottom;\r\n    let width = +this.svgWrapperRef.clientWidth - this.margin.left - this.margin.right;\r\n\r\n    // 300 px is the size of the infobox that appears when a project is clicked!\r\n    if (this.projectNavigator.projectExists(this.props.location, this.props.filteredData)) width -= 300;\r\n    \r\n    const stretch = false;\r\n    if (!stretch) {\r\n      const aspectRatio = 5 / 5; // 4 / 5 is \"optimal\"\r\n      const optimalHeight = width * 1 / aspectRatio;\r\n      const optimalWidth = height * aspectRatio;\r\n\r\n      if ((optimalHeight + this.margin.top + this.margin.bottom) <= this.svgWrapperRef.clientHeight) {\r\n        this.offset = { x: 0, y: (height - optimalHeight) / 2 };\r\n        height = optimalHeight;\r\n      } else {\r\n        this.offset = { x: (width - optimalWidth) / 2, y: 0 };\r\n        width = optimalWidth;\r\n      }\r\n    }\r\n\r\n    \r\n\r\n    // update scales\r\n    this.scaleX.range([0, width]);\r\n    this.scaleY.range([0, height]);\r\n\r\n    // set up selectors\r\n    const selectors = {\r\n      svgInner: this.svgInner,\r\n      circleSizeWrapper: this.circleSizeWrapper,\r\n      yAxis: this.svgInner.select('g.matrix-y-axis'),\r\n      themesLabel: this.svgInner.select('text.themes-label'),\r\n      xAxis: this.svgInner.select('g.matrix-x-axis'),\r\n      focusAreasLabel: this.svgInner.select('text.focus-areas-label')\r\n    }\r\n    if (!init)\r\n      Object.keys(selectors).forEach(s => selectors[s] = selectors[s].transition().call(masterTransition));\r\n\r\n    selectors.svgInner\r\n        .attr('transform', `translate(${this.offset.x}, ${this.offset.y})`);\r\n\r\n    selectors.circleSizeWrapper\r\n        .style('top', `${this.offset.y + this.margin.top - 40}px`)\r\n        .style('left', `${this.offset.x + this.margin.left - 120}px`);\r\n        //.style('transform', `translate(${this.offset.x + this.margin.left - 120}px, ${this.offset.y + this.margin.top - 40}px)`);\r\n\r\n    // themes label\r\n    selectors.themesLabel\r\n        .attr('transform', `translate(25, ${this.margin.top + height / 2})rotate(-90)`);\r\n\r\n    // focus areas label\r\n    selectors.focusAreasLabel\r\n        .attr('transform', `translate(${this.margin.left + width / 2}, 35)`);\r\n\r\n    /**\r\n     * NOTE: The default text elements (labels) on the axes are hidden and replaced to\r\n     * allow for two things: (1) splitting up the labels into multiple lines and (2)\r\n     * having transitions. The default labels can support (1) and (2) separately but not \r\n     * at the same time! So that's why there's some extra code here\r\n     *\r\n     * We don't want remove the original text element and .domain,\r\n     * if we remove the text element, d3-axis will start fucking with our label\r\n     * (changin text contents, position etc)\r\n     * if we remove .domain, d3-axis will just add it again next draw call.\r\n     */\r\n\r\n    // (equivalent to axis.tickPadding [but hardcoded])\r\n    const tickPadding = 20;\r\n\r\n    // y-axis\r\n    selectors.yAxis\r\n        .attr('transform', `translate(${width + this.margin.left}, ${this.margin.top})`)\r\n        .call(axisLeft(this.scaleY).tickSize(width))\r\n    const yAxisSelection = selectors.yAxis.selection ? selectors.yAxis.selection() : selectors.yAxis;\r\n    if (yAxisSelection.selectAll('.tick text.label').empty()) {\r\n      yAxisSelection\r\n          .call(e => e.selectAll('.tick text').attr('display', 'none'))\r\n          .call(e => e.select('.domain').attr('display', 'none'))\r\n        .selectAll('.tick')\r\n        .append('text')\r\n          .classed('label', true)\r\n          .text(i => themeLabel[i])\r\n          .attr('fill', 'currentColor')\r\n          .attr('x', -width - tickPadding)\r\n          .attr('dy', '0.32em') // see d3-axis source code\r\n          .call(parseNewlinesY);\r\n    } else {\r\n      const x = -width - tickPadding;\r\n      selectors.yAxis.selectAll('.tick text.label')\r\n          .attr('x', x)\r\n        .selectAll('tspan')\r\n          .attr('x', x);\r\n    }\r\n\r\n    // x-axis\r\n    selectors.xAxis\r\n        .attr('transform', `translate(${this.margin.left}, ${height + this.margin.top})`)\r\n        .call(axisTop(this.scaleX).tickSize(height))\r\n    const xAxisSelection = selectors.xAxis.selection ? selectors.xAxis.selection() : selectors.xAxis;\r\n    if (xAxisSelection.selectAll('.tick text.label').empty()) {\r\n      xAxisSelection\r\n          .call(e => e.selectAll('.tick text').attr('display', 'none'))\r\n          .call(e => e.select('.domain').attr('display', 'none'))\r\n        .selectAll('.tick')\r\n        .append('text')\r\n          .classed('label', true)\r\n          .text(i => focusLabel[i])\r\n          .attr('fill', 'currentColor')\r\n          .attr('y', -height - tickPadding)\r\n          .attr('dy', '0em') // see d3-axis source code\r\n          .call(parseNewlinesX);\r\n    } else {\r\n      const y = -height - tickPadding;\r\n      selectors.xAxis.selectAll('.tick text.label')\r\n          .attr('y', y)\r\n          .attr('transform', `translate(0,${y})rotate(-45)translate(0,${-y})`);\r\n    }\r\n\r\n    this.updateData(this.props.filteredData);\r\n  }\r\n\r\n  updateHovered(project, prevProject) {\r\n    if (project === prevProject)\r\n      return;\r\n\r\n    if (prevProject !== null)\r\n      this.circles.selectAll('.hover')\r\n          .classed('hover', false);\r\n\r\n    if (project !== null)\r\n      this.circles.selectAll(`[data-id='${project.survey_answers.project_id}']`)\r\n          .classed('hover', true);\r\n  }\r\n\r\n  updateClicked(props, prevProps) {\r\n    let projectId = ProjectNavigator.GetProjectId(props.location);\r\n    let prevProjectId = ProjectNavigator.GetProjectId(prevProps.location);\r\n\r\n    // if we just started, (i.e. navigated to the site via a permalink with a project id)\r\n    // the projectId and prevProjectId will be identical because of how prevProps.location works\r\n    // so change it to -1.\r\n    if (!this.projectNavigator.hasChangedSinceInit()) {\r\n      prevProjectId = -1;\r\n      this.projectNavigator.change();\r\n    }\r\n\r\n    if (projectId === prevProjectId) return;\r\n\r\n    // necessary only if clicking a project changes svgWrapper size (i.e. infobox takes up more or less space than before)\r\n    if ((projectId === -1 && prevProjectId !== -1) || (projectId !== -1 && prevProjectId === -1))\r\n      this.draw();\r\n\r\n    // clean up from prev\r\n    if (prevProjectId !== -1 && this.svg.classed('clicked')) {\r\n      this.svg.classed('clicked', false);\r\n      this.circles.selectAll('.neighbor')\r\n          .classed('neighbor', false);\r\n      this.circles.selectAll('.clicked')\r\n          .classed('clicked', false);\r\n    }\r\n\r\n    // if no project in path, we done\r\n    if (projectId === -1) return;\r\n\r\n    // if the project from the url doesn't exist in filteredData, redirect to root\r\n    if (!this.projectNavigator.projectExists(props.location, props.filteredData)) {\r\n      this.projectNavigator.redirectToRoot(props.history);\r\n      return;\r\n    }\r\n\r\n    // make a mess with current\r\n    const datum = this.circles.select(`[data-id='${projectId}']`).datum();\r\n    const neighborSelector = datum.pins\r\n      .map(pin => `[data-row='${pin.row}'][data-col='${pin.col}']`)\r\n      .join(', ');\r\n    this.svg.classed('clicked', true);\r\n    this.circles.selectAll(neighborSelector)\r\n        .classed('neighbor', true);\r\n    this.circles.selectAll(`[data-id='${datum.survey_answers.project_id}']`)\r\n        .classed('clicked', true);\r\n  }\r\n\r\n  updateData(data) {\r\n    const packedData = packData(data, this.scaleX, this.scaleY, this.state.circleSize);\r\n    this.props.updateScaleData(buildScaleData(packedData, this.state.circleSize));\r\n    const circle = this.circles\r\n      .selectAll('circle')\r\n      .data(packedData, d => `${d.survey_answers.project_id}[${d.row},${d.col}]`);\r\n\r\n    circle.exit()\r\n        // NOTE: These lines caused a nasty bug when calling updateData more than once in quick succession\r\n        //       with different subsets of data. But they shouldn't be needed regardlessly.\r\n        //.on('mouseover', null)\r\n        //.on('mouseout', null)\r\n        //.on('click', null))\r\n      .transition()\r\n        .call(masterTransition)\r\n        .attr('r', 0)\r\n        .remove();\r\n\r\n    circle\r\n      .transition()\r\n        .call(masterTransition)\r\n        .attr('r', d => d.r)\r\n        .attr('transform', d => `translate(${d.x + this.margin.left},${d.y + this.margin.top})`);\r\n\r\n    circle.enter().append('circle')\r\n        .attr('transform', d => `translate(${d.x + this.margin.left},${d.y + this.margin.top})`)\r\n        .attr('data-id', d => d.survey_answers.project_id)\r\n        .attr('data-row', d => d.row)\r\n        .attr('data-col', d => d.col)\r\n        .attr('class', d => type2class[d.survey_answers.project_type])\r\n        .on('mouseover', d => this.setState({\r\n          hoveredProject: d\r\n        }))\r\n        .on('mouseout', d => this.setState({\r\n          hoveredProject: null\r\n        }))\r\n        .on('click', d => {\r\n          this.projectNavigator.goToProject(this.props.history, this.props.location, d.survey_answers.project_id);\r\n          this.setState({\r\n            hoveredProject: null\r\n          });\r\n        })\r\n        .attr('r', 0)\r\n      .transition()\r\n        .call(masterTransition)\r\n        .attr('r', d => d.r);\r\n  }\r\n\r\n  updateCircleSize(circleSize) {\r\n    this.setState({ circleSize });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"matrix-wrapper\" ref={svgWrapper => { this.svgWrapperRef = svgWrapper; }}>\r\n        <svg className=\"matrix\" width=\"100%\" height=\"100%\" ref={svg => { this.svgRef = svg; }} />\r\n        <MatrixTooltip project={this.state.hoveredProject} margin={this.margin} offset={this.offset} />\r\n        <div className=\"matrix-circle-scale-wrapper\" ref={circleSizeWrapper => { this.circleSizeWrapperRef = circleSizeWrapper; }}>\r\n          <MatrixCircleMenu updateCircleSize={this.updateCircleSize} circleSize={this.state.circleSize} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMatrix.propTypes = {\r\n  data: PropTypes.object.isRequired,\r\n  filteredData: PropTypes.object.isRequired,\r\n  updateScaleData: PropTypes.func.isRequired\r\n};\r\n\r\nexport default withRouter(Matrix);\r\n","import React, { Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport isEqual from 'react-fast-compare';\r\nimport { withRouter } from 'react-router-dom';\r\nimport * as d3 from 'd3';\r\nimport * as topojson from 'topojson';\r\nimport europe from '../assets/data/europe.topo.json';\r\nimport sweden from '../assets/data/sweden.topo.json';\r\nimport cities from '../assets/data/cities-v2.json';\r\nimport mockData from '../assets/data/mock-data-v8.json';\r\nimport project_coordinates from '../assets/data/project-coordinates.json';\r\nimport './Map.css';\r\nimport ProjectNavigator from '../ProjectNavigator';\r\nimport debounce from 'lodash.debounce';\r\n\r\n\r\nclass Map extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.margin = { top: 130, right: 20, bottom: 20, left: 160 };\r\n    this.offset = { x: 0,  y: 0 };\r\n    this.projectNavigator = new ProjectNavigator('/map');\r\n\r\n  }\r\n\r\n\r\n  // Render före compMount\r\n  componentDidMount(){\r\n\r\n    this.height = +this.svgWrapperRef.clientHeight - this.margin.top - this.margin.bottom;\r\n    this.width = +this.svgWrapperRef.clientWidth - this.margin.left - this.margin.right;\r\n\r\n    this.scaleLegendDebounce = debounce(() => this.updateScaleLegend(), 200);\r\n    this.zoom = d3.zoom()\r\n        .scaleExtent([1, 100])\r\n        .on(\"zoom.foo\", this.zoomed2.bind(this))\r\n        .on(\"zoom.bar\", () => {this.g.attr(\"transform\",  d3.event.transform);})\r\n        .on(\"zoom.legend\", this.scaleLegendDebounce);\r\n        // .on(this.updateData, this.zoomed2.bind(this));\r\n        // console.log(this.zoom);\r\n    this.projection = d3.geoMercator()\r\n        .rotate([5,-1])\r\n        // .scale(500)\r\n        // .center([15,58])\r\n        .scale(900)\r\n        .center([20,63])\r\n        .translate([this.width / 2, this.height / 2]);\r\n\r\n    this.path = d3.geoPath()\r\n        .projection(this.projection);\r\n\r\n    this.multiple_projects_box = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .classed(\"multiple_projects_box\",true)\r\n        .style(\"opacity\", 0);\r\n    this.svg = d3.select(this.svgRef)\r\n            .attr(\"width\", this.width)\r\n            .attr(\"height\", this.height)\r\n            .call(this.zoom);\r\n\r\n    this.svg.on('click', () => {\r\n      if (d3.event.target.tagName !== 'circle') {\r\n        this.projectNavigator.goToRoot(this.props.history, this.props.location);\r\n        this.multiple_projects_box.transition().style('opacity',0);\r\n        this.multiple_projects_box.text(\"\");\r\n      }\r\n    });\r\n\r\n    this.updateScaleLegend();\r\n\r\n    this.g = this.svg.append(\"g\");                              // The map itself\r\n\r\n    this.cities_container = this.svg.append(\"g\")                // All the black dot cities\r\n                          .classed(\"circle_box\",true);\r\n\r\n    this.projects = this.svg.append(\"g\");                       // All the projects + cities\r\n\r\n    // Tooltip for cities popup.\r\n    this.tooltip = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .attr(\"class\", \"tooltip_bubble\")\r\n        .style(\"opacity\", 0);\r\n\r\n    // Tooltip for projects popup\r\n    this.tooltip2 = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .attr(\"class\", \"tooltip_bubble2\")\r\n        .style(\"opacity\", 0);\r\n\r\n    // Tooltip for multi-proj.\r\n    this.tooltip3 = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .attr(\"class\", \"tooltip_bubble3\")\r\n        .attr(\"id\",\"tooltip_bubble3\")\r\n        .style(\"opacity\", 0);\r\n\r\n    this.tooltip3_showed = 0;\r\n    this.project_count_city = {};\r\n\r\n\r\n\r\n\r\n    this.cities_circles = this.cities_container.selectAll(\"circle\")\r\n       .data(cities).enter()\r\n       .append(\"circle\")\r\n       .attr(\"id\",function(d){return\"circle-\"+d.id})\r\n       .attr(\"cx\", d => {return this.projection([d.coordinates.x, d.coordinates.y])[0]; })\r\n       .attr(\"cy\", d => { return this.projection([d.coordinates.x, d.coordinates.y])[1]; })\r\n       .attr(\"r\", 1.2)\r\n       .attr(\"fill\",\"black\")\r\n       .on(\"mouseover\", d => {\r\n         this.tooltip.transition(\"tooltip-1\").style(\"opacity\", .9);\r\n         this.tooltip.html(\"<b>\"+d.name + \"</b>\")\r\n            .style(\"left\", (d3.event.offsetX) + \"px\")\r\n            .style(\"top\", (d3.event.offsetY - 18) + \"px\")\r\n            .style(\"max-width\",  200 + \"px\");\r\n       })\r\n       .on(\"mouseout\", d => { this.tooltip.transition().style(\"opacity\", 0); });\r\n\r\n       this.updateData(this.props.filteredData);\r\n        //Europe\r\n        this.g.selectAll(\".continent_Europe_subunits\")\r\n          .data(topojson.feature(europe, europe.objects.europe).features)\r\n            .enter().append(\"path\")\r\n            .attr(\"d\", this.path)\r\n            .attr(\"fill\",'#e4e4e4');\r\n        // Sweden\r\n        this.g.selectAll('.continent_Sweden_subnits')\r\n          .data(topojson.feature(sweden, sweden.objects.subunits).features)\r\n          .enter().append(\"path\")\r\n          .attr(\"class\", function(d) {return \"country-\" + d.id;})\r\n          .attr(\"d\", this.path)\r\n          .attr(\"fill\", '#bdbdbd'); //https://www.color-hex.com/color/d3d3d3#shades-tints\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    // console.log(prevProps);\r\n    // console.log(prevState);\r\n    // console.log(this.props.filteredData);\r\n    // this.updateHovered(this.state.hoveredProject, prevState.hoveredProject);\r\n    this.updateClicked(this.props, prevProps);\r\n\r\n    if (!isEqual(this.props.filteredData, prevProps.filteredData)) {\r\n      this.updateData(this.props.filteredData);\r\n      // this.setState({\r\n        // hoveredProject: null\r\n      // });\r\n      this.projectNavigator.goToRoot(this.props.history, this.props.location);\r\n    }\r\n  }\r\n\r\n  updateClicked(props, prevProps){\r\n    let projectId = ProjectNavigator.GetProjectId(props.location);\r\n    let prevProjectId = ProjectNavigator.GetProjectId(prevProps.location);\r\n\r\n    // if we just started, (i.e. navigated to the site via a permalink with a project id)\r\n    // the projectId and prevProjectId will be identical because of how prevProps.location works\r\n    // so change it to -1.\r\n    if (!this.projectNavigator.hasChangedSinceInit()) {\r\n      prevProjectId = -1;\r\n      this.projectNavigator.change();\r\n    }\r\n\r\n    if (projectId === prevProjectId) return;\r\n\r\n    // necessary only if clicking a project changes svgWrapper size (i.e. infobox takes up more or less space than before)\r\n    // if ((projectId === -1 && prevProjectId !== -1) || (projectId !== -1 && prevProjectId === -1))\r\n      // this.draw();\r\n\r\n    // if no project in path, we done\r\n    if (projectId === -1) return;\r\n\r\n    // if the project from the url doesn't exist in filteredData, redirect to root\r\n    if (!this.projectNavigator.projectExists(props.location, props.filteredData)) {\r\n      this.projectNavigator.redirectToRoot(props.history);\r\n      return;\r\n    }\r\n  }\r\n\r\n  updateData(dat){\r\n\r\n    var mockData_real = [];\r\n    let tetra = dat.data.length;\r\n    for(var i = 0; i < tetra; i++){\r\n      var da = dat.data[i].survey_answers;\r\n      var leng = da.locations.length;\r\n      for(var j = 0; j < leng; j++){\r\n        var obj = {};\r\n        //https://stackoverflow.com/questions/728360/how-do-i-correctly-clone-a-javascript-object\r\n        obj.survey_answers = JSON.parse(JSON.stringify(da));\r\n        obj.survey_answers.location = da.locations[j];\r\n        mockData_real.push(obj);\r\n      }\r\n    }\r\n    var loc_circles = [];\r\n    let tetr = mockData_real.length;\r\n    for(var i = 0; i < tetr; i ++){\r\n      var ob = {};\r\n      ob.name =  mockData_real[i].survey_answers.location;\r\n      ob.data = mockData_real[i];\r\n      loc_circles.push(ob);\r\n    }\r\n\r\n    // My variable names are awful here.\r\n    this.xx_loc = [];\r\n    for(var i = 0; i < tetr; i++){\r\n      var ab = loc_circles[i].name;\r\n      var xx = false;\r\n      for(var j = 0; j < this.xx_loc.length; j++){\r\n        var k = this.xx_loc[j].name;\r\n        if(ab.match(k)){\r\n          var tt = this.xx_loc[j].data;\r\n          tt.push(loc_circles[i].data);\r\n          this.xx_loc[j].data = tt;\r\n          xx = true;\r\n        }\r\n      }\r\n      if(xx == false){\r\n        var obj = {};\r\n        obj.name = ab;\r\n        var xxx = loc_circles[i].data;\r\n        obj.data = [];\r\n        obj.data.push(xxx);\r\n        this.xx_loc.push(obj);\r\n      }\r\n    }\r\n\r\n    this.project_circles = this.projects\r\n      .selectAll('circle')\r\n      .data(this.xx_loc, d => { return d.name;});\r\n    this.project_circles.exit()\r\n      .transition()\r\n      .attr('r',0)\r\n      .remove();\r\n\r\n      this.project_circles.transition()\r\n             .attr(\"r\", d => {\r\n               let a = d.data.length;\r\n               let i = d3.interpolateNumber(3+a, 30*a);\r\n               let x = ((d3.zoomTransform(this.svg.node()).y)*-1) -1000;\r\n               if(x > 0){\r\n                 let t = x/21776;\r\n                 return i(t);\r\n               }\r\n               return 3 + a;\r\n             });\r\n\r\n      this.project_circles.enter().append('circle')\r\n         .attr(\"id\",function(d,i){return\"project-\"+d.name;})\r\n         .attr(\"cx\", d => { let c = project_coordinates[d.name]; return this.projection([c.x,c.y])[0];})\r\n         .attr(\"cy\", d => { let c = project_coordinates[d.name]; return this.projection([c.x,c.y])[1];})\r\n         .attr('transform', d => {\r\n           // I hate projections.\r\n           let c = project_coordinates[d.name];\r\n           let cx = this.projection([c.x,c.y]);\r\n           var trans = d3.zoomTransform(this.svg.node());\r\n           var t = trans.apply(cx);\r\n           let x = [t[0] - cx[0], t[1]-cx[1]];\r\n           return \"translate(\" + x + \")\";\r\n         })\r\n         .classed(\"bubble\",\"true\")\r\n         .style(\"stroke-width\", .7)\r\n         .style(\"stroke\",\"#007082\")\r\n         // .attr(\"fill\",\"#007d91\")\r\n         .attr('fill','hsl(173, 100%, 37%)')  // Temporary\r\n         .on('mouseover', d => {\r\n           let tx = \"\"\r\n           if(d.data.length > 1){\r\n             tx = \"<b>\"+ d.name +\"</b><br>\" + d.data.length+ \" Projects\"\r\n           } else {\r\n             tx = \"<b>\" + d.name +\"</b>\\n<br>\" + d.data[0].survey_answers.project_title;\r\n           }\r\n             this.tooltip2.transition().style(\"opacity\", .9);\r\n             this.tooltip2.html(tx)\r\n                .style(\"left\", (d3.event.offsetX) + \"px\")\r\n                .style(\"top\", (d3.event.offsetY - 18) + \"px\")\r\n                .style(\"max-width\",  200 + \"px\");\r\n              })\r\n         .on('mouseout', d => { this.tooltip2.transition(\"check\").style(\"opacity\", 0);})\r\n         .on('click',d => {\r\n           if(d.data.length == 1) {\r\n             this.projectNavigator.goToProject(this.props.history, this.props.location, d.data[0].survey_answers.project_id);\r\n           } else {\r\n             this.multiple_projects_box.text('');\r\n             this.multiple_projects_box.transition().style(\"opacity\", .9);\r\n             var header = d3.select('.multiple_projects_box').append('h4')\r\n                  .style('margin-top','2px')\r\n                  .text(d.name + \" has \"+ d.data.length +\" projects\");\r\n\r\n            var projects_listed = d3.select('.multiple_projects_box').append('ul').classed('mp_inner_list',true);\r\n            projects_listed.exit().remove();\r\n            projects_listed.selectAll('li').data(d.data, d => {return d.survey_answers.project_id;})\r\n              .enter().append('li')\r\n              .style('cursor','pointer')\r\n              .on('click', d=>{\r\n                this.projectNavigator.goToProject(this.props.history, this.props.location, d.survey_answers.project_id);\r\n              })\r\n              .text(function(d){return d.survey_answers.project_title;});\r\n           }\r\n         })\r\n        .transition()\r\n         .attr(\"r\", d => {\r\n           let a = d.data.length;\r\n           let i = d3.interpolateNumber(3+a, 30*a);\r\n           let x = ((d3.zoomTransform(this.svg.node()).y)*-1) -1000;\r\n           if(x > 0){\r\n             let t = x/21776;\r\n             return i(t);\r\n           }\r\n           return 3 + a;\r\n         });\r\n  }\r\n\r\n\r\n  zoomed2(){\r\n    let afa = this.projects\r\n      .selectAll('circle')\r\n      .data(this.xx_loc, d => { return d.name;});\r\n\r\n      this.cities_circles.attr(\"transform\",this.circle_transform(d3.event.transform));\r\n      afa.attr(\"transform\",this.circle_transform(d3.event.transform));\r\n\r\n      this.cities_circles.attr(\"r\",this.circle_size_increase.bind(this));\r\n      afa.attr(\"r\",this.project_size_increase.bind(this));\r\n\r\n  }\r\n\r\n  circle_size_increase(d){\r\n    let i = d3.interpolateNumber(2, 20);\r\n    let x = (d3.event.transform.y * -1)-2000;\r\n    if(x > 0){\r\n      let t = x/21776;\r\n      return i(t);\r\n    }\r\n    return 1.3;\r\n  }\r\n\r\n  // Projects increase after zoom in factor X.\r\n  project_size_increase(d){\r\n    let a = d.data.length;\r\n    let i = d3.interpolateNumber(3+a, 30*a);\r\n    let x = (d3.event.transform.y * -1)-1000;\r\n    if(x > 0){\r\n      let t = x/21776;\r\n      return i(t);\r\n    }\r\n    return 3 + a;\r\n  }\r\n\r\n  // Semantic transformation\r\n  circle_transform(t) {\r\n    return function(d) {\r\n      let c = [this.getAttribute('cx'), this.getAttribute('cy')];\r\n      let r = t.apply(c);\r\n      let x = [r[0] - c[0], r[1]-c[1]];\r\n      return \"translate(\" + x + \")\";\r\n    };\r\n  }\r\n\r\n  updateScaleLegend() {\r\n    // Just copied this from the lines following \"this.project_circles.transition()...\"\r\n    // (lines 193-200) at the time of writing this.\r\n    const radius = (a) => {\r\n      let i = d3.interpolateNumber(3+a, 30*a);\r\n      // console.log(d3.zoomTransform(this.svg.node()));\r\n      let x = ((d3.zoomTransform(this.svg.node()).y)*-1) -1000;\r\n      if(x > 0){\r\n        let t = x/21776;\r\n        return i(t);\r\n      }\r\n      return 3 + a;\r\n    }\r\n\r\n    this.props.updateScaleData([\r\n      { r: radius(7), label: '7 projekt' },\r\n      { r: radius(4), label: '4 projekt' },\r\n      { r: radius(1), label: '1 projekt' }\r\n    ]);\r\n  }\r\n\r\n  // Efter constructor\r\n  render() {\r\n    return (\r\n      <div className=\"mapWrap\" ref={svgWrapper => this.svgWrapperRef = svgWrapper}>\r\n        <svg className=\"bubbles_svg_area\" id=\"bubbles_svg_area\" ref={svg => { this.svgRef = svg;}}></svg>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMap.propTypes = {\r\n  data: PropTypes.object.isRequired,\r\n  filteredData: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withRouter(Map);\r\n","import React, {Component} from 'react';\r\nimport * as d3 from 'd3';\r\nimport './Bubbles.css';\r\nimport mockData from '../assets/data/mock-data-v8.json';\r\nimport partners from '../assets/data/partners.json';\r\nimport debounce from 'lodash.debounce';\r\n\r\n\r\nclass Partners extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.omrade_titles = {\r\n      0: \"Civilsamhälle\",\r\n      1: \"Forskning\",\r\n      2: \"Näringsliv\",\r\n      3: \"Offentlig verksamhet\"\r\n    };\r\n\r\n\r\n    this.helix_colors = {\r\n      0 : \"#007d91\",\r\n      1 : \"#EA9A00\",\r\n      2 : \"#00A389\",\r\n      3 : \"#97C28E\"\r\n    };\r\n\r\n    this.helix_colors_borders = {\r\n      0 : \"#007082\",\r\n      1 : \"#d28a00\",\r\n      2 : \"#00927b\",\r\n      3 : \"#87ae7f\"\r\n    };\r\n\r\n    this.margin = { top: 130, right: 20, bottom: 20, left: 160 };\r\n    this.offset = { x: 0,  y: 0 };\r\n    // Hardcoded section titles\r\n    this.omrade_titles_x = {\r\n        3: 70,\r\n        0: 255,\r\n        1: 400,\r\n        2: 570\r\n    };\r\n    this.omrade_titles_y = {\r\n      3: 70,\r\n      0: 70,\r\n      1: 70,\r\n      2:50\r\n    };\r\n\r\n\r\n    // Location on screen\r\n    this.projectSpace = {\r\n      0 : 415,\r\n      1 : 730\r\n    };\r\n    this.projspace_title_x = {\r\n      0: 410,\r\n      1: 800\r\n    };\r\n    this.projspace_title_y = {\r\n      0: 10,\r\n      1: 80\r\n    };\r\n\r\n    this.project_no = -1;\r\n    this.bubbles = null;   // Bubbles in object.\r\n    this.nodes = {};            // Bubbles as nodes.\r\n    this.view_option = 0;\r\n\r\n    this.forceStrength = 0.025;\r\n\r\n    this.createNewNodes = this.createNewNodes.bind(this);\r\n\r\n  }\r\n\r\n  componentDidMount(){\r\n    // console.log(\"heck\");\r\n    this.height = +this.svgWrapperRef.clientHeight - this.margin.top - this.margin.bottom;\r\n    this.width = +this.svgWrapperRef.clientWidth - this.margin.left - this.margin.right;\r\n    // console.log(this.svgWrapperRef.clientHeight);\r\n    this.tooltip = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .attr(\"class\", \"tooltip_bubble_partners\")\r\n        .style(\"opacity\", 0);\r\n\r\n    // $(\"#dropdown_menu\").html(str);\r\n\r\n    this.button_collection = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .classed(\"button_collection\",true);\r\n\r\n    this.normal_button = this.button_collection.append(\"div\")\r\n            .classed(\"button\",true)\r\n            .classed(\"overview_button\",true)\r\n            .classed('button_selected',true)\r\n            .on('click', () => {d3.selectAll('.button').classed('button_selected',false);this.normal_button.classed('button_selected',true);this.move_bubbles(0);})\r\n            .text(\"Översikt\");\r\n    this.helix_button = this.button_collection.append(\"div\")\r\n        .classed(\"button\",true)\r\n        .classed(\"helix_button\",true)\r\n        .on('click', () => {d3.selectAll('.button').classed('button_selected',false);this.helix_button.classed('button_selected',true);this.move_bubbles(1);})\r\n        .text(\"Quadruple Helix\");\r\n\r\n    this.expand_button = this.button_collection.append(\"div\")\r\n        .classed(\"button\",true)\r\n        .classed(\"expand_button\",true)\r\n        .on('click', () => {d3.selectAll('.button_collections').style('display','initial');})\r\n        .text(\"Projekt ↓ \")\r\n\r\n    this.nodes = this.createNewNodes(partners);\r\n\r\n    this.projspace_title = {};\r\n    this.projspace_title[0] = \"Partners\";\r\n    for(var i = 0; i < mockData.data.length; i++){\r\n      this.projspace_title[mockData.data[i].survey_answers.project_id] = mockData.data[i].survey_answers.project_title;\r\n    }\r\n\r\n    // !!!!!!!!!!\r\n    // This is good code. Just needs to be placed elsewhere.\r\n    this.button_collections = d3.select(this.svgWrapperRef).append(\"div\")\r\n        .classed(\"button_collections\",true)\r\n        // .style('width','100%')\r\n        .style('background-color','lightgrey');\r\n    this.button_collections.append('h2').text(\"Projekt\").style('margin-top','2px');\r\n    this.project_buttons = this.button_collections.append(\"div\").selectAll('div')\r\n      .data(mockData.data);\r\n    this.project_buttons.enter().append('div')\r\n      // .text('hey')\r\n      .classed(\"buttons\",true)\r\n      .classed('project_button',true)\r\n      // .text( d => {console.log(d); return \"gaga\"});\r\n      .on('click', d => {this.change_view_spec(2, d.survey_answers.project_id);\r\n        d3.selectAll('.button_collections').style('display','none');\r\n        d3.selectAll('.button').classed('button_selected',false);\r\n        this.expand_button.classed('button_selected',true);})\r\n      .on('mouseover',function(d){\r\n        d3.select(this).style('background-color','white');\r\n      })\r\n      .on('mouseout',function(d){\r\n        d3.select(this).style('background-color','lightgrey');\r\n      })\r\n      .html( d => {return d.survey_answers.project_title + \"<br>\";});\r\n    // !!!!!!!!!!\r\n\r\n    this.omradeCenters = {\r\n      0: { x: 255, y: 0 },\r\n      1: { x: 400, y: 0 },\r\n      2: { x: 570, y: 0 },\r\n      3: { x: 70, y:0}\r\n    };\r\n\r\n\r\n    this.center = { x: this.width / 2, y: this.height / 2 };\r\n\r\n    // this.projspace_title = {};\r\n    this.scaleLegendDebounce = debounce(() => this.updateScaleLegend(), 200);\r\n    this.zoom = d3.zoom()\r\n        .scaleExtent([.2, 20])\r\n        .on(\"zoom.transform\", () => {this.g.attr(\"transform\", d3.event.transform);})\r\n        .on(\"zoom.legend\", this.scaleLegendDebounce);\r\n\r\n    this.svg = d3.select(this.svgRef)\r\n          .attr(\"width\",this.width)\r\n          .attr(\"height\",this.height)\r\n          .call(this.zoom);\r\n    this.updateScaleLegend();\r\n    this.svg.on('click', () => {\r\n      if (d3.event.target.class !== 'project_button') {\r\n        // this.projectNavigator.goToRoot(this.props.history, this.props.location);\r\n        d3.selectAll('.button_collections').style('display','none');\r\n      }\r\n    });\r\n    this.g = this.svg.append(\"g\");\r\n\r\n    this.simulation = d3.forceSimulation()\r\n      .velocityDecay(0.2)\r\n      .force('x', d3.forceX().strength(this.forceStrength).x(this.center.x))\r\n      .force('y', d3.forceY().strength(this.forceStrength).y(this.center.y))\r\n      .force('charge', d3.forceManyBody().strength(this.charge.bind(this)))\r\n      .on('tick', this.ticked.bind(this));\r\n\r\n    this.simulation.stop();\r\n    this.maxAmount = d3.max(mockData, d => { return +d.total_amount; });\r\n\r\n    this.radiusScale = d3.scalePow()\r\n      .exponent(0.5)\r\n      .range([2, 85])\r\n      .domain([0, this.maxAmount]);\r\n\r\n    // console.log(mockData);\r\n    this.bubbles = this.g.selectAll('.bubble')\r\n      .data(this.nodes, d => { return d.id; });\r\n\r\n    this.bubblesE = this.bubbles.enter().append('circle')\r\n      .classed('bubble', true)\r\n      .attr('r', 0)\r\n      .style(\"fill\",d => { return this.helix_colors[d.kategori];})\r\n      .attr('stroke-width', .5)\r\n      .attr('stroke',d => {return this.helix_colors_borders[d.kategori]})\r\n      .on(\"mouseover\",d => {\r\n        let id = d.id;\r\n        // this.parentNode.appendChild(this);\r\n        d3.selectAll(\".bubble\")\r\n          .filter(function(d){if(d.id===id){return false;}return true;})\r\n          .transition()\r\n            .style(\"opacity\",\"0.3\");\r\n\r\n        this.tooltip.transition().style(\"opacity\", .9);\r\n        this.tooltip.html(d.organisation) //+ \" \" + omrade_titles[d.kategori])\r\n          .style(\"left\", (d3.event.offsetX) + \"px\")\r\n          .style(\"top\", (d3.event.offsetY - 28) + \"px\")\r\n          .style(\"max-width\",  200 + \"px\");\r\n      })\r\n      .on(\"mouseout\",d => {\r\n          this.tooltip.transition().style(\"opacity\", 0);\r\n          d3.selectAll(\".bubble\")\r\n            .transition()\r\n              .style(\"opacity\",\"1\");\r\n      });\r\n\r\n\r\n    this.bubbles = this.bubbles.merge(this.bubblesE);\r\n\r\n    this.bubbles.transition(\"start\")\r\n      .duration(2000)\r\n      .attr('r', d => { return d.radius; });\r\n\r\n    // Start simulation\r\n    this.simulation.nodes(this.nodes);\r\n    this.move_bubbles(0);\r\n\r\n\r\n    let omradeData = d3.keys(this.omrade_titles);\r\n    this.years = this.g.selectAll('.omradeTitles')\r\n    .data(omradeData);\r\n\r\n    this.years.enter().append('text')\r\n      .attr('class', 'omradeTitles')\r\n      .attr('display','none')\r\n      .attr('font-size','20px')\r\n      .attr('x', d => { return this.omrade_titles_x[d]; })\r\n      .attr('y', d => { return this.omrade_titles_y[d];})\r\n      .attr('text-anchor', 'middle')\r\n      .text(d => { return this.omrade_titles[d]; });\r\n\r\n    this.temp_str = {0 : \"Partners\", 1: \"temp\"};\r\n    let projData2 = d3.keys(this.temp_str);\r\n    this.projTitlesObj = this.g.selectAll('.projTitles')\r\n    .data(projData2);\r\n\r\n    this.projTitlesObj.enter().append('text')\r\n      .attr('class', 'projTitles')\r\n      .attr('display','none')\r\n      .attr('font-size','20px')\r\n      .attr('x', d => { return this.projspace_title_x[d]; })\r\n      .attr('y', d => { return this.projspace_title_y[d];})\r\n      .attr('text-anchor', 'middle')\r\n      .text(d => { return this.temp_str[d]; })\r\n      .filter(function (d){\r\n        if(d == 1){\r\n          return true;\r\n        }\r\n        return false;\r\n      })\r\n      .attr('font-size','12px')\r\n      .attr(\"id\",\"proj_text_change\");\r\n\r\n\r\n    // Move legedn elsewhere.\r\n    // create_legend();\r\n  }\r\n\r\n\r\n  move_bubbles(opt){\r\n    if(opt == 0){\r\n      this.simulation.force('x', d3.forceX().strength(this.forceStrength).x(this.center.x));\r\n    } else if (opt == 1){\r\n      this.simulation.force('x', d3.forceX().strength(this.forceStrength).x(this.omrade_view.bind(this)));\r\n    } else if (opt == 2){\r\n      this.simulation.force('x', d3.forceX().strength(this.forceStrength).x(this.project_view.bind(this)));\r\n    }\r\n    this.view_option = opt;\r\n    this.simulation.alpha(1).restart();\r\n    this.toggle_title(opt);\r\n  }\r\n\r\n  toggle_title(opt){\r\n    if(opt == 1){\r\n      d3.selectAll('.omradeTitles')\r\n        .attr('display','initial');\r\n    } else {\r\n      d3.selectAll('.omradeTitles')\r\n        .attr('display', 'none');\r\n    }\r\n    if(opt == 2){\r\n      d3.selectAll('.projTitles')\r\n        .attr('display','initial');\r\n    } else {\r\n        d3.selectAll('.projTitles')\r\n          .attr('display','none');\r\n    }\r\n  }\r\n  omrade_view(d){\r\n    return this.omradeCenters[d.kategori].x;\r\n  }\r\n\r\n  project_view(d){\r\n    let projs = d.projects;\r\n    for(var i = 0; i < projs.length; i++){\r\n      if(projs[i] == this.project_no){\r\n        return this.projectSpace[1];\r\n      }\r\n    }\r\n    return this.projectSpace[0];\r\n  }\r\n  charge(d) {\r\n    return -Math.pow(d.radius, 2.0) * this.forceStrength;\r\n  }\r\n\r\n  ticked() {\r\n    this.bubbles.attr('cx', d => { return d.x; })\r\n                .attr('cy', d => { return d.y; });\r\n    }\r\n\r\n  change_view_spec(opt, proj_opt){\r\n    this.view_option = opt;\r\n    this.project_no = proj_opt;\r\n    d3.select('#proj_text_change').text(this.projspace_title[proj_opt]);\r\n    this.move_bubbles(opt);\r\n  }\r\n\r\n  componentDidUpdate(){\r\n\r\n  }\r\n\r\n  createNewNodes(rawData){\r\n    let q_o = {\r\n       \"Civilsamhälle\" : 0,\r\n       \"Forskning\" : 1,\r\n       \"Näringsliv\": 2,\r\n       \"Offentlig verksamhet\": 3\r\n    };\r\n    let myNodes = rawData.map(function (d,i){\r\n      return {\r\n        id: (i),\r\n        radius : 15,\r\n        organisation: d.Organisation,\r\n        value: Math.random() * 10,\r\n        projects : d.Projects,\r\n        kategori: q_o[d.Kategori],\r\n        x: Math.random() * 900,\r\n        y: Math.random() * 800\r\n      };\r\n    });\r\n    myNodes.sort(function (a,b){ return b.value - a.value; });\r\n    return myNodes;\r\n  }\r\n\r\n  updateScaleLegend() {\r\n    const scaleFactor = d3.zoomTransform(this.svg.node()).k;\r\n    this.props.updateScaleData([{ r: 15 * scaleFactor, label: '1 partner' }]);\r\n  }\r\n\r\n\r\n  render(){\r\n    return (\r\n      <div className=\"partnerWrap\" ref={svgWrapper => this.svgWrapperRef = svgWrapper}>\r\n        <svg className=\"partner_svg_area\" id=\"partner_svg_area\" ref={svg => { this.svgRef = svg;}}></svg>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Partners;\r\n","import React, { Component } from 'react';\r\nimport { range } from 'd3';\r\nimport isEqual from 'react-fast-compare';\r\nimport PropTypes from 'prop-types';\r\nimport './Matchmaking.css';\r\n\r\nconst ROWS = 5;\r\nconst COLS = 4;\r\n\r\n// input is '[ROW,COL]' where ROW and COL are numbers.\r\nconst parsePosition = (name) => {\r\n  const split = name.substring(1, name.length - 1).split(',');\r\n  return { row: Number.parseInt(split[0]), col: Number.parseInt(split[1]) };\r\n};\r\n\r\nclass Matchmaking extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      expanded: false\r\n    };\r\n\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n    const position = parsePosition(event.target.name);\r\n    const valueCopy = [...this.props.value];\r\n\r\n    const index = this.props.value.findIndex(item => isEqual(position, item));\r\n    if (index !== -1) valueCopy.splice(index, 1);\r\n    if (event.target.checked) valueCopy.push(position);\r\n\r\n    if (this.props.onChange) this.props.onChange(valueCopy);\r\n  }\r\n\r\n  isChecked(row, col) {\r\n    return this.props.value.findIndex(item => isEqual(item, { row, col })) !== -1;\r\n  }\r\n\r\n  render() {\r\n    const columns = (row) => {\r\n      return range(1, COLS + 1).map(col => (\r\n        <td key={(row - 1) * COLS + col}>\r\n          <input\r\n            type=\"checkbox\"\r\n            name={`[${row},${col}]`}\r\n            checked={this.isChecked(row, col)}\r\n            onChange={this.handleChange}\r\n            disabled={this.props.enabled && !this.props.enabled[row][col]} />\r\n        </td>\r\n      ));\r\n    };\r\n\r\n    const rows = range(1, ROWS + 1).map(row => (\r\n      <tr key={row}>\r\n        {columns(row)}\r\n      </tr>\r\n    ));\r\n\r\n    return (\r\n      <div className=\"filters-box filters-box--matchmaking\">\r\n        <span className=\"filters-box__title\">\r\n          Teman och fokusområden\r\n        </span>\r\n        <div className=\"matchmaking-table-container\">\r\n          <table className=\"matchmaking-table\">\r\n            <tbody>\r\n              {rows}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMatchmaking.defaultProps = {\r\n  value: []\r\n};\r\n\r\nMatchmaking.propTypes = {\r\n  onChange: PropTypes.func,\r\n  value: PropTypes.arrayOf(PropTypes.shape({\r\n    row: PropTypes.number,\r\n    col: PropTypes.number\r\n  })).isRequired,\r\n  enabled: PropTypes.objectOf(PropTypes.objectOf(PropTypes.bool))\r\n};\r\n\r\nexport default Matchmaking;\r\n","import React, { Component, Fragment } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { range } from 'd3';\r\nimport { Multiselect } from 'react-widgets'\r\nimport { col2focus, row2theme, theme2row } from '../matrix/MatrixUtility';\r\nimport Matchmaking from './Matchmaking';\r\nimport isEqual from 'react-fast-compare';\r\nimport _intersection from 'lodash.intersection';\r\nimport './Filters.css';\r\n\r\n// find the intersection of an arbitrary number of subsets of data\r\nfunction intersection(...data) {\r\n  return { data: _intersection(...data.map(d => d.data)) };\r\n}\r\n\r\n// presentation of the multiselect options\r\nconst ListItem = ({ item }) => (\r\n  <div className=\"filters-item\">\r\n    <span className=\"filters-item__name\">{item.name}</span>\r\n    <span className=\"filters-item__count\">{item.count}</span>\r\n  </div>\r\n);\r\n\r\nclass Filters extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      filteredBy: {\r\n        titles: props.data,\r\n        locations: props.data,\r\n        partners: props.data,\r\n        keywords: props.data,\r\n        matchmaking: props.data,\r\n      },\r\n      filterValues: {\r\n        titles: [],\r\n        locations: [],\r\n        partners: [],\r\n        keywords: [],\r\n        matchmaking: []\r\n      },\r\n      filteredData: props.data\r\n    };\r\n\r\n    // used for optimizations\r\n    this.prevFilteredData = null;\r\n\r\n    // data used by filter components when rendering, e.g.\r\n    // location names, partners, enabled matrix cells etc\r\n    this.componentData = {\r\n      titles: null,\r\n      locations: null,\r\n      partners: null,\r\n      keywords: null,\r\n      matchmaking: null\r\n    };\r\n\r\n    this.projectLocations = {};\r\n    this.projectPartners = {};\r\n    this.projectKeywords = {};\r\n\r\n    props.data.data.forEach(d => {\r\n      this.projectLocations[d.survey_answers.project_id] = new Set();\r\n      d.survey_answers.locations.forEach(location => {\r\n        this.projectLocations[d.survey_answers.project_id].add(location);\r\n      });\r\n\r\n      this.projectPartners[d.survey_answers.project_id] = new Set();\r\n      d.survey_answers.other_financiers.forEach(financier => {\r\n        this.projectPartners[d.survey_answers.project_id].add(financier);\r\n      });\r\n      d.survey_answers.other_recipients.forEach(recipient => {\r\n        this.projectPartners[d.survey_answers.project_id].add(recipient);\r\n      });\r\n\r\n      this.projectKeywords[d.survey_answers.project_id] = new Set();\r\n      d.survey_answers.keywords.forEach(keyword => {\r\n        this.projectKeywords[d.survey_answers.project_id].add(keyword);\r\n      });\r\n    });\r\n\r\n    this.filterBy = {\r\n      titles: (titles) => {\r\n        if (!titles.length) return this.props.data;\r\n\r\n        return {\r\n          data: this.props.data.data.filter((d) => {\r\n            if (!titles.includes(d.survey_answers.project_title)) return false;\r\n            return true;\r\n          })\r\n        };\r\n      },\r\n      locations: (locations) => {\r\n        if (!locations.length) return this.props.data;\r\n\r\n        return {\r\n          data: this.props.data.data.filter((d) => {\r\n            if (!locations.some(location => {\r\n              return this.projectLocations[d.survey_answers.project_id].has(location.name);\r\n            })) return false;\r\n            return true;\r\n          })\r\n        };\r\n      },\r\n      partners: (partners) => {\r\n        if (!partners.length) return this.props.data;\r\n\r\n        return {\r\n          data: this.props.data.data.filter((d) => {\r\n            if (!partners.some(partner => {\r\n              return this.projectPartners[d.survey_answers.project_id].has(partner.name);\r\n            })) return false;\r\n            return true;\r\n          })\r\n        }\r\n      },\r\n      keywords: (keywords) => {\r\n        if (!keywords.length) return this.props.data;\r\n\r\n        return {\r\n          data: this.props.data.data.filter((d) => {\r\n            if (!keywords.some(keyword => {\r\n              return this.projectKeywords[d.survey_answers.project_id].has(keyword.name);\r\n            })) return false;\r\n            return true;\r\n          })\r\n        }\r\n      },\r\n      matchmaking: (matchmaking) => {\r\n        if (!matchmaking.length) return this.props.data;\r\n\r\n        return {\r\n          data: this.props.data.data.filter((d) => {\r\n            if (!matchmaking.every(position => {\r\n              return d.survey_answers[col2focus[position.col]].includes(row2theme[position.row])\r\n            })) return false;\r\n            return true;\r\n          })\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  empty() {\r\n    return Object.values(this.state.filterValues).every(value => value.length === 0);\r\n  }\r\n\r\n  filteredByAllExcept(filter) {\r\n    return intersection(...Object.entries(this.state.filteredBy)\r\n      .filter(([key, value]) => key !== filter)\r\n      .map(([key, value]) => value))\r\n  }\r\n\r\n  buildTitlesList() {\r\n    const data = this.filteredByAllExcept('titles');\r\n    return data.data.map(d => d.survey_answers.project_title)\r\n  }\r\n\r\n  buildLocationList() {\r\n    const data = this.filteredByAllExcept('locations');\r\n    \r\n    const ret = new Map();\r\n    data.data.forEach(d => {\r\n      d.survey_answers.locations.forEach(location => {\r\n        ret.has(location) ? ret.set(location, ret.get(location) + 1) : ret.set(location, 1);\r\n      });\r\n    });\r\n\r\n    return [...ret]\r\n      .sort()\r\n      .reduce((arr, [key, value]) => [...arr, {name: key, count: value}], [])\r\n  }\r\n\r\n  buildPartnerList() {\r\n    const data = this.filteredByAllExcept('partners');\r\n\r\n    const ret = new Map();\r\n    data.data.forEach(d => {\r\n      this.projectPartners[d.survey_answers.project_id].forEach(partner => {\r\n        ret.has(partner) ? ret.set(partner, ret.get(partner) + 1) : ret.set(partner, 1);\r\n      });\r\n    });\r\n\r\n    return [...ret]\r\n      .sort()\r\n      .reduce((arr, [key, value]) => [...arr, {name: key, count: value}], [])\r\n  }\r\n\r\n  buildKeywordList() {\r\n    const data = this.filteredByAllExcept('keywords');\r\n\r\n    const ret = new Map();\r\n    data.data.forEach(d => {\r\n      d.survey_answers.keywords.forEach(keyword => {\r\n        ret.has(keyword) ? ret.set(keyword, ret.get(keyword) + 1) : ret.set(keyword, 1);\r\n      });\r\n    });\r\n\r\n    return [...ret]\r\n      .sort()\r\n      .reduce((arr, [key, value]) => [...arr, {name: key, count: value}], [])\r\n  }\r\n\r\n  buildMatchmakingList() {\r\n    const data = this.state.filteredData;\r\n\r\n    const ROWS = 5;\r\n    const COLS = 4;\r\n\r\n    const colRange = range(1, COLS + 1); \r\n\r\n    const nonEmpty = {};\r\n    for (let row = 1; row <= ROWS; ++row) {\r\n      nonEmpty[row] = {};\r\n      for (let col = 1; col <= COLS; ++col) {\r\n        nonEmpty[row][col] = false;\r\n      }\r\n    }\r\n\r\n    data.data.forEach(d => {\r\n      colRange.forEach(col => {\r\n        d.survey_answers[col2focus[col]].forEach(theme => {\r\n          const row = theme2row[theme];\r\n          if (!nonEmpty[row][col]) nonEmpty[row][col] = true;\r\n        })\r\n      });\r\n    });\r\n\r\n    return nonEmpty;\r\n  }\r\n\r\n  // only render if state changed, ignore props since they shouldn't change anyway\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    if (!isEqual(nextState, this.state)) return true;\r\n    return false;\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (prevState === this.state) return;\r\n\r\n    if (!isEqual(prevState.filterValues, this.state.filterValues)) {\r\n      const filteredBy = {};\r\n      Object.keys(this.filterBy).forEach(filter => {\r\n        if (!isEqual(prevState.filterValues[filter], this.state.filterValues[filter])) {\r\n          filteredBy[filter] = this.filterBy[filter](this.state.filterValues[filter]);\r\n        }\r\n      });\r\n      if (Object.keys(filteredBy).length) {\r\n        this.setState((state, props) => ({\r\n          filteredBy: {\r\n            ...state.filteredBy,\r\n            ...filteredBy\r\n          }\r\n        }))\r\n      }\r\n    }\r\n\r\n    if (!isEqual(prevState.filteredBy, this.state.filteredBy)) {\r\n      const newFilteredData = intersection(...Object.values(this.state.filteredBy));\r\n      this.setState({\r\n        filteredData: newFilteredData\r\n      });\r\n      this.props.updateFilteredData(newFilteredData);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // load these here, otherwise lazy evaluation can cause some choppiness in the browser\r\n    if (this.state.filteredData !== this.prevFilteredData) {\r\n      this.prevFilteredData = this.state.filteredData;\r\n      this.componentData = {\r\n        titles: this.buildTitlesList(),\r\n        locations: this.buildLocationList(),\r\n        partners: this.buildPartnerList(),\r\n        keywords: this.buildKeywordList(),\r\n        matchmaking: this.buildMatchmakingList()\r\n      }\r\n    }\r\n    \r\n    return (\r\n      <div className=\"filters\">\r\n        <h2>Filter</h2>\r\n        <div className=\"filters-box\">\r\n          <span className=\"filters-box__title\">\r\n            Titel\r\n          </span>\r\n          <Multiselect\r\n            data={this.componentData.titles}\r\n            onChange={titles => {\r\n              this.setState({\r\n                filterValues: {\r\n                  ...this.state.filterValues,\r\n                  titles\r\n                }\r\n              });\r\n            }}\r\n            placeholder=\"Filtera efter titlar\"\r\n            filter=\"contains\"\r\n            value={this.state.filterValues.titles} />\r\n        </div>\r\n        <div className=\"filters-box\">\r\n          <span className=\"filters-box__title\">\r\n            Plats\r\n          </span>\r\n          <Multiselect\r\n            data={this.componentData.locations}\r\n            onChange={locations => {\r\n              this.setState({\r\n                filterValues: {\r\n                  ...this.state.filterValues,\r\n                  locations\r\n                }\r\n              });\r\n            }}\r\n            placeholder=\"Filtrera efter kommuner\"\r\n            valueField=\"name\"\r\n            textField=\"name\"\r\n            itemComponent={ListItem}\r\n            value={this.state.filterValues.locations} />\r\n        </div>\r\n        <div className=\"filters-box\">\r\n          <span className=\"filters-box__title\">\r\n            Partner\r\n          </span>\r\n          <Multiselect\r\n            data={this.componentData.partners}\r\n            onChange={partners => {\r\n              this.setState({\r\n                filterValues: {\r\n                  ...this.state.filterValues,\r\n                  partners\r\n                }\r\n              });\r\n            }}\r\n            placeholder=\"Filtrera efter partners\"\r\n            filter=\"contains\"\r\n            valueField=\"name\"\r\n            textField=\"name\"\r\n            itemComponent={ListItem}\r\n            value={this.state.filterValues.partners} />\r\n        </div>\r\n        <div className=\"filters-box\">\r\n          <span className=\"filters-box__title\">\r\n            Nyckelord\r\n          </span>\r\n          <Multiselect\r\n            data={this.componentData.keywords}\r\n            onChange={keywords => {\r\n              this.setState({\r\n                filterValues: {\r\n                  ...this.state.filterValues,\r\n                  keywords\r\n                }\r\n              });\r\n            }}\r\n            placeholder=\"Filtera efter nyckelord\"\r\n            filter=\"contains\"\r\n            valueField=\"name\"\r\n            textField=\"name\"\r\n            itemComponent={ListItem}\r\n            value={this.state.filterValues.keywords} />\r\n        </div>\r\n\r\n        <Matchmaking\r\n          value={this.state.filterValues.matchmaking}\r\n          onChange={matchmaking => {\r\n            this.setState({\r\n              filterValues: {\r\n                ...this.state.filterValues,\r\n                matchmaking\r\n              }\r\n            });\r\n          }}\r\n          enabled={this.componentData.matchmaking} />\r\n\r\n        {!this.empty() &&\r\n          <Fragment>\r\n            <p className='filters-results-text'>\r\n              Visar <span className=\"filters-results-text__number\">{this.state.filteredData.data.length}</span>\r\n              {' '} av <span className=\"filters-results-text__number\">{this.props.data.data.length}</span> projekt.\r\n            </p>\r\n\r\n            <div className='filters-button-box'>\r\n              <button\r\n                className=\"filters-button\"\r\n                onClick={() => this.setState({\r\n                  filterValues: Object.entries(this.state.filterValues)\r\n                    .reduce((obj, [k,_]) => ({...obj, [k]: []}), {})\r\n                })}>\r\n                Rensa filter\r\n              </button>\r\n            </div>\r\n          </Fragment>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nFilters.propTypes = {\r\n  data: PropTypes.object.isRequired,\r\n  updateFilteredData: PropTypes.func.isRequired,\r\n  scaleData: PropTypes.shape({\r\n    rScale: PropTypes.number,\r\n    minBudget: PropTypes.number,\r\n    maxBudget: PropTypes.number\r\n  })\r\n};\r\n\r\nexport default Filters;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './ColorLegendItem.css';\r\n\r\nfunction ColorLegendItem({ text, color }) {\r\n  return (\r\n    <div className=\"color-legend-item\">\r\n      <div className=\"color-legend-item__box\" style={{background: color}} />\r\n      <span className=\"color-legend-item__text\">{text}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nColorLegendItem.propTypes = {\r\n  text: PropTypes.string.isRequired,\r\n  color: PropTypes.any.isRequired\r\n}\r\n\r\nexport default ColorLegendItem;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { range } from 'd3';\r\nimport { withRouter } from 'react-router';\r\nimport { Transition, animated } from 'react-spring';\r\nimport ColorLegendItem from './ColorLegendItem';\r\nimport { projectTypes, projectTypeColors } from './matrix/MatrixUtility';\r\nimport './ColorLegend.css';\r\n\r\n// NOTE: Hardcoded for now, but for prettier code these could be imported directly from Partners.jsx\r\nconst omrade_titles = {\r\n  0: \"Civilsamhälle\",\r\n  1: \"Forskning\",\r\n  2: \"Näringsliv\",\r\n  3: \"Offentlig verksamhet\"\r\n};\r\n\r\nconst helix_colors = {\r\n  0: \"#007d91\",\r\n  1: \"#EA9A00\",\r\n  2: \"#00A389\",\r\n  3: \"#97C28E\"\r\n};\r\n\r\nfunction RouteColorLegend({ labels }) {\r\n  let items = labels.map(label => \r\n    <li key={label.text}>\r\n      <ColorLegendItem {...label} />\r\n    </li>\r\n  );\r\n\r\n  return (\r\n    <div className=\"color-legend\">\r\n      <ul>\r\n        {items}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nRouteColorLegend.propTypes = {\r\n  labels: PropTypes.arrayOf(PropTypes.shape({\r\n    text: PropTypes.string.isRequired,\r\n    color: PropTypes.any.isRequired\r\n  })).isRequired\r\n};\r\n\r\nclass ColorLegend extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const mapLabels = [{ text: 'Projekt', color: '#007d91'}]; // hard-coded\r\n    const matrixLabels = projectTypes.map(type => ({ text: type, color: projectTypeColors(type) }));\r\n    const partnersLabels = range(4).map(i => ({ text: omrade_titles[i], color: helix_colors[i] }));\r\n\r\n    this.legends = {\r\n      map: (<RouteColorLegend labels={mapLabels} />),\r\n      matrix: (<RouteColorLegend labels={matrixLabels} />),\r\n      partners: (<RouteColorLegend labels={partnersLabels} />)\r\n    };\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    if (this.props.location.pathname !== nextProps.location.pathname) return true;\r\n    return false;\r\n  }\r\n\r\n  render() {\r\n    const route = Object.keys(this.legends).find(route => this.props.location.pathname.includes(route));\r\n\r\n    return (\r\n      <Transition\r\n        native\r\n        items={route}\r\n        from={{ height: 0, opacity: 0}}\r\n        enter={{ height: 'auto', opacity: 1 }}\r\n        leave={{ height: 0, opacity: 0}}>\r\n        {route =>\r\n          route !== undefined &&\r\n            (props => \r\n              <animated.div style={{ ...props}}>\r\n                {this.legends[route]}\r\n              </animated.div>)\r\n        }\r\n      </Transition>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ColorLegend);\r\n","import React, { Component } from 'react';\r\nimport { select, easePolyOut } from 'd3';\r\nimport PropTypes from 'prop-types';\r\nimport './ScaleLegend.css';\r\n\r\nconst masterTransition = (transition) => transition.duration(800).ease(easePolyOut.exponent(4));\r\n\r\nclass ScaleLegend extends Component {\r\n  componentDidMount() {\r\n    this.parent = select(this.parentRef).style('width', '150px');\r\n    this.svg = select(this.svgRef).attr('height', 0);\r\n\r\n    this.margin = { top: 10, right: 10, bottom: 10, left: 20};\r\n    this.lineWidth = 10;\r\n    this.labelWidth = 60; // hard-coded approximation of label width for centering\r\n\r\n    this.updateData(this.props.scaleData);\r\n  }\r\n\r\n  updateData(data) {\r\n    if (!data || !data.length) return;\r\n\r\n    const fixedData = data.slice().map((d, i) => ({ ...d, i })).reverse();\r\n    const selection = this.svg.selectAll('g').data(fixedData);\r\n\r\n    const labels = data.map((circle, index) => {\r\n      let left = data[0].r + this.margin.left;\r\n      let top = data[0].r * 2 - circle.r * 2 + this.margin.top;\r\n      let width = data[0].r + this.lineWidth;\r\n      if (index === data.length - 1) {\r\n        left += circle.r;\r\n        top += circle.r;\r\n        width -= circle.r;\r\n      }\r\n\r\n      return { left, top, width };\r\n    })\r\n\r\n    // We the previous height and width to align the items properly on enter,\r\n    // otherwise it will looks like they're sliding on from the side.\r\n    const svgHeight = data[0].r * 2 + this.margin.top + this.margin.bottom;\r\n    const svgHeightChange = svgHeight - this.svg.attr('height');\r\n    const parentWidth = data[0].r * 2 + this.margin.left + this.margin.right + this.lineWidth + this.labelWidth;\r\n    const parentWidthChange = parentWidth - Number.parseInt(this.svg.style('width').replace('px', ''));\r\n\r\n    this.parent\r\n      .transition()\r\n        .call(masterTransition)\r\n        .style('width', `${parentWidth}px`)\r\n\r\n    this.svg\r\n      .transition()\r\n        .call(masterTransition)\r\n        .attr('height', svgHeight)\r\n\r\n    selection.exit()\r\n        .call(g => g.select('line')\r\n            .attr('opacity', 0))\r\n        .call(g => g.select('text')\r\n            .attr('opacity', 0))\r\n      .transition()\r\n        .call(masterTransition)\r\n        .call(g => g.select('circle')\r\n            .attr('cx', data[0].r + this.margin.left)\r\n            .attr('cy', d => data[0].r * 2 - d.r + this.margin.top)\r\n            .attr('opacity', 0))\r\n        .remove();\r\n\r\n    selection\r\n      .transition()\r\n        .call(masterTransition)\r\n        .call(g => g.select('circle')\r\n            .attr('opacity', 1)\r\n            .attr('r', d => d.r)\r\n            .attr('cx', data[0].r + this.margin.left)\r\n            .attr('cy', d => data[0].r * 2 - d.r + this.margin.top))\r\n        .call(g => g.select('line')\r\n            .attr('opacity', 1)\r\n            .attr('x1', d => labels[d.i].left)\r\n            .attr('x2', d => labels[d.i].left + labels[d.i].width)\r\n            .attr('y1', d => labels[d.i].top)\r\n            .attr('y2', d => labels[d.i].top))\r\n        .call(g => g.select('text')\r\n            .attr('opacity', 1)\r\n            .attr('x', d => labels[d.i].left + labels[d.i].width + 5)\r\n            .attr('y', d => labels[d.i].top)\r\n            .text(d => d.label))\r\n\r\n    selection.enter().append('g')\r\n        .call(g => g.append('circle')\r\n            .attr('r', d => d.r)\r\n            .attr('cx', data[0].r + this.margin.left - parentWidthChange / 2)\r\n            .attr('cy', d => data[0].r * 2 - d.r + this.margin.top - svgHeightChange)\r\n            .attr('opacity', 0))\r\n        .call(g => g.append('line')\r\n            .attr('x1', d => labels[d.i].left - parentWidthChange / 2)\r\n            .attr('x2', d => labels[d.i].left + labels[d.i].width - parentWidthChange / 2)\r\n            .attr('y1', d => labels[d.i].top - svgHeightChange)\r\n            .attr('y2', d => labels[d.i].top - svgHeightChange)\r\n            .attr('shape-rendering', 'crispEdges')\r\n            .attr('opacity', 0))\r\n        .call(g => g.append('text')\r\n            .attr('x', d => labels[d.i].left + labels[d.i].width + 5 - parentWidthChange / 2)\r\n            .attr('y', d => labels[d.i].top - svgHeightChange)\r\n            .attr('alignment-baseline', 'central')\r\n            .text(d => d.label)\r\n            .attr('opacity', 0))\r\n      .transition()\r\n        .call(masterTransition)\r\n        .call(g => g.select('circle')\r\n            .attr('cx', data[0].r + this.margin.left)\r\n            .attr('cy', d => data[0].r * 2 - d.r + this.margin.top)\r\n            .attr('opacity', 1))\r\n        .call(g => g.select('line')\r\n            .attr('x1', d => labels[d.i].left)\r\n            .attr('x2', d => labels[d.i].left + labels[d.i].width)\r\n            .attr('y1', d => labels[d.i].top)\r\n            .attr('y2', d => labels[d.i].top)\r\n            .attr('opacity', 1))\r\n        .call(g => g.select('text')\r\n            .attr('x', d => labels[d.i].left + labels[d.i].width + 5)\r\n            .attr('y', d => labels[d.i].top)\r\n            .attr('opacity', 1))\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.scaleData !== this.props.scaleData)\r\n      this.updateData(this.props.scaleData);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"scale-legend\" ref={parent => this.parentRef = parent}>\r\n        <svg ref={svg => this.svgRef = svg} width=\"100%\" />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nScaleLegend.propTypes = {\r\n  scaleData: PropTypes.arrayOf(PropTypes.shape({\r\n    r: PropTypes.number.isRequired,\r\n    label: PropTypes.string.isRequired\r\n  }))\r\n};\r\n\r\nexport default ScaleLegend;","import React, { Component } from 'react';\r\nimport Filters from './filters/Filters';\r\nimport ColorLegend from './ColorLegend';\r\nimport ScaleLegend from './ScaleLegend';\r\nimport './Sidebar.css';\r\n\r\nclass Sidebar extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"sidebar\">\r\n        <div className=\"sidebar__top\">\r\n          <Filters data={this.props.data} updateFilteredData={this.props.updateFilteredData} />\r\n        </div>\r\n        <div className=\"sidebar__bottom\">\r\n          <ScaleLegend scaleData={this.props.scaleData} />\r\n          <ColorLegend />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Sidebar;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Spring, animated } from 'react-spring';\r\nimport './InfoBoxSection.css';\r\n\r\nclass InfoBoxSection extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      toggle: props.initToggle || false\r\n    };\r\n    this.onToggle = this.onToggle.bind(this);\r\n  }\r\n\r\n  onToggle() {\r\n    this.setState(state => ({ toggle: !state.toggle }));\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className={`info-box-section ${this.state.toggle ? 'info-box-section--toggled' : ''}`}>\r\n        <div className=\"info-box-section__title\" onClick={this.onToggle}>\r\n          <span className=\"info-box-section__title-text\">{this.props.title}</span>\r\n          <span className='info-box-section__title-cross'>\r\n            +\r\n          </span>\r\n        </div>\r\n        <Spring native from={{ height: this.state.toggle ? 'auto' : 0 }} to={{ height: this.state.toggle ? 'auto' : 0 }}>\r\n          {props => (\r\n            <animated.div className=\"info-box-section__content\" style={props}>\r\n              <div className=\"info-box-section__inner-content\">\r\n                {this.props.children}\r\n              </div>\r\n            </animated.div>\r\n          )}\r\n        </Spring>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nInfoBoxSection.propTypes = {\r\n  title: PropTypes.string,\r\n  children: PropTypes.node.isRequired,\r\n  initToggle: PropTypes.bool\r\n};\r\n\r\nexport default InfoBoxSection;\r\n","import p1 from '../assets/images/projects/1-Aktivitetsbaserad-modellering.png';\r\nimport p2 from '../assets/images/projects/2-DDS-energieffektiv-vard.jpg';\r\nimport p3 from '../assets/images/projects/3-Digitalt-kontrollerade-odlingssystem.jpg';\r\nimport p4 from '../assets/images/projects/4-Effektiv-energiplanering.jpg';\r\nimport p5 from '../assets/images/projects/5-Hotmodellering.jpg';\r\nimport p6 from '../assets/images/projects/6-Hallbara-urbana-livstillar.jpg';\r\nimport p7 from '../assets/images/projects/7-Klimatkampen-Uppsala.jpg';\r\nimport p8 from '../assets/images/projects/8-Ladda-lagra-lanka.png';\r\nimport p9 from '../assets/images/projects/9-MERiT.jpg';\r\nimport p10 from '../assets/images/projects/10-Mo-Bo.jpg';\r\nimport p11 from '../assets/images/projects/11-Matt-och-steg.jpg';\r\nimport p12 from '../assets/images/projects/12-SAMIR.jpg';\r\nimport p13 from '../assets/images/projects/13-Sensorer-for-luftmiljo.jpg';\r\nimport p14 from '../assets/images/projects/14-R-energi.JPG';\r\nimport p15 from '../assets/images/projects/15-Sharing-Cities-Sweden.jpg';\r\nimport p16 from '../assets/images/projects/16-Matbutik.jpg';\r\nimport p17 from '../assets/images/projects/17-Smart-Village.png';\r\nimport p18 from '../assets/images/projects/18-Smaskalig-elforsorjning.jpg';\r\nimport p19 from '../assets/images/projects/19-Urban-ICT-Arena.jpg';\r\nimport p20 from '../assets/images/projects/20-Vardeskapande-med-oppna-data.jpg';\r\nimport p21 from '../assets/images/projects/21-3De.jpg';\r\n\r\nexport default {\r\n  1: p1,\r\n  2: p2,\r\n  3: p3,\r\n  4: p4,\r\n  5: p5,\r\n  6: p6,\r\n  7: p7,\r\n  8: p8,\r\n  9: p9,\r\n  10: p10,\r\n  11: p11,\r\n  12: p12,\r\n  13: p13,\r\n  14: p15,\r\n  15: p14,\r\n  16: p16,\r\n  17: p17,\r\n  18: p18,\r\n  19: p19,\r\n  20: p20,\r\n  21: p21\r\n};\r\n","import React, { Component, Fragment } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport PropTypes from 'prop-types';\r\nimport { format } from 'd3';\r\nimport './InfoBox.css';\r\nimport ColorLegendItem from '../ColorLegendItem';\r\nimport InfoBoxSection from './InfoBoxSection';\r\nimport projectImages from './projectImages';\r\nimport { projectTypeColors } from '../matrix/MatrixUtility';\r\n\r\nclass InfoBox extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.lastProject = null;\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps) {\r\n    if (nextProps.project !== this.props.project\r\n      || nextProps.location !== this.props.location) return true;\r\n    return false;\r\n  }\r\n\r\n  decorateItems(stringList) {\r\n    return stringList\r\n      .map(str => (<span key={str} className=\"info-box__item-decoration\">{str}</span> ))\r\n      .reduce((acc, cur) => [acc, ', ', cur]);\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.project && !this.lastProject) return null;\r\n\r\n    const project = this.props.project || this.lastProject;\r\n    if (this.props.project !== null)\r\n      this.lastProject = this.props.project;\r\n\r\n    const {\r\n      project_title,\r\n      project_organization,\r\n      project_id,\r\n      budget,\r\n      project_manager,\r\n      dates,\r\n      keywords,\r\n      other_financiers,\r\n      other_recipients,\r\n      description,\r\n      project_type,\r\n      locations\r\n    } = project.survey_answers;\r\n\r\n    const partners = [...new Set([...other_financiers, ...other_recipients])].sort();\r\n\r\n    const views = {\r\n      Map: { link: `/map/project/${project_id}`, match: '/map' },\r\n      Matrix: { link: `/matrix/project/${project_id}`, match: '/matrix' },\r\n      Partners: { link: `/partners/project/${project_id}`, match: '/partners' }\r\n    }\r\n\r\n    const vizViews = Object.keys(views).map(viewName => {\r\n      const view = views[viewName];\r\n      const match = this.props.location.pathname.includes(view.match);\r\n      return (\r\n        <Link\r\n          key={viewName}\r\n          to={view.link}\r\n          className={`info-box__view-link ${match ? 'info-box__view-link--active' : ''}`}>\r\n          {viewName}\r\n        </Link>\r\n      );\r\n    });\r\n\r\n    return (\r\n      <div className=\"info-box\">\r\n        <div className=\"info-box__splash\" style={{ backgroundImage: `url(${projectImages[project_id]})` }} />\r\n        <div className=\"info-box__content\">\r\n          <div className=\"info-box__content-header\">\r\n            <h2 className=\"info-box__title\">{project_title}</h2>\r\n            <h3 className=\"info-box__subtitle\">{locations.join(', ')}</h3>\r\n          </div>\r\n          <div>\r\n            <InfoBoxSection title=\"Generell Information\" initToggle={true}>\r\n              <dl>\r\n                <dt>Typ av projekt</dt>\r\n                <dd>\r\n                  <ColorLegendItem text={project_type} color={projectTypeColors(project_type)} />\r\n                </dd>\r\n\r\n                <dt>Projektorganisation</dt>\r\n                <dd>{project_organization}</dd>\r\n\r\n                <dt>Projektledare</dt>\r\n                <dd>{project_manager}</dd>\r\n\r\n                <dt>Total projektbudget</dt>\r\n                <dd>{`${format(',')(budget.total_cost).replace(/,/g, ' ')} kr`}</dd>\r\n\r\n                <dt>Sökt bidrag</dt>\r\n                <dd>{`${format(',')(budget.funded).replace(/,/g, ' ')} kr`}</dd>\r\n\r\n                <dt>Projekttid</dt>\r\n                <dd>{`${dates.start} - ${dates.end}`}</dd>\r\n\r\n              </dl>\r\n            </InfoBoxSection>\r\n\r\n            <InfoBoxSection title=\"Nyckelord\">\r\n              <p>\r\n                {this.decorateItems(keywords)}\r\n              </p>\r\n            </InfoBoxSection>\r\n\r\n            <InfoBoxSection title=\"Partners\">\r\n              <p>\r\n                {this.decorateItems(partners)}\r\n              </p>\r\n            </InfoBoxSection>\r\n\r\n            <InfoBoxSection title=\"Beskrivning\">\r\n              <p>\r\n              {description.split('\\n').map((item, key) => {\r\n                return <Fragment key={key}>{item}<br/></Fragment>\r\n              })}\r\n            </p>\r\n            </InfoBoxSection>\r\n          </div>\r\n\r\n          <div className=\"info-box__views\">\r\n            {vizViews}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nInfoBox.propTypes = {\r\n  project: PropTypes.object\r\n};\r\n\r\nexport default InfoBox;","import React, { Component } from 'react';\r\nimport { withRouter } from 'react-router';\r\nimport { Transition, animated } from 'react-spring';\r\nimport PropTypes from 'prop-types';\r\nimport InfoBox from './InfoBox';\r\nimport './AnimatedInfoBox.css';\r\n\r\nclass AnimatedInfoBox extends Component {\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    if (nextProps.data !== this.props.data\r\n      || nextProps.id !== this.props.id\r\n      || nextProps.location !== this.props.location) return true;\r\n    return false;\r\n  }\r\n\r\n  render() {\r\n    const projectDetails = this.props.data.data\r\n      .reduce((acc, cur) => ({ ...acc, [cur.survey_answers.project_id]: <InfoBox project={cur} location={this.props.location} /> }), {});\r\n\r\n    return (\r\n      <Transition\r\n        native\r\n        items={this.props.id}\r\n        from={{ opacity: 0, transform: 'translateX(80%)' }}\r\n        enter={{ opacity: 1, transform: 'translateX(0)' }}\r\n        leave={{ opacity: 0, transform: 'translateX(70%)'}}>\r\n        {id =>\r\n          id !== -1 &&\r\n            (props => \r\n              <animated.div className=\"info-box-container\" style={{ ...props}}>\r\n                {projectDetails[id]}\r\n              </animated.div>)\r\n        }\r\n      </Transition>\r\n    );\r\n  }\r\n}\r\n\r\nAnimatedInfoBox.propTypes = {\r\n  data: PropTypes.object,\r\n  id: PropTypes.number\r\n}\r\n\r\nexport default withRouter(AnimatedInfoBox);\r\n","import React, { Component } from 'react';\r\nimport { BrowserRouter as Router, Route, Redirect, Switch } from \"react-router-dom\";\r\nimport Header from './Header';\r\nimport Matrix from './matrix/Matrix';\r\nimport Map from './map/Map';\r\nimport Partners from './partners/Partners'\r\nimport Sidebar from './Sidebar';\r\nimport AnimatedInfoBox from './info-box/AnimatedInfoBox';\r\nimport { GetProjectId } from './ProjectNavigator';\r\nimport mockData from './assets/data/mock-data-v8.json';\r\nimport './App.css';\r\nimport 'react-widgets/dist/css/react-widgets.css';\r\n\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      filteredData: mockData,\r\n      scaleData: null\r\n    };\r\n\r\n    this.updateFilteredData = this.updateFilteredData.bind(this);\r\n    this.updateScaleData = this.updateScaleData.bind(this);\r\n  }\r\n\r\n  updateFilteredData(newData) {\r\n    this.setState({\r\n      filteredData: newData\r\n    });\r\n  }\r\n\r\n  updateScaleData(newData) {\r\n    this.setState({\r\n      scaleData: newData\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Router basename={process.env.PUBLIC_URL}>\r\n        <div className=\"App\">\r\n          <Header />\r\n          <div className=\"App__content\">\r\n            <Sidebar data={mockData} updateFilteredData={this.updateFilteredData} scaleData={this.state.scaleData} />\r\n            <Switch>\r\n              <Route path=\"/\" exact render={props => (\r\n                <Redirect to=\"/matrix\" />\r\n              )}/>\r\n              <Route path=\"/map\" render={props => (\r\n                <Map data={mockData} filteredData={this.state.filteredData} updateScaleData={this.updateScaleData} />\r\n              )}/>\r\n              <Route path=\"/matrix\" render={props => (\r\n                <Matrix data={mockData} filteredData={this.state.filteredData} updateScaleData={this.updateScaleData} />\r\n              )}/>\r\n              <Route path=\"/partners\" render={props => (\r\n                <Partners updateScaleData={this.updateScaleData} />\r\n              )}/>\r\n            </Switch>\r\n            <Route render={props => (\r\n              <AnimatedInfoBox\r\n                data={mockData}\r\n                id={Number.parseInt(GetProjectId(props.location))}/>\r\n            )}/>\r\n          </div>\r\n        </div>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n\r\n              // Execute callback\r\n              if (config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","// NOTE: This polyfill causes gh-pages to not work \"Page build failure\"\r\n// It's still valuable though, giving browser compatability with ie11.\r\n// So put it back if the website is ever moved away from github pages.\r\n//import 'react-app-polyfill/ie11';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","module.exports = __webpack_public_path__ + \"static/media/1-Aktivitetsbaserad-modellering.1074af03.png\";","module.exports = __webpack_public_path__ + \"static/media/2-DDS-energieffektiv-vard.289abdde.jpg\";","module.exports = __webpack_public_path__ + \"static/media/3-Digitalt-kontrollerade-odlingssystem.1d19642a.jpg\";","module.exports = __webpack_public_path__ + \"static/media/4-Effektiv-energiplanering.ea5820f2.jpg\";","module.exports = __webpack_public_path__ + \"static/media/5-Hotmodellering.b9fbeb16.jpg\";","module.exports = __webpack_public_path__ + \"static/media/6-Hallbara-urbana-livstillar.0c4ecf15.jpg\";","module.exports = __webpack_public_path__ + \"static/media/7-Klimatkampen-Uppsala.fba5b34a.jpg\";","module.exports = __webpack_public_path__ + \"static/media/8-Ladda-lagra-lanka.a75f29f3.png\";"],"sourceRoot":""}